/*

  SmartClient Ajax RIA system
  Version v12.1p_2021-01-06/Pro Development Only (2021-01-06)

  Copyright 2000 and beyond Isomorphic Software, Inc. All rights reserved.
  "SmartClient" is a trademark of Isomorphic Software, Inc.

  LICENSE NOTICE
     INSTALLATION OR USE OF THIS SOFTWARE INDICATES YOUR ACCEPTANCE OF
     ISOMORPHIC SOFTWARE LICENSE TERMS. If you have received this file
     without an accompanying Isomorphic Software license file, please
     contact licensing@isomorphic.com for details. Unauthorized copying and
     use of this software is a violation of international copyright law.

  DEVELOPMENT ONLY - DO NOT DEPLOY
     This software is provided for evaluation, training, and development
     purposes only. It may include supplementary components that are not
     licensed for deployment. The separate DEPLOY package for this release
     contains SmartClient components that are licensed for deployment.

  PROPRIETARY & PROTECTED MATERIAL
     This software contains proprietary materials that are protected by
     contract and intellectual property law. You are expressly prohibited
     from attempting to reverse engineer this software or modify this
     software for human readability.

  CONTACT ISOMORPHIC
     For more information regarding license rights and restrictions, or to
     report possible license violations, please contact Isomorphic Software
     by email (licensing@isomorphic.com) or web (www.isomorphic.com).

*/

if(window.isc&&window.isc.module_Core&&!window.isc.module_VisualBuilder){isc.module_VisualBuilder=1;isc._moduleStart=isc._VisualBuilder_start=(isc.timestamp?isc.timestamp():new Date().getTime());if(isc._moduleEnd&&(!isc.Log||(isc.Log&&isc.Log.logIsDebugEnabled('loadTime')))){isc._pTM={message:'VisualBuilder load/parse time: '+(isc._moduleStart-isc._moduleEnd)+'ms',category:'loadTime'};if(isc.Log&&isc.Log.logDebug)isc.Log.logDebug(isc._pTM.message,'loadTime');else if(isc._preLog)isc._preLog[isc._preLog.length]=isc._pTM;else isc._preLog=[isc._pTM]}isc.definingFramework=true;isc.ClassFactory.defineClass("Project");isc.A=isc.Project;isc.A.AUTOSAVE="VB_AUTOSAVE_PROJECT";isc.A.AUTOSAVE_MOCKUPS="MOCKUPS_AUTOSAVE_PROJECT";isc.A.AUTOSAVE_SINGLE_SCREEN="VB_SINGLE_SCREEN";isc.A=isc.Project.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.screensDefaults={_constructor:"Tree",openProperty:"_isOpen_",parentProperty:"_parent_"};isc.A.$203f="_copy";isc.A.saveScreenDialogConstructor='ProjectFileSaveDialog';isc.A.saveScreenDialogDefaults={title:'Save Screen',actionButtonTitle:'Save Screen',fileType:'ui',fileFormat:'xml'};isc.A.autoSavePause=500;isc.A.disableAutoSave=0;isc.A.saveProjectDialogConstructor='ProjectFileSaveDialog';isc.A.saveProjectDialogDefaults={title:'Save Project',actionButtonTitle:'Save Project',fileType:'proj',fileFormat:'xml'};isc.B.push(isc.A.setFileName=function isc_Project_setFileName(_1){this.fileName=_1;if(!this.fileSpec){this.fileSpec={fileType:"proj",fileFormat:"xml"};if(this.builder.userId)this.fileSpec.ownerId=this.builder.userId}
this.fileSpec.fileName=_1},isc.A.setFileSpec=function isc_Project_setFileSpec(_1){this.fileSpec={fileName:_1.fileName,fileType:_1.fileType,fileFormat:_1.fileFormat,ownerId:_1.ownerId};this.setFileName(_1.fileName);this.setName(_1.fileName);this.$2103=_1.id;var _2=this.builder.projectDataSource;this.lastLoadVersion=_2.$209c(_1);this.setReadOnly(this.builder.mustBeOwnerToSave&&this.builder.userId&&_1.ownerId!=this.builder.userId)},isc.A.setReadOnly=function isc_Project_setReadOnly(_1){if(this.readOnly!=_1){this.readOnly=_1;if(this.readOnly)this.promptToCopy=true}},isc.A.isReadOnly=function isc_Project_isReadOnly(){return this.readOnly},isc.A.getOwnerId=function isc_Project_getOwnerId(){return(this.fileSpec?this.fileSpec.ownerId:null)},isc.A.setName=function isc_Project_setName(_1){this.name=_1;this.$42i=null},isc.A.getID=function isc_Project_getID(){if(!this.$42i){var _1=this.name;if(_1){if(!String.isValidID(_1)){_1=_1.replace(/ /g,"_")}
if(!String.isValidID(_1)){_1="c"+_1.replace(/[^a-zA-Z0-9]/g,"_")}}
this.$42i=_1}
return this.$42i},isc.A.addDatasource=function isc_Project_addDatasource(_1,_2){var _3=this.datasources.findIndex("dsName",_1);if(_3==-1){this.datasources.addAt({dsName:_1,dsType:_2},0);this.autoSaveSoon()}
this.builder.lastUsedDataSource=_1},isc.A.removeDatasource=function isc_Project_removeDatasource(_1){var _2=this.datasources.findIndex("dsName",_1);if(_2>=0){var _3=this,_4=this.builder,_5;var _6=function(_15){var _7=function(){_2=this.datasources.findIndex("dsName",_1);_3.datasources.removeAt(_2);_3.autoSaveSoon()};if(_15){isc.showPrompt("Removing relations... ${loadingImage}");var _8=_15.length;for(var i=0;i<_15.length;i++){var _10=isc.DS.get(_15[i]);_5.removeRelationsToDataSource(_10,_1,function(){if(--_8==0){isc.clearPrompt();_7()}})}}else{_7()}};if(_4.cleanupRelationsOnDataSourceRemove){isc.showPrompt("Checking for affected relations... ${loadingImage}");_4.loadAllProjectDataSources(function(){var _11=_3.datasources;var _12=[];_11.map(function(_21){if(!_21)return;var _13=isc.DS.get(_21.dsName);if(_13)_12.add(_13)});_5=isc.DSRelations.create({dsDataSource:_4.dsDataSource,ownerId:_4.userId,dataSources:_12});var _14=_5.getRelationsForDataSource(_1),_15=[];for(var i=0;i<_14.length;i++){var _16=_14[i];if(_16.type=="1-M")_15.add(_16.dsId)}
var _17=[];for(var i=0;i<_15.length;i++){var _18=_15[i],_13=isc.DS.get(_18);if(_13&&_13.apidoc==false||_13.isSampleDS==true){_17.add(_15[i])}}
if(_17.length>0){_15.removeList(_17)}
isc.clearPrompt();if(_15.length==0){_6();return}
var _19=_15.join(", "),_20="This DataSource has relations to the following other DataSources: "+_19+".<P>If you remove this DataSource these relations will be removed as well";isc.confirm(_20,function(_21){if(_21==true)_6(_15)},{buttons:[isc.Dialog.CANCEL,{title:"Continue",width:75,overflow:"visible",click:function(){this.topElement.okClick()}}],autoFocusButton:0})})}else{_6()}}},isc.A.setCurrentScreenId=function isc_Project_setCurrentScreenId(_1){if(this.currentScreenId!==_1){this.currentScreenId=_1;this.autoSaveSoon()}},isc.A.setCurrentScreenFileName=function isc_Project_setCurrentScreenFileName(_1){if(this.currentScreenFileName!==_1){this.currentScreenFileName=_1;this.autoSaveSoon();this.builder.updateRecentScreens()}},isc.A.init=function isc_Project_init(){this.Super("init",arguments);if(!this.datasources)this.datasources=[];this.addAutoChild("screens");this.observe(this.screens,"dataChanged","observer.autoSaveSoon();")},isc.A.destroy=function isc_Project_destroy(){this.ignore(this.screens,"dataChanged");this.Super("destroy",arguments)},isc.A.autoAssignProjectName=function isc_Project_autoAssignProjectName(_1){var _2=this.builder,_3=(_2.userId?_2.userId+"'s Project":"Starter Project"),_4={fileName:_3,fileType:"proj",fileFormat:"xml",indexPrefix:" "};_2.projectDataSource.uniqueName(_4,function(_5,_6,_7){if(_6){_1(_6.fileName);return}
isc.Notify.addMessage("Unable to obtain a new unique project name")})},isc.A.autoAssignScreenName=function isc_Project_autoAssignScreenName(_1){var _2=this.builder,_3={fileName:"New Screen",firstFileName:"Main Screen",fileType:"ui",fileFormat:"xml",fileLastModified:new Date(),lastUsedInProject:this.fileName,indexPrefix:" "};_2.screenDataSource.uniqueName(_3,function(_4,_5,_6){if(_5){_1(_5.fileName);return}
isc.Notify.addMessage("Unable to obtain a new unique screen name")})},isc.A.getUniqueProjectCopyName=function isc_Project_getUniqueProjectCopyName(_1,_2){var _3=this.builder;_1=_1.replace(/\s+copy(?:\s+\(\d+\))?$/,"");var _4={fileName:_1+" copy",fileType:"proj",fileFormat:"xml",indexPrefix:" (",indexSuffix:")"};_3.projectDataSource.uniqueName(_4,function(_5,_6,_7){if(_6){_2(_6.fileName);return}
isc.Notify.addMessage("Unable to obtain a new unique project copy name")})},isc.A.getUniqueScreenCopyName=function isc_Project_getUniqueScreenCopyName(_1,_2){var _3=this.builder;_1=_1.replace(/\s+copy(?:\s+\(\d+\))?$/,"");var _4={fileName:_1+" copy",fileType:"ui",fileFormat:"xml",indexPrefix:" (",indexSuffix:")"};_3.screenDataSource.uniqueName(_4,function(_5,_6,_7){if(_6){_2(_6.fileName);return}
isc.Notify.addMessage("Unable to obtain a new unique screen copy name")})},isc.A.getUniqueDataSourceCopyName=function isc_Project_getUniqueDataSourceCopyName(_1,_2){var _3=this.builder;var _4=new RegExp(this.$203f+"(?:\\d+)?$");_1=_1.replace(_4,"");var _5={fileName:_1+this.$203f,fileType:"ds",fileFormat:"xml"};_3.dsDataSource.uniqueName(_5,function(_6,_7,_8){if(_7){_2(_7.fileName);return}
isc.Notify.addMessage("Unable to obtain a new unique data source name")})},isc.A.isEmpty=function isc_Project_isEmpty(){return this.screens.getLength()==0},isc.A.addScreen=function isc_Project_addScreen(_1,_2,_3,_4,_5){if(!_1)_1=this.screens.getRoot();if(!_2)_2="";var _6;if(this.builder.singleScreenMode){this.screens.removeList(this.screens.getAllNodes())}else{_6=this.findScreen(_2);if(_6){if(_2){if(!_5){return _6}}else{if(!this.builder||!this.builder.singleScreenMode){_6=null}}}}
var _7=this.screens.add({fileName:_2,title:_3,contents:_4,isFolder:false},_1);if(_6)this.removeScreen(_6);this.autoSaveSoon();return _7},isc.A.removeScreen=function isc_Project_removeScreen(_1,_2){if(!_1)return;this.screens.remove(_1);if(_2){var _3=this.builder.getProjectDisplayName();this.builder.$210g("removeScreen",_1.title,_3)}},isc.A.addGroup=function isc_Project_addGroup(_1,_2){if(!_1)_1=this.screens.getRoot();return this.screens.add({title:_2,isFolder:true},_1)},isc.A.removeGroup=function isc_Project_removeGroup(_1){if(_1)this.screens.remove(_1)},isc.A.findScreen=function isc_Project_findScreen(_1){if(!_1)_1="";return this.screens.find({fileName:_1,isFolder:false})},isc.A.firstScreen=function isc_Project_firstScreen(_1){var _2={isFolder:false};if(_1!=null)_2.mockupMode=_1;return this.screens.find(_2)},isc.A.lastSavedScreen=function isc_Project_lastSavedScreen(_1){var _2={isFolder:false};if(_1!=null)_2.mockupMode=_1;var _3=this.screens.findAll(_2);if(!_3||_3.length==0)return null;_3=_3.sortByProperty("lastSave",false,function(_5,_6,_7){var _4=_5[_6];return(isc.isA.String(_4)?new Date(_4):_4)});return _3[0]},isc.A.untitledScreen=function isc_Project_untitledScreen(){return this.findScreen(null)},isc.A.setScreenProperties=function isc_Project_setScreenProperties(_1,_2){isc.addProperties(_1,_2);this.autoSaveSoon(!_1.fileName);return _1},isc.A.setScreenDirty=function isc_Project_setScreenDirty(_1,_2){var _3=_2?new Date():null;if(_3)this.screenDirty=_3;this.setScreenProperties(_1,{dirty:_3});this.autoSaveScreenSoon(_1)},isc.A.updateReifyPreviewSoon=function isc_Project_updateReifyPreviewSoon(){var _1=this.builder;if(_1&&_1.reifyWindow)_1.updateReifyPreviewSoon()},isc.A.$1741=function isc_Project__launchGoToBuilder(){if(this.builder)this.builder.$1741()},isc.A.$173p=function isc_Project__createConfirmDialogButton(_1,_2){return{title:_2,width:1,overflow:"visible",click:function(){var _3=this.topElement;_3.clear();_3.returnValue(_1)}}},isc.A.$173q=function isc_Project__saveScreenContentsConfirmOverwrite(_1){var _2=this;isc.confirm("You are editing an old screen version. Would you like to make it the current version or save it as a new screen? ",function(_3){switch(_3){case"overwrite":delete _1.oldVersionLoaded;_2.saveScreenContents(_1);break;case"saveAs":_2.builder.saveScreenAs(_1,function(){delete _1.contents;delete _1.oldVersionLoaded});break}},{buttons:[isc.Dialog.CANCEL,this.$173p("overwrite","Make Current Version"),this.$173p("saveAs","Save as New Screen")]})},isc.A.saveScreenContents=function isc_Project_saveScreenContents(_1,_2,_3,_4,_5){if(!_1)return;if(_1.oldVersionLoaded){return this.$173q(_1)}
var _6=this,_7=_1.dirty,_8=this.screenDataSource;if(_1.fileName){if(_2){this.builder.savingScreenLabel.setContents("Saving ...")}
_8.saveFile({fileName:_1.fileName,fileType:'ui',fileFormat:'xml',fileAutoSaved:!!_2,lastUsedInProject:_6.fileName,saveReason:_4},_1.contents,function(_10,_11,_12){if(!_11){isc.Notify.addMessage("Error saving screen '"+_12.data.fileName+"':<br>Your network connection may be down or the server unavailable. Will retry in 10 seconds.");_6.autoSaveScreenSoon(_1,10000);return}
_1.lastSaveVersion=_8.$209c(_11);if(_7==_1.dirty)_6.setScreenDirty(_1,false);if(_5&&_1.versions&&_1.versions.length==1){_8.removeFileVersion({fileName:_1.fileName,fileType:'ui',fileFormat:'xml',fileLastModified:_1.versions[0].fileLastModified});_1.versions=[]}
if(_6.builder.showRecentVersions){if(!_1.versions)_1.versions=[];else if(!isc.isAn.Array(_1.versions))_1.versions=[_1.versions];_1.versions.unshift(_11)}
if(_2){_6.builder.savingScreenLabel.setContents("All changes saved")}
_6.builder.resetUndoPosition(_1.lastSaveVersion);if(isc.Messaging&&_1.realTimeUpdates){isc.Messaging.send([_1.realTimeUpdates],"refresh")}
_6.fireCallback(_3,"screen",[_1])},{showPrompt:!_2})}else{if(!this.saveScreenDialog){this.saveScreenDialog=this.createAutoChild('saveScreenDialog',{dataSource:_8})}
this.saveScreenDialog.showSaveFileUI(_1.contents,null,function(_10,_11,_12){if(_7==_1.dirty)_6.setScreenDirty(_1,false);if(_11.fileName){var _9=_6.findScreen(_11.fileName);if(_9)_6.removeScreen(_9)}
_6.setScreenProperties(_1,{fileName:_11.fileName,title:_11.fileName});_6.fireCallback(_3,"screen",[_1])})}},isc.A.saveScreenAs=function isc_Project_saveScreenAs(_1,_2){var _3=this;var _4=(_1.fileName==null||_1.fileName=="");if(!this.saveScreenDialog){this.saveScreenDialog=this.createAutoChild('saveScreenDialog',{dataSource:this.screenDataSource})}
this.saveScreenDialog.showSaveFileUI(_1.contents,null,function(_7,_8,_9){if(_4){_3.setScreenDirty(_1,false);if(_8.fileName){var _5=_3.findScreen(_8.fileName);if(_5)_3.removeScreen(_5)}
_3.setScreenProperties(_1,{fileName:_8.fileName,title:_8.fileName});_3.setCurrentScreenFileName(_8.fileName);_6=_1}else{var _6=_3.addScreen(_3.screens.getParent(_1),_8.fileName,_8.fileName,_1.contents,true);_3.setScreenProperties(_6,{lastSave:new Date()});_3.builder.setCurrentScreen(_6)}
_3.fireCallback(_2,"screen",[_6])})},isc.A.fetchScreenContents=function isc_Project_fetchScreenContents(_1,_2,_3,_4){if(_1){if(_1.contents||!_1.fileName){this.fireCallback(_2,"contents",[_1.contents])}else{var _5=this,_6=_5.getOwnerId(),_7={ownerId:_6,fileName:_1.fileName,fileType:'ui',fileFormat:'xml'},_8=this.screenDataSource,_9=function(_11,_12,_13){if(_11.status<0){_5.fireCallback(_2,"contents",[null])}else{var _7=_12?_11.data[0]:null,_14=_8.$209c(_7);_1.contents=_12;_1.lastLoad=(!_3||_4?new Date():null);_1.lastLoadVersion=_14;_1.saveReason=(_7?_7.saveReason:null);_5.builder.withoutAutoSaving(function(){_5.setScreenDirty(_1,false)});_5.fetchScreenHistory(_1);_5.fireCallback(_2,"contents",[_12]);if(_4)_5.builder.resetUndoPosition(_14)}},_10={operationId:(_6?"allOwners":null)};if(_3!=null){_8.getFileVersion(_7,_3,_9,_10)}else{_8.getFile(_7,_9,_10)}}}else{this.fireCallback(_2,"contents",[null])}},isc.A.fetchScreenHistory=function isc_Project_fetchScreenHistory(_1){var _2=this.builder;if(!_2.showRecentVersions)return;var _3=_2.project.screenDataSource;if(_3)_3.listFileVersions({fileName:_2.getCurrentScreenTitle(),fileType:'ui',fileFormat:'xml'},function(_4,_5){if(_5&&!isc.isAn.Array(_5))_5=[_5];_1.versions=_5})},isc.A.getCurrentScreen=function isc_Project_getCurrentScreen(){var _1=this.builder;if(!_1)return;return _1.currentScreen},isc.A.xmlSerialize=function isc_Project_xmlSerialize(){var _1=this.getCurrentScreen();if(_1)_1.isCurrent=true;var _2={screens:this.createAutoChild("screens"),currentScreenFileName:this.currentScreenFileName,datasources:this.datasources};if(this.runConfigurations)_2.runConfigurations=this.runConfigurations;if(this.authentication)_2.authentication=this.authentication;_2.screens.setRoot(this.screens.getCleanNodeData(this.screens.getRoot(),true,true,true));_2.screens.getAllNodes().map(function(_6){if(!_6.dirty||_6.fileName){delete _6.contents}
delete _6.dirty;delete _6.name;delete _6.id;delete _6.parentId;if(_6.children&&_6.children.length==0)delete _6.children});var _3=isc.DS.get("ProjectAuthentication"),_4=(_3?_3.getField("users"):null);if(_4){_4.type=isc.Auth.getUserSchema()}
var _5=isc.DS.get("Project").xmlSerialize(_2);if(_1)delete _1.isCurrent;_2.screens.destroy();return _5},isc.A.autoSaveSoon=function isc_Project_autoSaveSoon(_1){if(!this.disableAutoSave){this.fireOnPause("autoSave",function(){this.autoSave(_1!=false?"updateReifyPreviewSoon":null)},this.autoSavePause,"return !isc.EH.dragging")}},isc.A.autoSave=function isc_Project_autoSave(_1){if(this.disableAutoSave||this.isReadOnly())return;if(this.fileName){this.save(_1,{showPrompt:false},true)}else{var _2=isc.Project.AUTOSAVE;if(this.builder){this.builder.cacheCurrentScreenContents();if(this.builder.singleScreenMode)_2=isc.Project.AUTOSAVE_SINGLE_SCREEN;if(this.builder.mockupMode)_2=isc.Project.AUTOSAVE_MOCKUPS}
isc.Offline.put(_2,this.xmlSerialize());this.screenDirty=null;this.fireCallback(_1)}},isc.A.save=function isc_Project_save(_1,_2,_3){if(this.isReadOnly())return;if(this.fileName){if(this.builder)this.builder.cacheCurrentScreenContents();var _4=this,_5=this.screenDirty,_6=this.projectDataSource,_7=isc.addProperties({fileAutoSaved:!!_3},this.fileSpec);_6.saveFile(_7,this.xmlSerialize(),function(_8,_9){if(_5==_4.screenDirty)_4.screenDirty=null;_4.lastSaveVersion=_6.$209c(_9);_4.fireCallback(_1)},_2)}else if(!_3){this.saveAs(_1)}},isc.A.autoSaveScreenSoon=function isc_Project_autoSaveScreenSoon(_1,_2){if(this.disableAutoSave||this.isReadOnly())return;if(!_1.dirty||!_1.fileName||_1.oldVersionLoaded)return;this.fireOnPause("autoSaveScreen"+_1.fileName,function(){this.saveScreenNow(_1)},_2||this.autoSavePause,"return !isc.EH.dragging");this.cancelActionOnPause("autoSave")},isc.A.saveScreenNow=function isc_Project_saveScreenNow(_1,_2){if(!_1.dirty||!_1.fileName||_1.oldVersionLoaded){if(_2)this.fireCallback(_2);return}
var _3=this,_4=this.builder;var _5=function(_19,_8,_2){_3.setScreenProperties(_1,{lastSave:new Date()});_3.saveScreenContents(_1,true,_2,_19,_8)};var _6=function(){_3.updateReifyPreviewSoon();if(_2)_3.fireCallback(_2)};var _7,_8;if(_4.addScreenSaveReasonFromUndoLog){var _9=_1.lastSave;if(_9!=null){if(isc.isA.String(_9))_9=new Date(_9);_7=_4.projectComponents.editContext.getCombinedUndoLogDescriptions(_9.getTime())}}
if(_4.currentScreen==_1){if(_4.screenIsUndoVersion()){var _10=_4.getUndoMarkerVersions()||[];if(_10.length>0){var _11=[],_12=_10.length;var _13=function(){isc.RPC.startQueue();for(var i=0;i<_11.length;i++){var _15=_10[i],_16=_11[i];_4.screenDataSource.saveFile({fileName:_1.fileName,fileType:'ui',fileFormat:'xml',fileAutoSaved:true,fileLastModified:_15,lastUsedInProject:_3.fileName,saveReason:"Undo marker"},_16,function(_19,_20,_21){if(!_20)return;if(_4.showRecentVersions)_1.versions.unshift(_20)})}
_5("Undo marker",_8,function(){_1.contents=_4.getUpdatedSource();_5(_7,_8,_6)});isc.RPC.sendQueue()};for(var i=0;i<_12;i++){var _17=_3.getOwnerId();_4.screenDataSource.getFileVersion({ownerId:_17,fileName:_1.fileName,fileType:'ui',fileFormat:'xml'},_10[i],function(_19,_20,_21){var _18=_19.clientContext.markerIndex;_11[_18]=_20;if(--_12==0)_13()},{operationId:(_17?"allOwners":null),clientContext:{markerIndex:i}})}
if(_12==0&&_2)_3.fireCallback(_2)}else{_5("Undo marker",_8,function(){_1.contents=_4.getUpdatedSource();_5(_7,_8,_6)})}
return}
_8=(_1.contents==null);_1.contents=_4.getUpdatedSource()}
_5(_7,_8,_6)},isc.A.exportProjectWindow=function isc_Project_exportProjectWindow(_1,_2){var _2=_2,_3=_2.project,_4="Export Project";var _5=isc.Window.create({title:_4,width:520,overflow:"visible",autoSize:true,isModal:true,showModalMask:true,autoCenter:true,padding:8,items:[isc.DynamicForm.create({isGroup:false,width:"100%",numCols:2,colWidths:["40%","*"],items:[{title:"Project File",name:"projectArchiveName",type:"text",hint:".proj.zip",defaultValue:(!_3.name)?"":_3.name,required:true},{title:"Project Type",name:"projectType",type:"select",redrawOnChange:true,defaultValue:"smartclient",valueMap:{"smartclient":"SmartClient","smartgwt":"Smart GWT"},changed:function(_21,_22,_23){if(_23=="smartclient"){_21.setValue("includeJSP",true);_21.setValue("includeHTML",false);_21.setValue("datasourcesDir","shared/ds")}else{_21.setValue("includeJSP",false);_21.setValue("includeHTML",true);_21.setValue("datasourcesDir","ds")}}},{defaultValue:"Advanced Settings",type:"section",sectionExpanded:false,itemIds:["datasourcesDir","includeTestData","uiDir","projectToExport","includeHTML","htmlFilePath","includeJSP","jspFilePath","includeProjectFile","projectDir"]},{title:"DataSources directory",name:"datasourcesDir",type:"text",defaultValue:"shared/ds"},{title:"Include Test Data?",name:"includeTestData",type:"checkbox",height:25,value:true,showIf:(_2.hostedMode?"false":null)},{title:"Screens directory",name:"uiDir",type:"text",defaultValue:"shared/ui"},{title:"Include Project file?",name:"includeProjectFile",type:"checkbox",height:25,redrawOnChange:true,value:true},{title:"Project File Name",name:"projectToExport",type:"text",hint:".proj.xml",showIf:"form.getValue('includeProjectFile') == true",defaultValue:(!_3.name)?"":_3.name,required:true},{title:"Path to the Project file",name:"projectDir",type:"text",showIf:"form.getValue('includeProjectFile') == true",defaultValue:"shared/ui"},{title:"Include HTML launch file?",name:"includeHTML",type:"checkbox",height:25,showIf:"form.getValue('projectType') == 'smartgwt'",redrawOnChange:true,value:false},{title:"Path to the HTML launch file",name:"htmlFilePath",type:"text",showIf:"form.getValue('includeHTML') == true",required:true,hint:".html",defaultValue:(!_3.name)?"":_3.name},{title:"Include JSP launch file?",name:"includeJSP",type:"checkbox",height:25,redrawOnChange:true,value:true},{title:"Path to the JSP launch file",name:"jspFilePath",type:"text",showIf:"form.getValue('includeJSP') == true",required:true,hint:".jsp",defaultValue:(!_3.name)?"":_3.name},{type:"RowSpacerItem",shouldSaveValue:false},{type:"button",title:"Export",width:100,colSpan:2,align:"right",click:function(_21,_22){if(!_21.validate())return;var _6=_21.getValue('includeProjectFile'),_7=_21.getValue('includeJSP'),_8=_21.getValue('includeHTML'),_9=_21.getValue('includeTestData'),_10=_21.getValue('projectArchiveName'),_11=_21.getValue('projectToExport'),_12=_21.getValue('projectDir')||"",_13={},_14={},_15={},_16="",_17="";if(_11.toLowerCase().indexOf(".proj.xml")!=-1){_11=_11.substring(0,_11.indexOf(".proj.xml"))}
if(_10.toLowerCase().indexOf(".proj.zip")==-1){_10=_10+".proj.zip"}
if(_7&&_1){var _18=_21.getValue('jspFilePath');if(_18.toLowerCase().indexOf(".jsp")==-1)_18=_18+".jsp";_14={path:_18,content:_2.$191b(_11,_1)};_13["README.txt"]=_2.$2202()}
if(_8){var _19=_21.getValue('htmlFilePath');if(_19.toLowerCase().indexOf(".html")==-1)_19=_19+".html";if(_19.contains("/")){_17=_19.substring(0,_19.lastIndexOf("/")+1)}
_15={path:_19,content:_2.$189r(_11,_1,_17)};_13["README.txt"]=_2.$2203()}
if(_6&&_12.trim().length>0){if(_12.substring(_12.length-1,_12.length)!="/"){_12=_12+"/"}
_16=_12}
var _20={projectType:_21.getValue('projectType'),datasourcesDir:_21.getValue('datasourcesDir'),includeTestData:_9,uiDir:_21.getValue('uiDir'),includeJSP:_7,jspFilePath:_14,includeHTML:_8,htmlFilePath:_15,includeProjectFile:_6,projectDir:_16,projectArchiveName:_10,userFiles:_13};_2.exportProject(_11,_20);_5.destroy()}}]})]});_5.show()},isc.A.saveAs=function isc_Project_saveAs(_1){if(this.isReadOnly())return;if(this.builder)this.builder.cacheCurrentScreenContents();if(!this.saveProjectDialog){this.saveProjectDialog=this.createAutoChild("saveProjectDialog",{dataSource:this.projectDataSource})}
var _2=this;var _3=this.screenDirty;this.saveProjectDialog.showSaveFileUI(this.xmlSerialize(),null,function(_4,_5,_6){isc.Offline.remove(isc.Project.AUTOSAVE);if(_3==_2.screenDirty)_2.screenDirty=null;_2.setFileName(_5.fileName);_2.setName(_5.fileName);_2.fireCallback(_1)})},isc.A.rename=function isc_Project_rename(_1){if(this.isReadOnly())return;if(this.fileName==null){this.saveAs();return}
var _2=this;this.showRenameDialog("Rename Project",this.fileName,"proj","xml",this.builder.projectDataSource,function(_3){_2.setFileName(_3);_2.setName(_3);_2.save(_1)})},isc.A.renameCurrentScreen=function isc_Project_renameCurrentScreen(_1){var _2=this,_3=this.getCurrentScreen();if(this.currentScreenFileName==null||!_3.fileName==null){this.saveScreenAs(_3,_1);return}
this.showRenameDialog("Rename Screen",_3.fileName,"ui","xml",this.builder.screenDataSource,function(_4){_2.finishRenameScreenTo(_4)})},isc.A.showRenameDialog=function isc_Project_showRenameDialog(_1,_2,_3,_4,_5,_6){var _7=this,_8;var _9=isc.DynamicForm.create({width:500,autoDraw:false,autoFocus:true,bottomPadding:5,topPadding:5,cellPadding:5,numCols:2,colWidths:[50,"*"],items:[{showTitle:false,editorType:"CanvasItem",height:50,icons:[{width:32,height:32,src:"[SKIN]/Dialog/ask.png"}]},{name:"newFileName",editorType:"TextItem",width:"*",title:"Rename "+_2+" to",titleOrientation:"top",required:true,changed:"form.clearValue('message'); form.markForRedraw()"},{type:"SpacerItem"},{name:"message",editorType:"BlurbItem",showTitle:false,startRow:false,showIf:"value != null"}],saveOnEnter:true,submit:function(){this.rename()},rename:function(){if(!this.validate())return;var _9=this,_10=this.getValue("newFileName");_7.renameFile(_2,_10,_3,_4,_5,function(_17,_18){if(_17){_8.destroy();_6(_17);return}
if(_18=="oldFileName"){if(_3=="proj"){_7.setFileName(_10);_7.setName(_10);_7.autoSave(function(){_8.destroy();_6(_10)})}else{var _11=_7.getCurrentScreen();_11.fileName=_10;_7.saveScreenContents(_11,true,function(){_8.destroy();_6(_10)})}
return}
var _12=_10+" ("+_7.fileName+")";_7.screenDataSource.getFile({fileName:_10,fileType:'ui',fileFormat:'xml'},function(_19,_20,_21){var _13=_19.data[0],_14=_13.lastUsedInProject;if(_14&&_14==_7.fileName){var _15=isc.Canvas.imgHTML({src:"[SKINIMG]actions/exclamation.png"})+" "+_10+" already exists";_9.setValue("message",_15);_9.focusInItem("newFileName");_9.markForRedraw();return}
var _15="You already have screen called \""+_10+"\""+(_14?", last used in project \""+_14+"\"":"")+".<P>Would you like to name your screen \""+_12+"\" instead?";isc.warn(_15,function(_22){if(_22){_9.setValue("newFileName",_12);_9.delayCall("rename");return}
var _15=isc.Canvas.imgHTML({src:"[SKINIMG]actions/exclamation.png"})+" "+_10+" already exists";_9.setValue("message",_15);_9.focusInItem("newFileName");_9.markForRedraw()},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1})})})}});var _16=isc.HLayout.create({autoDraw:false,width:500,height:20,align:"right",membersMargin:10,padding:10,members:[isc.Button.create({title:"Cancel",click:function(){_8.destroy()}}),isc.Button.create({title:"Rename",name:"rename",click:function(){_9.rename()}})]});_8=isc.Window.create({title:_1,autoSize:true,items:[_9,_16],autoCenter:true});_8.show()});isc.evalBoundary;isc.B.push(isc.A.renameScreenTo=function isc_Project_renameScreenTo(_1){var _2=this,_3=this.getCurrentScreen(),_4=_3.fileName;this.renameFile(_4,_1,"ui","xml",this.builder.screenDataSource,function(_5,_6){if(_6=="oldFileName"){var _3=_2.getCurrentScreen();_3.fileName=_1;_2.saveScreenContents(_3,true,function(){_2.finishRenameScreenTo(_1)});return}
_2.finishRenameScreenTo(_5)})},isc.A.finishRenameScreenTo=function isc_Project_finishRenameScreenTo(_1){var _2=this.getCurrentScreen();if(_2)this.builder.$210g("renameScreen",_1,_2.fileName);var _3=this.addScreen(this.screens.getParent(_2),_1,_1,_2.contents,true);this.setScreenProperties(_3,{lastSave:new Date()});this.builder.setCurrentScreen(_3);this.removeScreen(_2)},isc.A.renameFile=function isc_Project_renameFile(_1,_2,_3,_4,_5,_6){_5.renameFile({fileName:_1,fileType:_3,fileFormat:_4},{fileName:_2,fileType:_3,fileFormat:_4},function(_8,_9,_10){var _7=null;if(_8.status<0){_2=null;if(_8.data=="destination file already exists"){_7="newFileName"}else if(_8.data=="source file does not exist"){_7="oldFileName"}}
_6(_2,_7)})},isc.A.duplicate=function isc_Project_duplicate(){var _1=this,_2=this.builder;_2.withoutDirtyTracking(function(){_2.clearScreenUI()});isc.showPrompt("Copying project datasources... ${loadingImage}");this.duplicateProjectDataSources(function(_7){isc.showPrompt("Copying project screens... ${loadingImage}");_1.duplicateProjectScreens(_7,function(){isc.showPrompt("Saving copied project... ${loadingImage}");_1.getUniqueProjectCopyName(_1.fileName,function(_8){_1.setFileName(_8);_1.setReadOnly(false);var _3=_1.screens.getAllNodes(),_4=_3.length;for(var i=0;i<_3.length;i++){var _6=_3[i];_1.saveScreenContents(_6,true,function(){if(--_4==0){_1.autoSave(function(){_2.loadProject(_1.fileName);isc.clearPrompt()})}})}})})})},isc.A.duplicateProjectDataSources=function isc_Project_duplicateProjectDataSources(_1){var _2=this,_3=_2.builder,_4=this.getOwnerId(),_5=this.datasources,_6={},_7=0;if(!_5||_5.length==0){_2.fireCallback(_1,"dsMap",[_6])}
for(var i=0;i<_5.length;i++){_6[_5[i].dsName]=null;_7++}
for(var i=0;i<_5.length;i++){var _9=_5[i].dsName;_3.dsDataSource.getFile({ownerId:_4,fileName:_9,fileType:"ds",fileFormat:"xml"},function(_11,_12,_13){var _9=_11.data[0].fileName;_2.getUniqueDataSourceCopyName(_9,function(_14){_12=_12.replace("ID=\""+_9+"\"","ID=\""+_14+"\"");_3.dsDataSource.saveFile({fileName:_14,fileType:"ds",fileFormat:"xml"},_12,function(_11,_12,_13){if(_11.status>=0){isc.ClassFactory.$180h(true);isc.DS.get(_14,function(_15){var _10=isc.DS.get(isc.isAn.Array(_15)?_15[0]:_15);isc.ClassFactory.$180h(null);_6[_9]=_10.ID;for(var i=0;i<_5.length;i++){if(_5[i].dsName==_9){_5[i].dsName=_10.ID}}
if(--_7==0){_2.fireCallback(_1,"dsMap",[_6])}},{loadParents:true})}},{operationId:"allOwners"})})},{operationId:(_4?"allOwners":null)})}},isc.A.duplicateProjectScreens=function isc_Project_duplicateProjectScreens(_1,_2){var _3=this,_4=this.builder,_5=this.screens.getAllNodes(),_6=_5.length,_7=[];var _8=isc.EditPane.create({autoDraw:false,defaultPalette:_4.libraryComponents});var _9=function(_15){_3.getUniqueScreenCopyName(_15.fileName,function(_16){_15.fileName=_16;_15.title=_16;if(--_6==0){if(_7.length>0)_3.screens.removeList(_7);_3.fireCallback(_2)}})};var _10=function(_15){_7.add(_15);if(--_6==0){if(_7.length>0)_3.screens.removeList(_7);_3.fireCallback(_2)}};var _11=function(_15){if(_15.contents){_3.renameScreenDataSources(_8.getEditContext(),_1,_15.contents,function(_16){_15.contents=_16;_9(_15)})}else if(_15.fileName){var _12=_3.getOwnerId(),_13={ownerId:_12,fileName:_15.fileName,fileType:'ui',fileFormat:'xml'};_4.screenDataSource.getFile(_13,function(_16,_17,_18){if(_16.status<0||!_16.data||_16.data.length==0){_10(_15)}else{_3.renameScreenDataSources(_8.getEditContext(),_1,_17,function(_19){_15.contents=_19;_9(_15)})}},{operationId:(_12?"allOwners":null)})}};for(var i=0;i<_5.length;i++){var _15=_5[i];_11(_15)}},isc.A.renameScreenDataSources=function isc_Project_renameScreenDataSources(_1,_2,_3,_4){var _5=this;_1.getPaletteNodesFromXML(_3,function(_13){_1.destroyAll();_1.addFromPaletteNodes(_13);var _6=_1.getEditNodeTree(),_7=_6.getAllNodes(),_8=false;if(_7)_7.map(function(_14){if(_14.isLoaded&&_14.liveObject&&isc.isA.DataSource(_14.liveObject)){if(_2[_14.ID]!=null){var _9=isc.Tree.getCleanNodeData(_14,false,false,false,_6);delete _9.liveObject;delete _9.parentId;_9.ID=_2[_14.ID];if(_9.name)_9.name=_2[_14.ID];if(_9.defaults&&_9.defaults.ID)_9.defaults.ID=_2[_14.ID];var _10=_1.makeEditNode(_9),_11=_6.getParent(_14);_1.removeNode(_14);_1.addNode(_10,_11,0);_8=true}}});var _12=_1.serializeAllEditNodes();_5.fireCallback(_4,"contents,changed",[_12,_8])})},isc.A.renameDataSource=function isc_Project_renameDataSource(_1,_2,_3,_4){var _5={};_5[_1]=_2;var _6=this,_7=this.builder,_8=this.screens.getAllNodes();isc.showPrompt("Updating DataSource references in project screens... ${loadingImage}");_7.withoutDirtyTracking(function(){_7.clearScreenUI(true)});var _9=isc.EditPane.create({autoDraw:false,defaultPalette:_7.libraryComponents,editContextDefaults:{editNodeUpdated:function(_19,_18,_20){var _10=this.creator,_11=_10.defaultPalette,_12=isc.DS.getToolAutoIdField(_19);if(_12&&_19.defaults&&_19.defaults[_12]){var _13;if(_20.contains("dataSource")){var _14=isc.DS.get(_19.liveObject.dataSource),_15=(_14?_14.ID:null);if(_15){var _16=_19.idName||_19.idPrefix||_19.type;_13=_11.getNextAutoId(_16,_19,_15,_10.editContext.editNodeTree)}}
if(_13&&_12){var _17={};_17[_12]=_13;_18.setNodeProperties(_19,_17)}}}}});var _18=_9.getEditContext();if(_3)_18.fieldRenames=_3;this.$2093(_18,_5,_8,function(){_9.destroy();_7.loadProject(_6.fileName);isc.clearPrompt();isc.Notify.addMessage("DataSource successfully renamed");if(_4)_4()})},isc.A.$2093=function isc_Project__renameDataSourceOnScreens(_1,_2,_3,_4,_5,_6){var _7=this;if(_5==null)_5=0;if(!_6){_6={screenNodes:_3,screenCount:_3.length,saveCount:_3.length,screensChanged:{}}}
var _8=_3[_5];this.$2094(_1,_2,_6,_8,function(){if(++_5<_3.length){_7.$2093(_1,_2,_3,_4,_5,_6);return}
for(var i=0;i<_6.screenNodes.length;i++){var _10=_6.screenNodes[i],_11=function(){if(--_6.saveCount==0){_7.autoSave(function(){if(_4)_4()})}};if(!_6.screensChanged[_10.title]){_11()}else{_7.saveScreenContents(_10,true,_11)}}})},isc.A.$2094=function isc_Project__renameDataSourceOnScreen(_1,_2,_3,_4,_5){var _6=this,_7=this.builder;var _8=function(_4,_10){_3.screensChanged[_4.title]=_10};if(_4.contents){_6.renameScreenDataSources(_1,_2,_4.contents,function(_10,_11){_4.contents=_10;_8(_4,_11);_6.fireCallback(_5)})}else if(_4.fileName){var _9={ownerId:_6.getOwnerId(),fileName:_4.fileName,fileType:'ui',fileFormat:'xml'};_7.screenDataSource.getFile(_9,function(_10,_11,_12){if(_10.status<0){_8(_4);_6.fireCallback(_5)}else{_6.renameScreenDataSources(_1,_2,_11,function(_13,_14){_4.contents=_13;_8(_4,_14);_6.fireCallback(_5)})}})}},isc.A.saveGoToBuilderScreen=function isc_Project_saveGoToBuilderScreen(_1,_2,_3){var _4={_constructor:"AdvancedCriteria",operator:"and",criteria:[{fieldName:"fileName",operator:"startsWith",value:_1},{fieldName:"fileType",operator:"equals",value:"ui"},{fieldName:"fileFormat",operator:"equals",value:"xml"}]};var _5=this.builder.screenDataSource;_5.listFiles(_4,function(_9){var _6,_7=_9.data,_8=_1;for(var _6=2;_7.find("fileName",_8);_6++){_8=_1+" ("+_6+")"}
_5.saveFile({fileName:_8,fileType:'ui',fileFormat:'xml'},_2,_3)})},isc.A.rebindCurrentScreenDataSources=function isc_Project_rebindCurrentScreenDataSources(_1,_2){var _3=this.builder.projectComponents,_4=_3.getEditContext(),_5=this;var _6=_4.getEditNodeArray();if(_6)_6.map(function(_13){if(_13.liveObject&&isc.isA.DataSource(_13.liveObject)){var _7=_13.liveObject;var _8=_5.builder.dataSourceList.data.find("ID",_7.ID);if(!_8)return;var _9=_5.builder.dataSourceList.makeEditNode(_8),_10;_9.liveObject=isc.DS.get(_7.ID);if(_13.referenceInProject!=_10)_9.referenceInProject=_13.referenceInProject;var _11=(_1!=null?_1[_7.ID]:null);if(_11){_4.fieldRenames=_11}
var _12=_3.data.getParent(_13);_4.addNode(_9,_12,0,null,false,true,true);_4.fieldRenames=null}})},isc.A.updateCurrentScreenDataSourcesSecurity=function isc_Project_updateCurrentScreenDataSourcesSecurity(){var _1=this.builder.projectComponents,_2=_1.getEditContext(),_3=this,_4={};var _5=_2.getEditNodeArray();if(_5)_5.map(function(_11){if(_11.liveObject&&isc.isA.DataSource(_11.liveObject)){var _6=_11.liveObject;if(_4[_6.ID]||_6.calculateDeclarativeSecuritySettings()){_4[_6.ID]=true;var _7=_3.builder.dataSourceList.data.find("ID",_6.ID);if(!_7)return;var _8=_3.builder.dataSourceList.makeEditNode(_7),_9;_8.liveObject=isc.DS.get(_6.ID);if(_11.referenceInProject!=_9)_8.referenceInProject=_11.referenceInProject;var _10=_1.data.getParent(_11);_2.addNode(_8,_10,0,null,false,true,true)}}})});isc.B._maxIndex=isc.C+62;isc.ClassFactory.defineClass("VisualBuilder","VLayout");isc.A=isc.VisualBuilder;isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.titleEditEvent="doubleClick";isc.A.timeFormats=[[60,'seconds ago'],[120,'1 minute ago'],[3600,'minutes',60],[7200,'about 1 hour ago'],[86400,'hours',3600]];isc.B.push(isc.A.timeSince=function isc_c_VisualBuilder_timeSince(_1){if(_1==null||!_1.getTime)return"";_1=_1.getTime();var _2=new Date().getTime();var _3=(_2-_1)/1000;if(_3==0)return"Just now";var _4=new Date();_4.setDate(_4.getDate()-1);var _5=new Date();_5.setDate(_5.getDate()-6);var _6=new Date(_2-_3*1000);if(isc.DateUtil.compareLogicalDates(_6,_4)==0){return"yesterday at "+isc.DateUtil.format(_6,"h:mm a")}else if(isc.DateUtil.compareLogicalDates(_6,_4)>0&&isc.DateUtil.compareLogicalDates(_6,_5)<=0){return"on "+_6.getDayName()+" at  "+isc.DateUtil.format(_6,"h:mm a")}else if(isc.DateUtil.compareLogicalDates(_6,_5)>0){return"on "+isc.DateUtil.format(_6,"d MMMM, yyyy")}
var i=0,_8;while(_8=this.timeFormats[i++]){if(_3<_8[0]){if(_8[2]==null){return _8[1]}else{return Math.floor(_3/_8[2])+' '+_8[1]+' ago'}}}
return _1},isc.A.getEventDefinition=function isc_c_VisualBuilder_getEventDefinition(_1,_2){var _3="method:"+_1+"."+_2,_4=isc.jsdoc.getDocItem(_3);if(_4){var _5=isc.jsdoc.getAttribute(_4,isc.jsdoc.$46y);if(_5=="method"){if(!isc.jsdoc.getAttribute(_4,"deprecated")){return _4}
return null}}
var _5=isc.DS.get(_1);if(!_5||!_5.inheritsFrom)return null;var _6=isc.DS.get(_5.inheritsFrom);if(!_6)return null;return this.getEventDefinition(_6.ID,_2)});isc.B._maxIndex=isc.C+2;isc.A=isc.VisualBuilder.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.hostedMode=false;isc.A.mockDataSourceSampleWizardName="sampleData";isc.A.saveFileBuiltinIsEnabled=false;isc.A.loadFileBuiltinIsEnabled=false;isc.A.filesystemDataSourceEnabled=false;isc.A.skin="Tahoe";isc.A.defaultApplicationMode="edit";isc.A.skinValueMap={Tahoe:"Tahoe",Stratus:"Stratus",Obsidian:"Obsidian",Enterprise:"Enterprise",Graphite:"Graphite",EnterpriseBlue:"Enterprise Blue",Simplicity:"Simplicity",BlackOps:"Black Ops",TreeFrog:"TreeFrog"};isc.A.showScreenList=false;isc.A.immediatelySaveComponentChanges=true;isc.A.autoNameAndSaveProjectsAndScreens=!isc.Browser.seleniumPresent;isc.A.maxAutoSavesInRevertMenu=8;isc.A.keepUndoLog=false;isc.A.addScreenSaveReasonFromUndoLog=false;isc.A.allowLoadingOtherUsersScreensAndDataSources=false;isc.A.mustBeOwnerToSave=true;isc.A.enableRelationEditor=true;isc.A.openFullBuilderSeparately=true;isc.A.defaultComponentsURL="defaultComponents.xml";isc.A.defaultMockupComponentsURL="defaultMockupComponents.xml";isc.A.customComponentsURL="customComponents.xml";isc.A.globalDependenciesURL="globalDependencies.xml";isc.A.projectRunnerURL="projectRunner.jsp";isc.A.deploymentConsoleURL="deploymentConsole.jsp";isc.A.canAddRootComponents=false;isc.A.storageMode="dataSourceOnly";isc.A.offlineStorageKey="VisualBuilder-savedSettings";isc.A.settingsFile="vb.settings.xml";isc.A.dsWizardsFile="dataSourceWizards.xml";isc.A.defaultSettingsURL="default.vb.settings.xml";isc.A.defaultProjectURL="default.proj.xml";isc.A.$1724=[];isc.A.loadProjectDialogConstructor='ProjectFileLoadDialog';isc.A.loadProjectDialogDefaults={title:'Open Project',actionButtonTitle:'Open Project',fileType:'proj',fileFormat:'xml',useXmlToJs:true,showLoadFileUI:function(){if(this.creator.hostedMode){this.noFilesMessage="No projects found";this.disableFileName(true)}
this.Super("showLoadFileUI",arguments);if(this.creator.userId&&!this.creator.userIsGuest()){this.directoryListing.showField("ownerId");this.directoryListing.initialCriteria={ownerId:this.creator.userId};delete this.directoryListing.$201d}},directoryListingProperties:{canEdit:false,showFilterEditor:true,filterOnKeypress:true,filterLocalData:true,fields:[{name:"fileName",title:"Name",width:"*"},{name:"ownerId",title:"Owner",width:"*",hidden:true},{name:"fileLastModified",title:"Last Modified",type:"datetime",width:150}],setData:function(_1){if(_1&&!isc.isA.ResultSet(_1)&&!isc.isAn.emptyArray(_1)){_1=isc.ResultSet.create({dataSource:this.dataSource,allRows:_1});if(!this.$201d){this.$201d=true;if(this.initialCriteria){this.setFilterEditorCriteria(this.initialCriteria);_1.setCriteria(this.initialCriteria)}}}
this.Super("setData",arguments)}}};isc.A.dataSourcesSlowLoadInitialDelay=0;isc.A.dataSourcesSlowLoadDelay=0;isc.A.recentProjectsCount=5;isc.A.$174u=5000;isc.A.$174v="confirmReify";isc.A.$1742="confirmOpenInBuilder";isc.A.jspFileSourceDefaults={_constructor:"FileSource",defaultPath:"[VBWORKSPACE]",webrootOnly:false,saveWindowProperties:{title:"Export JSP",actionButtonTitle:"Export JSP",webrootOnly:false,fileFilters:[{filterName:"JSP Files",filterExpressions:[/.*\.jsp$/i]}],directoryListingProperties:{canEdit:false},getFileName:function(_1){if(_1.toLowerCase().endsWith(".jsp")){return _1}else{return _1+".jsp"}}}};isc.A.loadScreenDialogConstructor='ProjectFileLoadDialog';isc.A.loadScreenDialogDefaults={title:'Load Shared Screen',actionButtonTitle:'Load Screen',fileNameTitle:"Screen name",fileType:'ui',fileFormat:'xml',showLoadFileUI:function(){if(this.creator.hostedMode){this.noScreensMessage="No screens found";this.disableFileName(true)}
this.Super("showLoadFileUI",arguments);if(this.creator.hostedMode){var _1=isc.DS.get(this.creator.screenDataSource);if(_1&&_1.getField("lastUsedInProject")){this.directoryListing.showField("lastUsedInProject")}}
if(this.creator.userId&&!this.creator.userIsGuest()){if(this.creator.allowLoadingOtherUsersScreensAndDataSources){this.directoryListing.showField("ownerId")}
this.directoryListing.initialCriteria={ownerId:this.creator.userId};delete this.directoryListing.$201d}},directoryListingProperties:{canEdit:false,showFilterEditor:true,filterOnKeypress:true,filterLocalData:true,fields:[{name:"fileName",title:"Name",width:"*"},{name:"lastUsedInProject",title:"Last used in project",autoFitWidth:true,autoFitWidthApproach:"both",hidden:true},{name:"ownerId",title:"Owner",width:"*",hidden:true},{name:"fileLastModified",title:"Last Modified",type:"datetime",width:150}],setData:function(_1){if(_1&&!isc.isA.ResultSet(_1)&&!isc.isAn.emptyArray(_1)){_1=isc.ResultSet.create({dataSource:this.dataSource,allRows:_1});if(!this.$201d){this.$201d=true;if(this.initialCriteria){this.setFilterEditorCriteria(this.initialCriteria);_1.setCriteria(this.initialCriteria)}}}
this.Super("setData",arguments)}}};isc.A.$2098="loadSharedScreen";isc.A.recentScreensCount=3;isc.A.singleScreenMode=false;isc.A.singleScreenModeProjectFileName="vb.singleScreen";isc.A.vertical=true;isc.A.sControlIsomorphicDir="http://www.isomorphic.com/isomorphic/";isc.A.sControlSkin="SmartClient";isc.A.workspacePath="[VBWORKSPACE]";isc.A.workspaceURL="workspace/";isc.A.basePathRelWorkspace="..";isc.A.webRootRelWorkspace="../../..";isc.A.useFieldMapper=false;isc.A.helpPaneProperties={headerTitle:"Learn to Reify",contentsURL:(window.vbRootURL||"")+"visualBuilderHelp.html"};isc.A.canEditExpressions=true;isc.A.typeCount={};isc.A.disableDirtyTracking=0;isc.A.workspaceDefaults={_constructor:"TLayout",vertical:false,autoDraw:false,resizeBarProperties:{showRollOverTab:true,rollOverTabProperties:{hoverStyle:"darkHover"},rollOverTabCollapsedPrompt:"Expand side panel",rollOverTabExpandedPrompt:"Collapse side panel"},backgroundColor:isc.nativeSkin?null:"black"};isc.A.leftStackDefaults={_constructor:"TSectionStack",autoDraw:false,width:320,showResizeBar:true,visibilityMode:"multiple"};isc.A.middleStackDefaults={_constructor:"TSectionStack",sectionHeaderClass:"SectionHeaderLayout",autoDraw:false,showResizeBar:true,resizeBarTarget:"next",visibilityMode:"multiple",collapseSection:function(_1,_2){if(!this.creator.isInPreviewMode()){this.Super("collapseSection",arguments)}}};isc.A.modeSwitcherDefaults={_constructor:"ImgButton",autoDraw:false,size:24,src:"actions/preview.png",showFocused:false,actionType:"checkbox",editModeHoverTitle:"Preview your design",previewModeHoverTitle:"Exit preview mode and continue editing",canHover:true,hoverStyle:"darkHover",getHoverHTML:function(){var _1=!this.isSelected();if(_1)return this.editModeHoverTitle;else return this.previewModeHoverTitle},click:function(){this.updateSelectedMode()},updateSelectedMode:function(_1){if(_1)this.setSelected(!this.isSelected());var _2=!this.isSelected();var _3=this.creator;_3.editingOn=_2;_3.rootLiveObject.editingOn=_2;_3.projectComponents.switchEditMode(_2);if(_2)this.showEditMode(null,_1);else this.showPreview()},previewModeLabelConstructor:"Label",previewModeLabelDefaults:{autoDraw:false,height:24,autoFit:true,wrap:false,styleName:"previewModeLabel",contents:"Preview Mode"},showPreview:function(_1){var _2=this,_3=this.creator,_4=_3.currentScreen;if(_4.dirty){if(_4.fileName&&!_4.oldVersionLoaded){_3.project.saveScreenNow(_3.currentScreen,function(){_2.showPreview(_1)});return}
_4.contents=_3.getUpdatedSource()}
if(_3.showComponentAttributeEditor!=false){this.$2223=_3.componentAttributeEditor.getViewState()}
if(_3.showComponentMethodEditor!=false){this.$2224=_3.componentMethodEditor.getViewState()}
this.$221g=_3.projectComponents.getViewState();this.$221h=_3.projectComponents.getSelectedPaths();this.$221i=_3.projectComponents.getBody().getScrollTop();this.setEditMode(false);this.previewAreaBorder=_3.previewArea.getBorder();_3.previewArea.setBorder("6px solid #cccccc");if(!_3.$2000){var _5=_3.getScreenMockupMode(_3.currentScreen),_6=_3.projectComponents.getEditNodeTree(),_7=_6.getLength();if(_7==(_5?0:1)){_3.hideInstructions()}}
var _8=_3.projectComponents.data.getAllNodes();for(var i=0;i<_8.length;i++){var _10=_8[i],_11=_10.liveObject;if(isc.isA.ModalWindow(_11))_11.hide()}
_3.pageHeader.showComponentMask();_3.screenMenuButton.hide();_3.savingScreenLabel.hide();_3.$2190=true;_3.middleStack.expandSection("applicationSection");var _12=_3.middleStack.getSectionHeader("applicationSection"),_13=_12.controlsLayout;if(!this.previewModeLabel){var _14=Math.floor((_12.getVisibleHeight()-24)/2);this.previewModeLabel=this.createAutoChild("previewModeLabel",{top:_14})}
if(_12.title!=this.$215g){var _15=isc.SectionHeader.create({autoDraw:true,top:-9999,autoFit:true,title:_12.title});var _16=_15.getVisibleWidth()+20;_15.destroy();this.previewModeLabel.setLeft(_16);this.$215g=_12.title}
_12.addChild(this.previewModeLabel);if(_3.showDevicePreview){var _17=this.getDeviceSelector(),_18=_13.getMemberNumber(_3.savingScreenLabel);if(_18>=0){_13.addMember(_17,_18)}
this.showAsDevice(this.previewDevice,this.previewOrientation)}
_3.leftStack.animateHide({effect:"slide",startFrom:"R",endAt:"L"},function(){_2.observe(_3.leftStack,"visibilityChanged","observer.updateSelectedMode(true)")},150);_3.rightStack.animateHide({effect:"slide",startFrom:"L",endAt:"R"},function(){_2.observe(_3.rightStack,"visibilityChanged","observer.updateSelectedMode(true)")},150);_3.middleStack.hideSection("componentTree");var _19=_3.getTargetRuleScope();if(_19)_19.fireRuleContextChanged(_19);if(!this.jsScreenContents||_4.contents!=this.xmlScreenContents){this.xmlScreenContents=_4.contents;this.jsScreenContents=null;isc.DMI.callBuiltin({methodName:"xmlToJS",arguments:[_4.contents,true],callback:function(_20){_2.jsScreenContents=_20.data}})}
this.fireCallback(_1)},showEditMode:function(_1,_2){var _3=this.creator,_4=_3.currentScreen,_5=_3.getScreenMockupMode(_4);_3.previewArea.setBorder(this.previewAreaBorder);if(_3.showDevicePreview){this.showAsDevice("desktop")}
if(!_3.$2000){var _5=_3.getScreenMockupMode(_3.currentScreen),_6=_3.projectComponents.getEditNodeTree(),_7=_6.getLength();if(_7==(_5?0:1)){_3.showInstructions()}}
_3.pageHeader.hideComponentMask();_3.screenMenuButton.show();_3.savingScreenLabel.show();_3.$2190=false;var _8=_3.middleStack.getSectionHeader("applicationSection");_8.removeChild(this.previewModeLabel);if(_3.showDevicePreview){_8.controlsLayout.removeMember(this.deviceSelector)}
this.resetScreenMockDataSources();_3.$2000=true;_3.withoutDirtyTracking(function(){_3.projectComponents.destroyAll()});this.ignore(_3.leftStack,"visibilityChanged");this.ignore(_3.rightStack,"visibilityChanged");var _9=this,_10=3,_11=function(){if(--_10>0)return;_3.withoutDirtyTracking(function(){_3.setScreenContents(_4.contents,_5,_9.jsScreenContents)});_3.$2000=false;_3.projectComponents.setViewState(_9.$221g);_3.projectComponents.setSelectedPaths(_9.$221h);_3.projectComponents.getBody().delayCall("scrollTo",[0,_9.$221i]);delete _9.$221g;delete _9.$221h;delete _9.$221i;var _12=_3.projectComponents.getEditContext(),_13=_3.projectComponents.getSelectedRecords();_12.deselectAllComponents();isc.Timer.setTimeout(function(){for(var i=0;i<_13.length;i++){_12.selectComponent(_13[i].liveObject)}
_3.$2225=_9.$2223;_3.$2226=_9.$2224},100);if(_2){isc.Timer.setTimeout(function(){_9.showAutoSwitchedLabel()},100)}
_9.fireCallback(_1)};_10=(!_3.middleStack.sectionIsVisible("componentTree")&&1)+(!_3.leftStack.isVisible()&&1)+(!_3.rightStack.isVisible()&&1);_3.middleStack.showSection("componentTree",_11);_3.leftStack.animateShow({effect:"slide",startFrom:"L",endAt:"R"},_11,150);_3.rightStack.animateShow({effect:"slide",startFrom:"R",endAt:"L"},_11,150)},deviceSelectorDefaults:{_constructor:"ToolStrip",autoDraw:false,width:140,height:20,padding:0,membersMargin:0,desktopDeviceButtonDefaults:{_constructor:"ToolStripButton",autoDraw:false,height:20,title:"Desktop",showRollOver:false,showFocused:false,actionType:"radio",radioGroup:"device",click:function(){this.modeSwitcher.setDevice("desktop")}},tabletDeviceButtonDefaults:{_constructor:"ToolStripButton",autoDraw:false,height:20,title:"Tablet",showRollOver:false,showFocused:false,actionType:"radio",radioGroup:"device",click:function(){this.modeSwitcher.setDevice("tablet")}},handsetDeviceButtonDefaults:{_constructor:"ToolStripButton",autoDraw:false,height:20,title:"Smartphone",showRollOver:false,showFocused:false,actionType:"radio",radioGroup:"device",click:function(){this.modeSwitcher.setDevice("handset")}},initWidget:function(){var _1={modeSwitcher:this.creator},_2=this.createAutoChild("desktopDeviceButton",_1),_3=this.createAutoChild("tabletDeviceButton",_1),_4=this.createAutoChild("handsetDeviceButton",_1);this.members=[_2,_3,_4];this.Super("initWidget",arguments)}},getDeviceSelector:function(){if(!this.deviceSelector){this.deviceSelector=this.createAutoChild("deviceSelector")}
return this.deviceSelector},setDevice:function(_1){if(_1!=this.previewDevice){this.previewDevice=_1;this.previewOrientation=null;this.showAsDevice(_1,this.previewOrientation)}},rotateDevice:function(){var _1=this.previewOrientation||"portrait";var _1=(_1=="portrait"?"landscape":"portrait");this.previewOrientation=_1;this.showAsDevice(this.previewDevice,_1)},$2193:{desktop:{memberNumber:0,sizes:{portrait:{width:"100%",height:"100%"},landscape:{width:"100%",height:"100%"}}},tablet:{memberNumber:1,sizes:{portrait:{width:1024,height:1366},landscape:{width:1366,height:1024}},canReorient:true,border:"4px solid #222222",outline:{portrait:{adjustments:[-20,-20,40,60],items:[{_constructor:isc.DrawOval,width:30,height:30,centerAt:["50%",-25]}]},landscape:{adjustments:[-20,-20,60,40],items:[{_constructor:isc.DrawOval,width:30,height:30,centerAt:[-25,"50%"]}]}}},handset:{memberNumber:2,sizes:{portrait:{width:414,height:717},landscape:{width:717,height:414}},canReorient:true,border:"4px solid #222222",outline:{portrait:{adjustments:[-20,-20,40,60],items:[{_constructor:isc.DrawRect,width:50,height:5,centerAt:["50%",7]},{_constructor:isc.DrawOval,width:30,height:30,centerAt:["50%",-25]}]},landscape:{adjustments:[-20,-20,60,40],items:[{_constructor:isc.DrawRect,width:5,height:50,centerAt:[7,"50%"]},{_constructor:isc.DrawOval,width:30,height:30,centerAt:[-25,"50%"]}]}}}},deviceOutlineDefaults:{_constructor:isc.DrawPane,autoDraw:false,top:-1000,border:"4px solid #222222",styleName:"previewDeviceOutline",show:function(){var _1=this.builder.rootLiveObject;if(!this.isObserving(_1,"moved")){this.observe(_1,"moved","observer.updatePositionAndSize()")}
if(!this.isObserving(_1,"resized")){this.observe(_1,"resized","observer.updatePositionAndSize()")}
this.updatePositionAndSize();this.Super("show",arguments)},hide:function(){var _1=this.builder.rootLiveObject;this.ignore(_1,"moved");this.ignore(_1,"resized");this.setTop(-1000);this.Super("show",arguments)},updatePositionAndSize:function(){var _1=this.modeSwitcher,_2=this.builder.rootLiveObject,_3=_1.previewDevice,_4=_1.previewOrientation;_3=_3||"desktop";_4=_4||"portrait";var _5=_1.$2193[_3],_6=(_5.outline?_5.outline[_4]:null),_7=(_6?_6.adjustments:[0,0,0,0]);var _8=_2.getRect();for(var i=0;i<4;i++)_8[i]+=_7[i];this.setRect(_8);this.createItems()},createItems:function(){if(this.$2194){for(var i=0;i<this.$2194.length;i++){this.$2194[i].destroy()}}
var _2=this.modeSwitcher,_3=_2.previewDevice,_4=_2.previewOrientation;_3=_3||"desktop";_4=_4||"portrait";var _5=_2.$2193[_3],_6=(_5.outline?_5.outline[_4]:null),_7=(_6?_6.items:null);this.$2194=[];if(_7){for(var i=0;i<_7.length;i++){var _8=_7[i],_9=isc.ClassFactory.newInstance(_8._constructor,this.commonItemsDefaults,_8,{drawPane:this});this.$2194.add(_9)}}},commonItemsDefaults:{init:function(){this.Super("init",arguments);this.resolvePlacement()},parentResized:function(_1){this.resolvePlacement();this.Super("parentResized",arguments)},resolvePlacement:function(){if(!this.centerAt)return;var _1=this.centerAt[0],_2=this.centerAt[1];if(isc.isA.String(_1)){_1=parseInt(_1);if(_1!=null){if(!isc.isA.Number(_1))_1=0;_1=parseInt(_1/100*Math.max(0,this.drawPane.getVisibleWidth()))}}
if(_1<0)_1=this.drawPane.getVisibleWidth()+_1;_1-=Math.floor(this.width/2);if(isc.isA.String(_2)){_2=parseInt(_2);if(_2!=null){if(!isc.isA.Number(_2))_2=0;_2=parseInt(_2/100*Math.max(0,this.drawPane.getVisibleHeight()))}}
if(_2<0)_2=this.drawPane.getVisibleHeight()+_2;_2-=Math.floor(this.height/2);this.moveTo(_1,_2)}}},orientationButtonDefaults:{_constructor:isc.ImgButton,autoDraw:false,top:-1000,width:64,height:64,src:"deviceOrientation.png",canFocus:false,showDown:false,showFocused:false,showRollOver:false,click:function(){this.modeSwitcher.rotateDevice()},show:function(){var _1=this.builder.rootLiveObject;if(!this.isObserving(_1,"moved")){this.observe(_1,"moved","observer.updatePosition()")}
if(!this.isObserving(_1,"resized")){this.observe(_1,"resized","observer.updatePosition()")}
this.updatePosition();this.Super("show",arguments)},hide:function(){var _1=this.builder.rootLiveObject;this.ignore(_1,"moved");this.ignore(_1,"resized");this.setTop(-1000);this.Super("show",arguments)},updatePosition:function(){var _1=this.modeSwitcher,_2=this.builder.rootLiveObject,_3=_1.previewDevice,_4=_1.previewOrientation;_3=_3||"desktop";_4=_4||"portrait";var _5=_1.$2193[_3],_6=(_5.outline?_5.outline[_4]:null),_7=(_6?_6.adjustments:[0,0,0,0]);var _8=_2.getTop()+_2.getVisibleHeight()+_7[1]+_7[3],_9=_2.getLeft()+_2.getVisibleWidth()+_7[0]+_7[2],_10=_9+25,_11=_8-this.getHeight();this.setRect(_10,_11)}},showAsDevice(device,orientation){var modeSwitcher=this,builder=this.creator,rootLiveObject=builder.rootLiveObject,previewArea=builder.previewArea,deviceSelector=this.getDeviceSelector();device=device||"desktop";orientation=orientation||"portrait";if(!this.$2195){this.$2195={isDesktop:isc.Browser.isDesktop,isTablet:isc.Browser.isTablet,isHandset:isc.Browser.isHandset,orientation:isc.Page.getOrientation()}}
var settings=this.$2193[device],sizes=settings.sizes[orientation],memberNumber=settings.memberNumber,border=settings.border;rootLiveObject.setRect(null,null,sizes.width,sizes.height);rootLiveObject.setBorder(border);if(!deviceSelector.getMember(memberNumber).isSelected()){deviceSelector.getMember(memberNumber).select()}
if(settings.canReorient){if(!previewArea.deviceOutline){var deviceOutline=this.createAutoChild("deviceOutline",{modeSwitcher:modeSwitcher,builder:builder});deviceOutline.moveBelow(rootLiveObject);previewArea.addChild(deviceOutline);previewArea.deviceOutline=deviceOutline}
previewArea.deviceOutline.show();if(!previewArea.orientationButton){var button=this.createAutoChild("orientationButton",{modeSwitcher:modeSwitcher,builder:builder});previewArea.addChild(button);previewArea.orientationButton=button}
previewArea.orientationButton.show()}else{if(previewArea.deviceOutline){previewArea.deviceOutline.hide()}
if(previewArea.orientationButton){previewArea.orientationButton.hide()}}},setEditMode:function(_1){var _2=this.creator,_3=_2.projectComponents.data.getAllNodes();for(var i=0;i<_3.length;i++){var _5=_3[i],_6=_5.liveObject;if(_6.setEditMode){_6.setEditMode(_1,_2.projectComponents,_5)}else{_6.editingOn=_1}}},resetScreenMockDataSources:function(){var _1=this.creator,_2=_1.projectComponents.data.getAllNodes();for(var i=0;i<_2.length;i++){var _4=_2[i],_5=_4.liveObject;if(isc.isA.MockDataSource(_5)&&_5.resetData){_5.resetData()}}},autoSwitchToPreviewMode:function(){var _1=!this.isSelected();if(!_1)return;this.select();this.updateSelectedMode()},autoSwitchToEditMode:function(){var _1=!this.isSelected();if(_1)return;this.deselect();this.updateSelectedMode();var _2=this;isc.Timer.setTimeout(function(){_2.showAutoSwitchedLabel()},100)},showAutoSwitchedLabel:function(){if(!this.$179u){this.$179u=isc.Label.create({height:25,autoFit:true,wrap:false,backgroundColor:"#ffff66",align:"center",autoDraw:false,contents:"<<< Auto-switched to Edit mode",top:this.getPageTop(),left:this.getPageLeft()+25})}
this.$179u.show();this.$179u.setOpacity(100);isc.Timer.setTimeout(this.ID+".fadeOutAutoSwitchedLabel()",5000)},fadeOutAutoSwitchedLabel:function(){var _1=this;this.$179u.animateFade(0,function(){_1.$179u.hide()},1000)}};isc.A.rightStackDefaults={_constructor:"TSectionStack",autoDraw:false,width:225,visibilityMode:"multiple"};isc.A.canvasItemWrapperConstructor="CanvasItem";isc.A.canvasItemWrapperDefaults={showTitle:false,colSpan:"*",width:"*"};isc.A.Constructor="FormItem";isc.A.simpleTypeNodeDefaults={isGroup:true,cellPadding:5,showComplexFields:false,doNotUseDefaultBinding:true};isc.A.complexTypeNodeConstructor="DynamicForm";isc.A.complexTypeNodeDefaults={isGroup:true,cellPadding:5,showComplexFields:false,doNotUseDefaultBinding:true};isc.A.repeatingComplexTypeNodeDefaults={autoFitData:"vertical",leaveScrollbarGap:false};isc.A.logoConstructor="Img";isc.A.logoDefaults={autoParent:"pageHeader",autoDraw:false,width:24,height:24,src:"ReifyLogo.png",layoutAlign:"center"};isc.A.projectNamePaneConstructor="EditPane";isc.A.projectNamePaneDefaults={autoParent:"pageHeader",autoDraw:false,height:26,width:100,border:"0px",canHover:true,hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",prompt:"Double-click to rename project",canAcceptDrop:false,selectedAppearance:"none",showSelectedLabel:false,editContextProperties:{canGroupSelect:false,selectionType:"single",enableInlineEdit:true,editNodeUpdated:function(_1,_2,_3){if(_3.contains("contents")){var _4=_2.creator,_5=_4.creator,_6=_5.project,_7=_6.fileName,_8=_1.defaults.contents;if(_7!=_8){if(_8==null||_8==""){_2.setNodeProperties(_1,{contents:_7})}else{_6.renameFile(_7,_8,"proj","xml",_5.projectDataSource,function(_9,_10){if(!_9){if(_10!="oldFileName"){isc.warn("Cannot rename project: "+_8+" already exists.");return}}
_6.setFileName(_8);_6.setName(_8);_6.save(function(){_5.removeRecentProject(_7)})})}}}}},editProxyProperties:{autoMaskChildren:true},setReadOnly:function(_1){var _2=this.getEditNodeTree(),_3=_2.getRoot(),_4=_2.getChildren(_3)[0],_5=_4.liveObject;this.setEditMode(!_1);var _6=this.creator,_7=_6.project;_5.showRollOver=!_1;_5.setIcon(_1?"lock.png":null);_5.prompt=(_1?"This project is read-only. If you would like to edit, please make a copy.":null)}};isc.A.projectNameConstructor="Label";isc.A.projectNameDefaults={autoParent:"pageHeader",autoDraw:false,height:26,minWidth:250,autoFit:true,wrap:false,styleName:null,baseStyle:"pageTitle",hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",showRollOver:true,iconOrientation:"right",setContents:function(_1){this.Super("setContents",arguments);this.parentElement.setWidth(this.getVisibleWidth())},editProxyProperties:{inlineEditEvent:"click",inlineEditFormProperties:{minHeight:26},editMaskProperties:{canDrag:false,canDragReposition:false,showContextMenu:function(){return false},handleMouseOver:function(){var _1=this.masterElement;return _1.handleMouseOver()},handleMouseOut:function(){var _1=this.masterElement;return _1.handleMouseOut()}}}};isc.A.projectNameSpacerConstructor="LayoutSpacer";isc.A.projectNameSpacerDefaults={autoParent:"pageHeader",autoDraw:false,width:25};isc.A.mockupsMenuButtonConstructor="TMenuButton";isc.A.mockupsMenuButtonDefaults={autoDraw:false,title:"Mockups",width:75};isc.A.mockupsMenuControlConstructor="RibbonBar";isc.A.mockupsMenuControlDefaults={autoDraw:false,height:22,width:1,layoutMargin:0,overflow:"visible",layoutAlign:"center"};isc.A.projectMenuButtonConstructor="TMenuButton";isc.A.projectMenuButtonDefaults={autoDraw:false,title:"Project",width:75,border:"0px"};isc.A.projectMenuControlConstructor="RibbonBar";isc.A.projectMenuControlDefaults={autoDraw:false,height:22,width:1,layoutMargin:0,overflow:"visible",layoutAlign:"center"};isc.A.runButtonConstructor="TButton";isc.A.runButtonDefaults={autoDraw:false,minWidth:75,autoFit:true,wrap:false,border:"0px"};isc.A.deployButtonConstructor="TButton";isc.A.deployButtonDefaults={title:"Deploy",minWidth:75,autoDraw:false,autoFit:true,border:"0px",wrap:false};isc.A.deployMenuButtonConstructor="TMenuButton";isc.A.deployMenuButtonDefaults={title:"Deploy",iconSpacing:0,border:"0px",width:75,autoDraw:false};isc.A.runMenuButtonConstructor="TMenuButton";isc.A.runMenuButtonDefaults={autoDraw:false,iconSpacing:0,title:"",border:"0px",width:1,overflow:"visible"};isc.A.runMenuControlConstructor="RibbonBar";isc.A.runMenuControlDefaults={autoDraw:false,height:22,width:1,layoutMargin:0,overflow:"visible",layoutAlign:"center"};isc.A.deployMenuControlConstructor="RibbonBar";isc.A.deployMenuControlDefaults={autoDraw:false,height:22,width:1,layoutMargin:0,overflow:"visible",layoutAlign:"center"};isc.A.userNameSpacerConstructor="LayoutSpacer";isc.A.userNameSpacerDefaults={autoParent:"pageHeader",autoDraw:false,width:"*"};isc.A.userMenuButtonConstructor="MenuButton";isc.A.userMenuButtonDefaults={autoParent:"pageHeader",autoDraw:false,title:isc.Canvas.imgHTML("profile.png",24,24),hoverStyle:"darkHover",prompt:"Your account",showMenuButtonImage:false,baseStyle:"normal",width:30,height:30,menu:null};isc.A.userMenuConstructor="Menu";isc.A.userMenuDefaults={autoDraw:false,width:250,showKeys:false,showSubmenus:false,iconFieldProperties:{baseStyle:"menuTitleField"},data:[{isSeparator:true},{title:"Log out",click:function(_1,_2,_3){_3.creator.signOut()}}],regDevItems:[{title:"Update Account",click:function(_1,_2,_3){_3.creator.showUpdateAccountWindow()}}],init:function(){var _1=this.creator;if(_1.shouldShowRegDevUserMenuItems())this.data.addListAt(this.regDevItems,1);else this.logWarn("Create a developer account to show all user menu options");this.data.addAt({showRollOver:false,embeddedComponent:isc.VLayout.create({autoDraw:false,height:1,width:"100%",padding:10,members:[isc.HLayout.create({autoDraw:false,width:"100%",height:1,members:[isc.Img.create({autoDraw:false,width:50,height:50,imageType:"center",src:"profile.png",imageWidth:40,imageHeight:40}),isc.Label.create({autoDraw:false,height:50,padding:10,autoFit:true,contents:"<b>Account</b>"})]}),isc.Label.create({autoDraw:false,height:30,contents:window.user&&window.user.username?window.user.username:""})]}),embeddedComponentFields:["title","key","submenu"]},0);this.Super("init",arguments)}};isc.A.pageHeaderConstructor="HLayout";isc.A.pageHeaderDefaults={autoDraw:false,width:"100%",height:24,membersMargin:10,layoutMargin:3,layoutLeftMargin:5,layoutRightMargin:5};isc.A.savingScreenLabelConstructor="Label";isc.A.savingScreenLabelDefaults={autoDraw:false,width:100,height:20,styleName:"labelAnchor",canHover:true,hoverStyle:"darkHover",wrap:false,hoverWrap:false,hoverAutoFitWidth:false,getHoverHTML:function(){if(!this.creator.currentScreen||!this.creator.currentScreen.lastSave){return null}
if(this.creator.currentScreen.oldVersionLoaded){return"Old version loaded. Auto save disabled."}
var _1=this.creator.currentScreen.lastSave;if(isc.isA.String(_1))_1=this.creator.currentScreen.lastSave=new Date(_1);return"Last edit was saved "+isc.VisualBuilder.timeSince(_1)}};isc.A.usersRolesLabelConstructor="Label";isc.A.usersRolesLabelDefaults={cursor:"hand",wrap:false,overflow:"hidden",width:80,click:function(){var _1=this.creator.usersRolesMenuButton;_1.showMenu();if(_1.showOpened)_1.setCustomState("Opened")},dynamicContents:true,contents:"${this.creator.getUsersRolesMenuButtonTitle()}",hoverStyle:"darkHover",canHover:true,getHoverHTML:function(){if(isc.Auth.isSuperUser())return this.creator.superUserHelpText}};isc.A.usersRolesMenuButtonConstructor="ToolStripMenuButton";isc.A.usersRolesMenuButtonDefaults={menuAlign:"right",showMenuButtonImage:false,title:null,icon:"switch_user.png",showRollOver:true,showRollOverIcon:true,autoApplyDownState:false,hoverStyle:"darkHover",prompt:"Change user view, or edit roles and users.",getStateName:function(){return this.baseStyle},iconSize:20,iconWidth:20,iconHeight:20,width:30,autoFit:false,menu:null};isc.A.usersRolesMenuConstructor="Menu";isc.A.usersRolesMenuDefaults={initWidget:function(){var _1=this.creator;var _2=[{title:"Current User",icon:"currentUser.png"},{title:"Edit Test Users...",icon:"actions/editSampleUsers.png",click:function(){_1.editSampleUsers()}},{title:"Edit Roles...",icon:"actions/editSampleRoles.png",click:function(){_1.editSampleRoles()}}];this.items=_2;return this.Super("initWidget",arguments)}};isc.A.sampleUsersMenuConstructor="Menu";isc.A.sampleUsersMenuDefaults={width:250,getItemTitle:function(_1){var _2=_1.title;var _3=_1.roles;if(_3!=null&&!isc.isAn.emptyString(_3)){_2+=" <i>("+_3+")</i>"}
return _2},fields:["icon","title"]};isc.A.paletteNodeDSDefaults={_constructor:"DataSource",ID:"paletteNode",recordXPath:"/PaletteNodes/PaletteNode",fields:{name:{name:"name",type:"text",length:8,required:true},title:{name:"title",type:"text",title:"Title",length:128,required:true},type:{name:"type",type:"text",title:"Type",length:128,required:true},icon:{name:"icon",type:"image",title:"Icon Filename",length:128},iconWidth:{name:"iconWidth",type:"number",title:"Icon Width"},iconHeight:{name:"iconHeight",type:"number",title:"Icon Height"},iconSize:{name:"iconSize",type:"number",title:"Icon Size"},showDropIcon:{name:"showDropIcon",type:"boolean",title:"Show Drop Icon"},defaults:{name:"defaults",type:"Canvas",propertiesOnly:true},children:{name:"children",type:"paletteNode",multiple:true}}};isc.A.paletteDSDefaults={_constructor:"DataSource",ID:"paletteDS",clientOnly:true,dataProtocol:"clientCustom",fields:[{name:"id",type:"integer",primaryKey:true},{name:"parentId",type:"integer"},{name:"title",title:"Component",type:"text"},{name:"description",type:"text"},{name:"isFolder",type:"boolean"},{name:"type",type:"text"},{name:"excludeFromSearch",type:"text"},{name:"children"}],performDSOperation:function(_1,_2,_3,_4){if(this.$1597==this.mockupMode&&this.getCacheData()!=null){return this.Super("performDSOperation",arguments)}
this.$1597=this.mockupMode;this.setCacheData(null);this.$149p=null;this.$149q=2;isc.RPCManager.startQueue();this.paletteNodeDS.dataURL=this.customComponentsURL;this.paletteNodeDS.fetchData({},this.getID()+".fetchComponentsReply(dsResponse.clientContext,data)",{clientContext:{operationType:_1,data:_2,callback:_3,requestProperties:_4}});this.paletteNodeDS.dataURL=this.mockupMode?this.defaultMockupComponentsURL:this.defaultComponentsURL;this.paletteNodeDS.fetchData({},this.getID()+".fetchComponentsReply(dsResponse.clientContext,data)",{clientContext:{operationType:_1,data:_2,callback:_3,requestProperties:_4}});isc.RPCManager.sendQueue()},fetchComponentsReply:function(_1,_2){if(!this.$149p)this.$149p=_2;else this.$149p.addList(_2);if(--this.$149q==0){_2=this.flattenTree(this.$149p);this.setCacheData(_2);this.$149p=null;this.Super("performDSOperation",[_1.operationType,_1.data,_1.callback,_1.requestProperties])}},assignIds:function(_1,_2){if(_2==null)this.$149r=0;for(var i=0;i<_1.length;i++){var _4=_1[i];_4.id=this.$149r++;if(_2!=null)_4.parentId=_2;if(_4.children)this.assignIds(_4.children,_4.id);else _4.isFolder=false}},flattenTree:function(_1,_2,_3){if(_2==null)this.$149r=0;if(!_3)_3=[];for(var i=0;i<_1.length;i++){var _5=_1[i];_5.id=this.$149r++;if(_2!=null)_5.parentId=_2;if(_5.children){this.flattenTree(_5.children,_5.id,_3);delete _5.children}else{_5.isFolder=false}
_3.add(_5)}
return _3},transformRequest:function(_1){if(_1.operationType==="fetch"){var _2=this.getCacheData(),_3=[];if(_1.data&&!isc.isAn.emptyObject(_1.data)){var _4=_1.data;for(var i=0;i<_2.length;i++){var _6=_2[i];if(this.recordMatchesFilter(_6,_4,_1)){_3.add(_6)}}
this.addChildren(_2,_3);this.addParents(_2,_3)}else{_3=_2}
var _7=_1.resultTree;if(_7){_3=isc.Tree.getCleanNodeData(_3,false,false,true,_7)}
var _8={data:_3};this.processResponse(_1.requestId,_8)}},addChildren:function(_1,_2){var _3;do{_3=false;for(var i=0;i<_2.length;i++){var _5=_2[i],_6=_1.find("parentId",_5.id);if(_6){if(!_2.contains(_6)){_2.add(_6);_3=true}}}}while(_3)},addParents:function(_1,_2){var _3;do{_3=false;for(var i=0;i<_2.length;i++){var _5=_2[i],_6=_1.find("id",_5.parentId);if(_6){if(!_2.contains(_6)){_2.add(_6);_3=true}}}}while(_3)}};isc.A.libraryComponentsDefaults={_constructor:"TTreePalette",autoShowParents:true,autoDraw:false,dataSource:"paletteDS",loadDataOnDemand:false,cellHeight:22,fixedRowHeights:false,virtualScrolling:true,showRoot:false,showHeader:false,showConnectors:true,selectionType:Selection.SINGLE,iconSize:16,emptyMessage:"No items match your search criteria",styleName:"libraryComponentsGrid",$59a:function(_1,_2){if(_2<=2)return[];var _3=this.data.$59a(_1);_3.pop();return _3},getIndentHTML:function(_1,_2,_3,_4){_1=(_1>1?_1-1:_1);var _5=this.Super("getIndentHTML",[_1,_2,_3,_4]);return _5},getRowHeight:function(_1,_2){if(_1&&(_1.isHeader==true||_1.isHeader=="true"))return 35;return this.Super("getRowHeight",arguments)},getOpenIcon:function(_1){if(this.showOpener==false&&!this.showConnectors)return null;if(!this.data)return null;var _2,_3,_4;if(isc.isA.Number(_1)){_2=_1;_1=this.data.get(_2);_4=this.data.isMultiLinkTree()?this.data.getNodeLocator(_2):null}
if(_1==null)return null;if(_1.isHeader==true||_1.isHeader=="true"){var _5=this.data.isOpen(_1);return(_5?"[SKINIMG]SectionHeader/opener_opened.png":"[SKINIMG]SectionHeader/opener_closed.png")}
var _6=this.data.getParent(_1);if(_6.isHeader==true||_6.isHeader=="true")return null;return this.Super("getOpenIcon",arguments)},getOpenerIconWidth:function(_1){if(_1.isHeader==true||_1.isHeader=="true")return 16;return this.Super("getOpenerIconWidth",arguments)},getTreeCellValue:function(_1,_2,_3,_4,_5){var _6=this.cellHeight;if(_2.isHeader==true||_2.isHeader=="true")this.cellHeight=16;var _7=this.Super("getTreeCellValue",arguments);this.cellHeight=_6;return _7},getIcon:function(_1,_2){if(_1.isHeader==true||_1.isHeader=="true")return null;return this.Super("getIcon",arguments)},getCellStyle:function(_1,_2,_3){if(_1&&(_1.isHeader==true||_1.isHeader=="true")){return"paletteTreeCell"}
return this.Super("getCellStyle",arguments)},$2191:"17px solid",getCellCSSText:function(_1,_2,_3){if(_1&&(_1.isHeader==true||_1.isHeader=="true")){var _4=this.data,_5=_4.isOpen(_1),_6=(_2>0?this.getRecord(_2-1):null),_7=(_6&&(_6.isHeader==true||_6.isHeader=="true")),_8=(isc.currentSkin&&isc.currentSkin.backgroundColor)||"white",_9=this.$2191+" "+_8,_10="";if(_6&&!_7){_10="border-top: "+_9}
if(_5){var _11=this.getRecord(_2+1),_12=(_11&&(_11.isHeader==true||_11.isHeader=="true"));if(_11&&!_12){_10+=(_10!=""?";":"")+"border-bottom: "+_9}}
return _10}
if(_2==(this.getTotalRows()-1)){return"padding-bottom: 15px"}
return this.Super("getCellCSSText",arguments)},canDragRecordsOut:true,canAcceptDroppedRecords:false,dragDataAction:isc.TreeViewer.COPY,dragStart:function(){var _1=this.Super("dragStart",arguments);if(_1==false)return _1;var _2=this.getDragData();for(var i=0;i<_2.length;i++){if(_2[i].isHeader==true||_2[i].isHeader=="true")return false}
this.topElement.autoSwitchToEditMode();this.creator.projectComponents.editContext.hideSelection();return _1},canHover:true,hoverAutoFitMaxWidth:360,hoverStyle:"darkHover",cellHoverHTML:function(_1,_2,_3){if(_1&&_1.prompt)return _1.prompt},getNextAutoId:function(_1,_2,_3,_4){var _5=(_1=="HeaderItem"?2:null);if(!_3&&_2&&_2.defaults&&_2.defaults.title){_3=_2.defaults.title}
_3=(_3?this.getPrefixAsId(_3,_5):"");if(_1==null){_1="Object"}else{if(_1.contains("."))_1=_1.split(/\./).pop()}
var _6=(_2?_2.idName||_2.idPrefix||_2.type:_1),_7=_3+_6;var _8=_4||this.creator.projectComponents.data,_9=_8.getParent(_2);var _10=isc.DS.getAutoIdField(_2);if(_9&&_10=="name"){return this.$204c(_7,_2.liveObject,_9,_8)}else{if(!_9&&_7==_1)return this.Super("getNextAutoId",arguments);return this.$204d(_7,_2.liveObject)}},getPrefixAsId:function(_1,_2){var _3=_1.split(/ /);if(_2!=null&&_3.length>_2)_3.length=_2;var _1="";for(var i=0;i<_3.length;i++){_1+=(i==0?_3[i].substring(0,1).toLowerCase():_3[i].substring(0,1).toUpperCase())+_3[i].substring(1)}
if(!String.isValidID(_1)){_1=_1.replace(/'/g,"").replace(/'/g,"").replace(/[^a-zA-Z0-9_]/g,"_").replace(/^([0-9])/,"$$$1")}
return _1},$204d:function(_1,_2){if(window[_1]==null||(_2&&window[_1]==_2))return _1;var _3=2,_4;while(!_4){var _5=_1+_3++;if(window[_5]==null||(_2&&window[_5]==_2))_4=_5}
return _4},$204c:function(_1,_2,_3,_4){var _5=_4.getChildren(_3),_6={};for(var i=0;i<_5.length;i++){if(_5[i].liveObject!=_2)_6[_5[i].ID]=true}
if(!_6[_1])return _1;var _8=2,_9;while(!_9){var _10=_1+_8++;if(!_6[_10])_9=_10}
return _9}};isc.A.screenListToolbarDefaults={_constructor:"TLayout",vertical:false,autoDraw:true,membersMargin:10,margin:2,height:20,autoParent:"screenPane"};isc.A.screenAddButtonDefaults={_constructor:"TMenuButton",autoDraw:false,title:"Add...",showMenuBelow:false,width:70,autoParent:"screenListToolbar"};isc.A.dataSourceListDefaults={_constructor:"TListPalette",showHeader:false,autoDraw:false,leaveScrollbarGap:false,selectionType:"single",canDragRecordsOut:true,sortField:"ID",emptyMessage:"<span style='color: #0066CC'>Use the 'Add...' button below to add DataSources.</span>",editSelectedDataSource:function(){var _1=this.getSelectedRecord();isc.ClassFactory.$180h(true);if(_1)isc.DS.get(_1.ID,this.creator.getID()+".showDSEditor(dsID)",{loadParents:true})},doubleClick:function(){this.editSelectedDataSource()},selectionChanged:function(){this.creator.dsEditButton.setDisabled(this.getSelectedRecord()==null)},fields:[{name:"ID",width:"*"},{name:"dsType",title:"Type",autoFitWidth:true,valueMap:{"sql":"SQL","hibernate":"Hibernate","jpa":"JPA 2.0","jpa1":"JPA 1.0","generic":"Generic","projectFile":"Project File"},width:65},{name:"download",showTitle:false,width:22,formatCellValue:function(_1,_2,_3,_4,_5){return _5.imgHTML({src:"actions/exportDataSource.png",width:16,height:16,extraCSSText:"cursor:"+isc.Canvas.POINTER_OR_HAND,imgDir:_5.widgetImgDir})},showHover:true,hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",hoverHTML:function(_1,_2,_3,_4,_5){return"Export DataSource as ..."}}],cellClick:function(_1,_2,_3){var _4=this.getField(_3);if(_4.name=="download"){isc.ClassFactory.$180h(true);isc.DS.get(_1.ID,this.creator.getID()+".downloadDataSource(dsID)",{loadParents:true})}else return this.Super("cellClick",arguments)},transferDragData:function(_1,_2){var _3=this.getDragData();var _4=_3[0];if(_4.dsType=="MockDataSource"&&_4.referenceInProject==false){var _5=this.creator.projectComponents.getEditContext(),_6=_5.getEditNodeArray().find("ID",_4.ID);;if(!_6){isc.warn("An embedded MockDataSource can only be used with the screen that defines it");return null}}
return this.Super("transferDragData",arguments)},dsContextMenuDefaults:{_constructor:"Menu",autoDraw:false,showIcon:false,showMenuFor:function(_1,_2){this.$109l=_1;this.$109m=_2;this.showContextMenu()}},menuData:[{title:"Edit...",click:function(_1,_2,_3){isc.ClassFactory.$180h(true);isc.DS.get(_3.$109l.ID,_3.creator.creator.getID()+".showDSEditor(dsID)",{loadParents:true})}},{title:"Create relation...",click:function(_1,_2,_3){_3.creator.creator.showRelationEditor(_3.$109l.ID)}},{title:"Remove from project",enableIf:function(_1,_2,_3){return(!_2.creator.creator.project.isReadOnly()&&_2.$109l.referenceInProject!=false)},click:function(_1,_2,_3){_3.creator.creator.project.removeDatasource(_3.$109l.ID)}},{title:"Save separately from screen..",enableIf:function(_1,_2,_3){return(_2.$109l.referenceInProject==false)},click:function(_1,_2,_3){isc.ClassFactory.$180h(true);isc.DS.get(_3.$109l.ID,function(_4){_3.creator.creator.saveDSToFile(_4,_3.$109l)},{loadParents:true})}}],rowContextClick:function(_1,_2,_3){this.dsContextMenu.showMenuFor(_1,_2);return false},initWidget:function(){this.Super("initWidget",arguments);var _1=this.menuData.duplicate();if(!this.creator.enableRelationEditor){_1.remove(_1.find("title","Create relation..."))}
this.dsContextMenu=this.createAutoChild("dsContextMenu",{data:_1})},autoParent:"dataSourcePane",dragStart:function(){this.topElement.autoSwitchToEditMode()}};isc.A.dataSourceListToolbarDefaults={_constructor:"TLayout",vertical:false,autoDraw:true,align:"right",membersMargin:10,margin:2,height:20,autoParent:"dataSourcePane"};isc.A.dsNewButtonDefaults={_constructor:"TMenuButton",autoDraw:false,title:"Add...",showMenuBelow:false,showDisabledIcon:false,width:70,autoParent:"dataSourceListToolbar"};isc.A.dsNewButtonMenuDefaults={_constructor:"Menu",submenuDelay:0,wizardData:[{title:"New DataSource",icon:"[SKINIMG]actions/plus.png",click:function(_1,_2,_3){_3.creator.showDSWizard()}},{title:"Copy an existing DataSource",icon:"page_copy.png",click:function(_1,_2,_3){_3.creator.showCopyExistingDataSourceUI()}},{title:"Use a shared DataSource",icon:"[SKINIMG]actions/search.png",click:function(_1,_2,_3){_3.creator.showLoadSharedDataSourceUI()}}],nonWizardData:[{title:"New DataSource",icon:"[SKINIMG]actions/plus.png",click:function(_1,_2,_3){_3.showNewDataSourceDialog()}},{title:"Copy an existing DataSource",icon:"page_copy.png",click:function(_1,_2,_3){_3.creator.showCopyExistingDataSourceUI()}},{title:"Use a shared DataSource",icon:"[SKINIMG]actions/search.png",click:function(_1,_2,_3){_3.creator.showLoadSharedDataSourceUI()}}],init:function(){this.data=(this.creator.useMenuForDSWizardPicker?this.nonWizardData:this.wizardData);this.Super("init",arguments)},getSubmenu:function(_1){_1=this.getItem(_1);if(this.creator.useMenuForDSWizardPicker&&_1.title=="New DataSource"){this.createNewDSSubMenu();return this.dsTypeSubmenu}},createNewDSSubMenu:function(){if(this.dsTypeSubmenu)return;var _1=this.creator.$200c,_2=[];for(var i=0;i<_1.length;i++){var _4=_1[i];if(_4.canSelect=="false")continue;var _5={title:_4.title,icon:_4.icon,wizardRecord:_4};_2.add(_5)}
var _6=this;this.dsTypeSubmenu=isc.Menu.create({autoDraw:false,showShadow:true,shadowDepth:10,data:_2,itemClick:function(_7){_6.creator.showDSWizard(_7.wizardRecord)}})},showNewDataSourceDialog:function(){var _1=this.creator.$200c,_2=[];for(var i=0;i<_1.length;i++){var _4=_1[i];if(_4.canSelect=="false")continue;var _5={title:_4.title,icon:_4.icon,wizardRecord:_4};_2.add(_5)}
this.creator.showNewDataSourceDialog(_2)}};isc.A.dsEditButtonDefaults={_constructor:"TButton",autoDraw:false,disabled:true,title:"Edit...",width:70,click:"this.creator.dataSourceList.editSelectedDataSource()",autoParent:"dataSourceListToolbar"};isc.A.projectComponentsMenuDefaults={_constructor:"Menu",autoDraw:false,showIcon:false,enableIf:function(_1,_2){var _3=_1?_1.getSelection():null,_4=_3?_3[0]:null,_5=true;if(!_1.creator.canAddRootComponents){var _6=_1.data,_7=(_3==null?0:_3.length);for(var i=0;i<_7;++i){if(_6.isRoot(_6.getParent(_3[i]))&&_3[i].alwaysAllowRootDrop!=true&&_3[i].alwaysAllowRootDrop!="true")
{_5=false}}}
return{selection:_3,node:_4,removeOK:_5}},data:[{title:"Remove",enableIf:"node != null && removeOK",click:function(_1){var _2=_1.getSelection(),_3=(_2==null?0:_2.length);for(var i=0;i<_3;++i){var _5=_2[i];_1.destroyNode(_5)}
_1.data.removeList(_2)}}]};isc.A.projectComponentsDefaults={_constructor:"TEditTree",showHeaderMenuButton:false,styleName:"pageBackground",editContextDefaults:{persistCoordinates:null,selectedAppearance:"outlineEdges",canGroupSelect:false,enableInlineEdit:true,isVisualBuilder:true,addNode:function(_1,_2,_3,_4,_5,_6,_7){var _8=this.creator;var _9=isc.DataSource.getNearestSchemaClass(_1.type);if(_9&&(_9.isA(isc.DataSource)||_1.deferCreation)){if(_1.loadData!=null&&!_1.isLoaded){var _10=this;_1.loadData(_1,function(){_10.addNode(_1,_2,_3,_4,_5,_6,_7)});return}
if(!this.dontShowFieldMapper){var _10=this;var _11=_8.showFieldMapper(_2.liveObject,_1,_2,function(){_10.dontShowFieldMapper=true;_10.addNode(_1,_2,_3,_4,_5,_6,_7);delete _10.dontShowFieldMapper});if(_11){return}}
if(!this.dontShowTreeRelationConfirm){var _12=_2.liveObject;if(isc.isA.TreeGrid(_12)||isc.isA.PickTreeItem(_12)){var _13=_1.liveObject;if(!isc.isA.MockDataSource(_13)||_13.mockDataType!="tree"){var _14=_13.getTreeRelationship(_13);if(!_14||!_14.parentIdField||(_14.idField&&_14.childDS==_14.parentDS&&_14.parentIdField==_14.idField))
{var _10=this,_15=_8.creator,_16=arguments;isc.ask("This DataSource does not contain a tree relationship. Create one now?",function(_20){if(_20){_15.showSimpleTreeRelationEditor(_13,function(){var _1=_16[0];_1.liveObject=isc.DS.get(_13.ID);_10.dontShowTreeRelationConfirm=true;_10.addNode.apply(_10,_16);delete _10.dontShowTreeRelationConfirm})}else{_10.dontShowTreeRelationConfirm=true;_10.addNode.apply(_10,_16);delete _10.dontShowTreeRelationConfirm}},{buttons:[isc.Dialog.NO,isc.Dialog.YES],autoFocusButton:1});return}}}}}
_1=this.Super("addNode",arguments);if(!_1)return;if(!this.creator.canDropRootNodes&&this.getRootEditNode()==_2&&!(_1.alwaysAllowRootDrop==true||_1.alwaysAllowRootDrop=="true"))
{if(!isc.isA.ValuesManager(_1.liveObject)){_1._canRemove=false}}
if(!_1.dropped||(_1.loadData!=null&&!_1.isLoaded)){_8.observeNodeDragResized(_1,_2);_8.creator.componentAdded();return _1}
var _9=isc.ClassFactory.getClass(_1.type);if(_9!=null&&_9.isA(isc.DataSource)){var _13=_1.liveObject,_17=_13.serverType||_13.dsType||_13.dataSourceType,_18=_2,_12=_2.liveObject;if((isc.isA.ListGrid(_12)||isc.isA.TileGrid(_12))&&(_17=="sql"||_17=="hibernate"||_13.dataURL!=null||_13.clientOnly||_13.serviceNamespace!=null)&&!_13.noAutoFetch&&_12.autoFetchData!=false)
{_8.setNodeProperties(_18,{autoFetchData:true});if(isc.SForce&&isc.isA.SFDataSource(_13)&&!isc.SForce.sessionId){isc.SForce.ensureLoggedIn(function(){_12.fetchData()},true)}else{_12.fetchData()}}
this.deselectAllComponents();this.selectSingleComponent(_12)}
var _19=this.getLiveObject(_1);if(!_19.getEditableProperties){_8.creator.componentAdded();return _1}
_8.observeNodeDragResized(_1,_2);if(_19.setEditableProperties){_19.setEditableProperties({});if(_19.markForRedraw)_19.markForRedraw();else if(_19.redraw)_19.redraw()}
_8.delayCall("hiliteSelected");_8.creator.componentAdded();return _1},removeNode:function(_1,_2,_3){var _4=this.creator,_5=_4.data.getParent(_1);if(!_5)return;var _6=_1.liveObject;if(_6&&_4.creator.isObserving(_6,"dragResized")){_4.creator.ignore(_6,"dragResized")}
this.Super("removeNode",[_1,_2,_3],arguments);if(!_3){_4.creator.componentRemoved(_1,_5)}},removeAll:function(){var _1=this.creator;_1.creator.clearComponent();return this.Super("removeAll",arguments)},destroyAll:function(){var _1=this.creator;_1.creator.clearComponent();var _2=_1.defaultPalette;_2.typeCount={};return this.Super("destroyAll",arguments)},destroyNode:function(_1){var _2=this.creator,_3=_2.defaultPalette,_4=!isc.isAn.emptyObject(_3.typeCount),_5=_1.type||_1.className,_6=_1.idName;if(_4){if(!_6){var _7=_2.editContext.findPaletteNode("type",_5);if(_7)_6=_7.idName}
if(_6)_5=_6}
this.Super("destroyNode",arguments);if(!_4)return;var _8=_1.ID;if(_8&&_8.startsWith(_5)){var _9=parseInt(_8.substring(_5.length));if(_9!=null&&!isNaN(_9)){var _10=_3.typeCount[_5]||0;if(_9==(_10-1)){while(_9>=0&&!window[_5+_9]){_3.typeCount[_5]--;_9--}
if(_9<0){delete _3.typeCount[_5]}}}}},setNodeProperties:function(_1,_2,_3){var _4=this.creator,_5=_4.defaultPalette,_6=isc.DS.getAutoIdField(_1),_7=isc.DS.getToolAutoIdField(_1),_8=false,_9,_10,_11;if(_7&&_1.defaults&&_1.defaults[_7]&&!_2[_7]){var _12,_13=isc.addProperties({},_1.defaults,_2);if(_2[_6]!=_11){}else if(_2.title!=_11){if(_13.title&&_13.title!=_1.ID){var _14=isc.DS.getAutoId(_13),_15=_1.idName||_1.idPrefix||_1.type;_12=_5.getNextAutoId(_15,_1,_13.title);if(_12==_14)_12=null}}else if(_2.defaultValue!=_11){if(_1.liveObject&&isc.isA.HeaderItem(_1.liveObject)){var _14=isc.DS.getAutoId(_13),_15=_1.idName||_1.idPrefix||_1.type;if(_13.defaultValue!=_14){_12=_5.getNextAutoId(_15,_1,_13.defaultValue)}}}
if(_12&&_7){var _16={};_16[_7]=_12;_2=isc.addProperties(_16,_2);_8=true;_9=_13[_7]||_13[_6];_10=_12}}
this.addUsageRecord("componentEdit",_2);this.Super("setNodeProperties",[_1,_2,_3]);if(_7&&_1.defaults&&_1.defaults[_7]){if(_2[_6]!=_11){this.removeNodeProperties(_1,_7);_8=true;_9=_13[_7]||_13[_6];_10=_2[_6]}}
if(_8){var _17=_1.liveObject;_4.creator.delayCall("notifyIDOrFieldNameChange",[_17,_7,_9,_10])}},getSelectedLabelTools:function(_1){var _2=this.getSelectedEditNode(),_3=[];if(!_2)return;var _4=this.creator,_5=_4.creator;if((_2.liveObject&&isc.isA.Window(_2.liveObject)&&_2.liveObject.isModal)||_2.$216v)
{var _6=this.$216w;if(!_6){_6=this.$216w=isc.Img.create({src:"hiddenComponent.png",hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",width:16,height:16})}
_6.prompt=(_2.$216v?"Component would be hidden by visibility rule - edit Visible When property to change":"Component is marked as initially hidden");_3[0]=_6}
if(isc.isA.DataBoundComponent(_1)&&_1.dataSource){var _6=this.$200j;if(!_6){_6=this.$200j=isc.Img.create({src:"[SKIN]DatabaseBrowser/data.png",prompt:"Edit data binding",hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",width:16,height:16,cursor:"pointer",click:function(){var _7=isc.SelectionOutline.getSelectedObject(),_8,_2;if(_7&&_7.editContext){_2=_7.editNode;_8=_7.dataSource;if(isc.isA.String(_7.dataSource)){_8=isc.DS.get(_7.dataSource)}}
if(_8){if(isc.isA.MockDataSource(_8)){var _9=_5.$200c,_10=_5.mockDataSourceSampleWizardName;var _11=_9.find("name",_10);if(!_11){isc.warn("Sample Data wizard '"+_10+"' not found");return}
_11=isc.addProperties({},_11,{wizardDefaults:{targetDSType:"MockDataSource",existingDS:_8}});_5.showDSWizard(_11,_2)}else{_5.showDSEditor(_8.ID)}}}})}
if(_3[0]!=null)_3[0]=[_3[0],_6];else _3[0]=_6}
if((_1.getClassName&&(_1.getClassName()=="VLayout"||_1.getClassName()=="HLayout"))||(isc.isA.LayoutResizeBar(_1)&&isc.isA.Layout(_1.parentElement)&&!isc.isA.DataView(_1.parentElement)&&!isc.isA.Deck(_1.parentElement)))
{var _6=this.$2161;if(!_6){_6=this.$2161=isc.Img.create({src:"actions/rotate.png",hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",width:16,height:16,showRollOver:true,cursor:"pointer",click:function(){var _7=isc.SelectionOutline.getSelectedObject(),_2;if(_7&&_7.editContext){_2=_7.editNode;if(_2){_7.editContext.changeOrientationOfNode(_2)}}}})}
var _12=(isc.isA.LayoutResizeBar(_1)?!_1.vertical:_1.vertical);_6.prompt="Flip layout to "+(_12?"horizontal":"vertical");_3[1]=_6}
if(_2._canRemove!==false){var _6=this.$200k;if(!_6){_6=this.$200k=isc.Img.create({src:"[SKIN]/../../ToolSkin/images/actions/remove.png",prompt:"Remove component",hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",width:16,height:16,cursor:"pointer",click:function(){var _7=isc.SelectionOutline.getSelectedObject();if(_7&&_7.editContext){if(isc.isA.DataBoundComponent(_7)){var _13="Remove component?";isc.confirm(_13,function(_14){if(_14)_7.editContext.destroyNode(_7.editNode)},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1})}else{_7.editContext.destroyNode(_7.editNode)}}}})}
if(_3[1]!=null)_3[1]=[_3[1],_6];else _3[1]=_6}
return _3},changeOrientationOfNode:function(_1){var _2=this.creator.getEditNodeTree();var _3;if(_1.liveObject&&isc.isA.LayoutResizeBar(_1.liveObject)){_3=_1.ID;_1=_2.getParent(_1)}
var _4=isc.DS.getToolAutoIdField(_1),_5=!(_4&&_1.defaults&&_1.defaults[_4]);var _6=_2.getParent(_1),_7=_2.getChildren(_6).findIndex(_1);this.logInfo("using remove/re-add cycle to change orientation of: "+isc.echoLeaf(_1.liveObject)+" within parent node "+isc.echoLeaf(_6));var _8=_2.getChildren(_1);if(_8){_8=_8.duplicate();for(var i=0;i<_8.length;i++){var _10=this.getLiveObject(_8[i]);if(this.isComponentSelected(_10))this.deselectComponents(_10,true);this.removeNode(_8[i],true)}}
var _10=this.getLiveObject(_1),_11=isc.DS.getSchema(_1);if(this.isComponentSelected(_10))this.deselectComponents(_10,true);this.removeNode(_1);if(_10&&_10.destroy)_10.destroy();var _12=this.makePaletteNode(_1);if(!_12.defaults)_12.defaults={};if(_11.ID=="VLayout"){_12.type="HLayout";_12.defaults._constructor="HLayout";if(!_5)delete _12.defaults[_4]}else if(_11.ID=="HLayout"){_12.type="VLayout";_12.defaults._constructor="VLayout";if(!_5)delete _12.defaults[_4]}
_1=this.makeEditNode(_12);var _13=this.addNode(_1,_6,_7);if(_8){for(var i=0;i<_8.length;i++){var _14=_8[i];if(_14.type=="LayoutResizeBar"){var _12=this.makePaletteNode(_14);if(_14.liveObject.destroy)_14.liveObject.destroy();_14=this.makeEditNode(_12)}
this.addNode(_14,_13)}}
if(_6.type=="NavItem"){var _15=_2.getParent(_6);_15.liveObject.setItemPane(_6.liveObject,_13.liveObject)}
if(_3){_8=_2.getChildren(_1);_1=_8.find("ID",_3)}
this.selectSingleEditNode(_1);if(this.creator.nodeClick){this.creator.nodeClick(this.creator,_1,this.creator.getRecordIndex(_1))}
if(this.markForRedraw)this.markForRedraw();_2.dataChanged()},nodeAdded:function(_1,_2,_3){var _4=this.creator,_5=_4.creator;if(!_5.offerImmediateBinding||_5.mockupMode)return;if(isc.$75u)return;var _6=_1.liveObject;if(!_6)return;if(!isc.isA.DynamicForm(_6)&&!isc.isA.ListGrid(_6)&&!isc.isA.TileGrid(_6)&&!isc.isA.DetailViewer(_6))
{return}
if(isc.isA.Menu(_6))return;if(_6.dataSource)return;_5.offerBinding(_1)},editNodeUpdated:function(_1,_2,_3){var _4=this.creator,_5=_4.creator,_6=_4.defaultPalette,_7=isc.DS.getToolAutoIdField(_1);if(_7&&_1.defaults&&_1.defaults[_7]){var _8;if(_3.contains("dataSource")){var _9=isc.DS.get(_1.liveObject.dataSource),_10=(_9?_9.ID:null);if(_10){_8=_6.getNextAutoId(_1.idName||_1.idPrefix||_1.type,_1,_10)}}
if(_8&&_7){var _11={};_11[_7]=_8;_2.setNodeProperties(_1,_11)}}
var _12=_4.getRecordIndex(_1);_4.refreshRecordComponent(_12,0);if(!this.savingComponentProperties&&_5){var _13=_5.getCurrentComponent();if(_13&&_13.liveObject==_1.liveObject){_5.refreshComponent()}}},canAddToParent:function(_1,_2){if(!this.creator.canDropRootNodes&&this.getRootEditNode()==_1){return false}
return this.Super("canAddToParent",arguments)},nodeMoved:function(_1,_2,_3,_4,_5){this.addUsageRecord("componentMove",_3,_4)},getExtraComponentsToSerialize:function(){var _1=this.creator,_2=_1.creator,_3=[];var _4=_2.project.datasources,_5=this.getEditNodeArray(),_6=[];for(var i=0;i<_4.length;i++){var _8=_4[i].dsName,_9=_5.find("ID",_8);if(!_9)_6.add(_8)}
if(_6.length>0){var _10=_6.join(",");var _11={_constructor:"DataSource",$schemaId:"DataSource",loadID:_10,loadParents:true};_3.add(_11)}
return _3},addUsageRecord:function(_1,_2,_3){var _4=this.creator,_5=_4.creator;if(!_5.hostedMode)return;switch(_1){case"componentAdd":case"componentMove":var _6=_2.title||_2.type,_7=_3.title||_3.type;_5.$210g(_1,_6,_7);break;case"componentEdit":for(var _8 in _2){var _9=_2[_8];_5.$210g(_1,_8,_9);break}
break}}},shouldShowDragLineForRecord:function(){if(this.Super("shouldShowDragLineForRecord",arguments)){return!!this.willAcceptDrop()}
return false},autoDraw:false,canSort:false,leaveScrollbarGap:false,selectionUpdated:function(_1){if(this.$203o){isc.Timer.clear(this.$203o);delete this.$203o}
if(!this.editContext.$192h){if(_1){this.$203o=this.creator.delayCall("editComponent",[_1,_1.liveObject],50)}else{this.creator.clearComponent();this.editContext.hideSelection()}}},hiliteSelected:function(_1){var _2=this.getSelectedRecord();while(_2){var _3=_2?_2.liveObject:null;if(((isc.isA.Canvas(_3)||isc.isA.FormItem(_3))&&_3.isDrawn()&&_3.isVisible())||(_3.editProxy&&_3.editProxy.canSelect==true))
{var _4=isc.SelectionOutline.getSelectedObject();if(_4&&_3!=_4&&_4.editProxy){_4.editProxy.showSelectedAppearance(false)}
if(_3!=_4&&_3.editProxy){_3.editProxy.showSelectedAppearance(true)}
if(!_1&&!isc.isA.Canvas(_3)&&!isc.isA.FormItem(_3)&&_3.editProxy&&_3.editProxy.canSelect==true)
{this.delayCall("hiliteSelected",[true]);return}
break}
_2=this.data.getParent(_2)}},initWidget:function(){this.Super("initWidget",arguments);if(!isc.jsdoc.hasData()){this.delayCall("refreshWithJSDocs",null,250)}},refreshWithJSDocs:function(){if(!isc.jsdoc.hasData()){this.delayCall("refreshWithJSDocs",null,250)}else if(this.body){var _1=this.getVisibleRows();if(_1[0]>=0){for(var _2=_1[0];_2<_1[1];_2++){this.refreshRecordComponent(_2,0,true)}}
this.markForRedraw("jsdoc refresh")}},showRecordComponents:true,showRecordComponentsByCell:true,recordComponentPoolingMode:"recycle",createRecordComponent:function(_1,_2){var _3=this.getFieldName(_2);if(_3!="ID")return null;if(!isc.jsdoc.hasData())return null;var _4=this.hasEvents(_1),_5=this.hasWhenRules(_1),_6=this.hasValuesManager(_1),_7=this.hasDynamicProperties(_1);if(!_4&&!_5&&!_6&&!_7)return null;var _8=this,_9=this.getRecordIndex(_1),_10=this.body.getColumnAutoSize(_2,_9,_9+1)+10;var _11=isc.HLayout.create({height:_8.cellHeight,width:1,membersMargin:10,snapOffsetLeft:_10});var _12=isc.Img.create({layoutAlign:"center",src:"hasEvents.png",height:16,width:16,visibility:(_4?"inherit":"hidden"),canHover:true,hoverWidth:250,hoverAutoFitWidth:false,hoverWrap:false,hoverStyle:"darkHover",getHoverHTML:function(){return _8.getEventsHoverHTML(_1)}});_11.addMember(_12);var _13=isc.Img.create({layoutAlign:"center",src:"hasWhenRules.png",height:16,width:16,visibility:(_5?"inherit":"hidden"),canHover:true,hoverWidth:250,hoverAutoFitWidth:false,hoverWrap:false,hoverStyle:"darkHover",getHoverHTML:function(){return _8.getWhenRulesHoverHTML(_1)}});_11.addMember(_13);var _14=isc.ImgButton.create({canFocus:false,showDown:false,showRollOver:false,layoutAlign:"center",src:"database.png",height:16,width:16,imageType:"center",imageHeight:16,visibility:(_6?"inherit":"hidden"),canHover:true,hoverWidth:250,hoverAutoFitWidth:false,hoverWrap:false,hoverStyle:"darkHover",getHoverHTML:function(){return _8.getValuesManagerHoverHTML(_1)},click:function(){_8.selectNodeForValuesManager(_1)}});_11.addMember(_14);var _15=isc.Img.create({layoutAlign:"center",src:"[SKINIMG]DynamicForm/dynamic.png",height:16,width:16,visibility:(_7?"inherit":"hidden"),canHover:true,hoverWidth:250,hoverAutoFitWidth:false,hoverWrap:false,hoverStyle:"darkHover",getHoverHTML:function(){return _8.getDynamicPropertiesHoverHTML(_1)}});_11.addMember(_15);return _11},updateRecordComponent:function(_1,_2,_3,_4){var _5=this.getFieldName(_2);if(_5!="ID")return null;var _6=this.hasEvents(_1),_7=this.hasWhenRules(_1),_8=this.hasValuesManager(_1),_9=this.hasDynamicProperties(_1);if(_6)_3.getMember(0).show();else _3.getMember(0).hide();if(_7)_3.getMember(1).show();else _3.getMember(1).hide();if(_8)_3.getMember(2).show();else _3.getMember(2).hide();if(_9)_3.getMember(3).show();else _3.getMember(3).hide();var _10=this.getRecordIndex(_1),_11=this.body.getColumnAutoSize(_2,_10,_10+1)+10;_3.setSnapOffsetLeft(_11);return _3},selectNodeForValuesManager:function(_1){var _2=_1.liveObject;if(!_2||(!_2.getClassName&&!_2._constructor)){return false}
var _3=_2.valuesManager;if(!isc.isA.String(_3))_3=_3.ID;var _4=this.getEditContext(),_5=_4&&_4.getEditNodeArray().find("ID",_3);if(_5)_4.selectSingleEditNode(_5)},hoverStyle:"darkHover",removeFieldProperties:{hoverWrap:false,hoverAutoFitWidth:false},cellHoverHTML:function(_1,_2,_3){var _4=this.getField(_3),_5=this.getFieldName(_3);if(_4.isRemoveField){return"Remove component"}},hasEvents:function(_1){if(!isc.jsdoc.hasData())return false;var _2=_1.liveObject;if(!_2||(!_2.getClassName&&!_2._constructor)){return false}
var _3=_2.editNode;if(!_3)return false;var _4=_3.defaults,_5=(_2.getClassName?_2.getClassName():_2._constructor);for(var _6 in _4){var _7=_4[_6];if(_7==null||_7=="")continue;var _8=isc.VisualBuilder.getEventDefinition(_5,_6);if(_8){return true}}
return false},maxEventsToShow:3,getEventsHoverHTML:function(_1){if(!isc.jsdoc.hasData())return null;var _2=_1.liveObject,_3=_2.editNode,_4=_3.defaults,_5=(_2.getClassName?_2.getClassName():_2._constructor),_6="",_7=0;;for(var _8 in _4){var _9=isc.VisualBuilder.getEventDefinition(_5,_8);if(_9){if(++_7>this.maxEventsToShow){_6+="<P>More events defined, go to Events tab for info</P>";break}
var _10=_4[_8],_11=this.creator,_12=isc.ExpressionItem.getActionTitle(_10,_11,true);if(_12){_6+=_8+" : "+_12+"<br>"}}}
return _6},hasValuesManager:function(_1){var _2=_1.liveObject;if(!_2||(!_2.getClassName&&!_2._constructor)){return false}
return(_2.valuesManager!=null)},getValuesManagerHoverHTML:function(_1){var _2=_1.liveObject;var _3=_2.valuesManager;if(!isc.isA.String(_3))_3=_3.ID;return"This form is part of the ValuesManager '"+_3+"'"},hasWhenRules:function(_1){var _2=_1.liveObject;if(!_2){return false}
return((_2.visibleWhen!=null&&!isc.isA.emptyObject(_2.visibleWhen))||(_2.enableWhen!=null&&!isc.isA.emptyObject(_2.visibleWhen))||(_2.readOnlyWhen!=null&&!isc.isA.emptyObject(_2.visibleWhen)))},$219i:function(_1){var _2=_1.liveObject;if(!this.$171s){var _3=this.creator.getTargetRuleScope();if(_3){this.$171s=isc.Canvas.getAllRuleScopeDataSources(_3)}}
var _4=this.$171s,_5=_2;if(_5&&isc.isA.FormItem(_5)){_5=_5.form}
return function getCriteriaDescription(_7){var _6=isc.DS.getAdvancedCriteriaDescription(_7,_4,_5);return(!_6||_6==""?null:_6)}},getWhenRulesHoverHTML:function(_1){var _2=this.$219i(_1),_3=_1.liveObject,_4=[];if(_3.visibleWhen!=null&&!isc.isA.emptyObject(_3.visibleWhen)){_4.add("Visible when ["+_2(_3.visibleWhen)+"]")}
if(_3.enableWhen!=null&&!isc.isA.emptyObject(_3.enableWhen)){_4.add("Enable when ["+_2(_3.enableWhen)+"]")}
if(_3.readOnlyWhen!=null&&!isc.isA.emptyObject(_3.readOnlyWhen)){_4.add("Read-only when ["+_2(_3.readOnlyWhen)+"]")}
return(_4.length==0?null:_4.join("<br>"))},hasDynamicProperties:function(_1){var _2=_1.liveObject;if(!_2||isc.isA.DynamicProperty(_2)){return false}
return(_2.$1913&&!isc.isAn.emptyObject(_2.$1913))},getDynamicPropertiesHoverHTML:function(_1){var _2=_1.liveObject;if(!_2.$1913||isc.isAn.emptyObject(_2.$1913)){return null}
var _3=_2.$1913,_4=[];for(var _5 in _3){var _6=_3[_5],_7;if(isc.isA.String(_6)){_7="[DataPath: \""+_6+"\"]"}else if(_6.dataPath){_7="[DataPath: \""+_6.dataPath+"\"]"}else if(_6.trueWhen){var _8=this.$219i(_1);_7="[Criteria: \""+_8(_6.trueWhen)+"\"]"}else{var _9=(_6.textFormula?"Text ":"")+"Formula",_10=(_6.textFormula?_6.textFormula.text:_6.formula.text);;_7="["+_9+": \""+_10+"\"]"}
_4.add(_5+": "+_7)}
return(_4.length==0?null:_4.join("<br>"))},canRemoveRecords:true,removeIcon:"[SKIN]/../../ToolSkin/images/actions/remove.png",removeIconSize:16,removeRecordClick:function(_1){var _2=this.getRecord(_1);if(!_2||(_2&&_2._canRemove===false)){return}
this.removeEditNode(_2)},bodyKeyPress:function(_1){var _2=_1.keyName;if(_2=="Delete"||_2=="Backspace"){var _3=this.getSelectedRecord(),_4=this;if(_3&&_3._canRemove!==false){this.creator.confirmComponentDelete(_3,function(){var _5=_4.data.getParent(_3);if(_5){isc.EditContext.selectCanvasOrFormItem(_5.liveObject)}
_4.removeEditNode(_3)});return false}}
return this.Super("bodyKeyPress",arguments)},removeEditNode:function(_1){this.destroyNode(_1)},autoShowParents:true,dragStart:function(){var _1=this.ns.EH.dragTarget.getDragData();if(isc.isAn.Array(_1)){if(_1.length==0)return;_1=_1[0]}
if(_1._canRemove==false)return false;return this.Super("dragStart",arguments)},observeNodeDragResized:function(_1,_2){if(_2==null)_2=this.editContext.getDefaultParent(_1);var _3=this.editContext.getLiveObject(_2);if(_3&&isc.isA.Layout(_3)&&!isc.isA.ListGrid(_3)){var _4=_1.liveObject;if(_4.dragResized&&!this.isObserving(_4,"dragResized")){this.observe(_4,"dragResized","observer.liveObjectDragResized(observed)")}}},liveObjectDragResized:function(_1){var _2=_1.parentElement;if(_2){var _3=_1.editNode;if(_2.vertical){var _4=_1.getHeight();this.creator.projectComponents.setNodeProperties(_3,{height:_4});this.creator.componentAttributeEditor.setValue("height",_4)}else{var _5=_1.getWidth();this.creator.projectComponents.setNodeProperties(_3,{width:_5});this.creator.componentAttributeEditor.setValue("width",_5)}}},showFieldMapper:function(_1,_2,_3,_4){if(!isc.isA.ListGrid(_1)&&!isc.isA.TileGrid(_1)&&!isc.isA.DynamicForm(_1)&&!isc.isA.DetailViewer(_1))
{return}
var _5=this,_6=_1.getDataSource(),_7=_1.getAllFields(),_8=_6&&_6.isA("MockDataSource");if(!_8&&this.creator.useFieldMapper){if(_6&&_6.isA("DataSource")){_8=true}else if(_7&&_7.length>0){_8=true}}
if(_8){var _9=_2.liveObject;if(isc.isA.MockDataSource(_2.liveObject))return false;var _10=isc.FieldMapper.create({callback:_4,mockFields:_7,mockDataSource:_6,targetDataSource:_9});var _11=isc.Window.create({items:[{_constructor:"Label",contents:_10.description,width:"100%",height:1},_10,{_constructor:"DynamicForm",colWidths:"120, *, 75, 75",numCols:4,width:"100%",items:[{_constructor:"ButtonItem",title:"Use New Fields",width:120,endRow:false,click:function(){_10.setDefaultData(true)}},{_constructor:"SpacerItem"},{_constructor:"ButtonItem",title:"Cancel",width:75,endRow:false,startRow:false,click:function(){_11.destroy()}},{_constructor:"ButtonItem",title:"OK",endRow:false,startRow:false,width:75,click:function(){var _12=_10.getChanges(),_13=_10.getDeletes();var _14=_1.getRuleScopeDataBoundComponents();for(var i=0;i<_14.length;i++){_5.creator.updateComponentRuleScopeProperties(_14[i],_12,_13)}
var _16=_5.creator,_17=_16.projectComponents,_18=_17.editContext;_18.dontShowFieldMapper=true;_10.applyMap(_1,_3,_11);delete _18.dontShowFieldMapper}}]}],bodyProperties:{layoutMargin:8,defaultLayoutAlign:"center"},width:800,title:"Fields mapping",autoCenter:true,autoSize:true,isModal:true})}
return _8},hasComponents:function(){var _1=this.getData();var _2=_1.getLength();return _2>1||(_2==1&&_1.get(0).type!="DataView")},canEdit:true,modalEditing:true,editorExit:function(_1,_2,_3,_4,_5){if(!this.validateRow(_4)){return false}
var _6=isc.DS.getAutoIdField(_2),_7=_2[_6];if(_7==this.getEditedCell(_4,_5)){return}
var _8={};_8[_6]=_3;this.setNodeProperties(_2,_8);var _9=this.creator.componentAttributeEditor.getValues();if(_9[_6]==_7){this.creator.componentAttributeEditor.setValue(_6,_3)}},recordDoubleClick(viewer,record,recordNum,field,fieldNum,value,rawValue){if(field.name=="ID"&&record&&record.type=="DataSource"){isc.ClassFactory.$180h(true);isc.DS.get(record.ID,this.creator.getID()+".showDSEditor(dsID)",{loadParents:true});return false}}};isc.A.vbExtraPalettesDefaults={_constructor:"HiddenPalette",data:[{title:"DataView",type:"DataView",icon:"[TOOLSIMG]classes/DataView.png",showDropIcon:true,addToChild:{ifDropClass:"LayoutResizeBar",childClass:"VLayout",createFrom:"vlayout"},insertContainer:{ifDropClass:"Portlet",type:"PortalLayout"}},{title:"DynamicProperty",type:"DynamicProperty",icon:"[SKINIMG]DynamicForm/dynamic.png"}]};isc.A.mockupExtraPalettesDefaults={_constructor:"HiddenPalette",data:[{title:"Tab",type:"Tab"}]};isc.A.codePreviewDefaults={_constructor:"DynamicForm",autoDraw:false,overflow:"hidden",autoFocus:false,height:"*",numCols:1,browserSpellCheck:false,fields:[{formItemType:"textArea",name:"codeField",showTitle:false,height:"*",width:"*",wrap:"OFF",browserAutoCapitalize:false,browserAutoCorrect:false}],hasChanged:function(){return this.valuesHaveChanged()},discardChanges:function(){this.resetValues()},saveChanges:function(){var _1=this.getValue("codeField");var _2=this.creator,_3=_2.currentScreen;_2.loadViewFromXML(_3,_1);this.resetValues()}};isc.A.jsCodePreviewDefaults={_constructor:"DynamicForm",autoParent:"codePane",autoDraw:false,overflow:"hidden",autoFocus:false,height:"*",numCols:1,browserSpellCheck:false,fields:[{formItemType:"textArea",name:"codeField",showTitle:false,height:"*",width:"*",wrap:"OFF",browserAutoCapitalize:false,browserAutoCorrect:false}],setContents:function(_1){this.setValue("codeField",_1)}};isc.A.codePaneDefaults={_constructor:"TTabSet",autoDraw:false,paneMargin:0,hasChanged:function(){var _1=this.getTabPane(0);if(_1){return _1.valuesHaveChanged()}
return false},discardChanges:function(){var _1=this.getTabPane(0);if(_1){_1.resetValues()}},saveChanges:function(){var _1=this.getTabPane(0);if(_1){var _2=_1.getValue("codeField");var _3=this.creator,_4=_3.currentScreen;_3.loadViewFromXML(_4,_2);_1.resetValues()}}};isc.A.codeWindowDefaults={_constructor:"Window",autoDraw:false,autoCenter:true,isModal:true,showMinimizeButton:false,width:"100%",height:"100%",title:"Source Code",closeClick:function(){if(this.canSaveChanges&&this.codePane.hasChanged&&this.codePane.hasChanged()){this.saveChanges()}else{this.close()}},saveChanges:function(){var _1=this,_2=this.codePane;var _3=isc.Dialog.create({message:"Code changes have been made to the generated XML. Should these code changes be saved to the current screen definition?",icon:"[SKIN]ask.png",buttons:[isc.Button.create({title:"Discard",click:function(){_2.discardChanges();this.topElement.cancelClick();_1.close()}}),isc.Button.create({title:"Cancel",click:function(){this.topElement.closeClick()}}),isc.Button.create({title:"Save",click:function(){_2.saveChanges();this.topElement.cancelClick();_1.close()}})],autoFocusButton:2});_3.show()}};isc.A.multiActionWindowDefaults={_constructor:"Window",autoCenter:true,autoSize:true,isModal:true,showMinimizeButton:false,dismissOnEscape:true};isc.A.multiActionPanelDefaults={_constructor:"MultiActionPanel"};isc.A.componentAttributeEditorDefaults={_constructor:"TComponentEditor",$177g:"componentEditor",autoDraw:false,autoFocus:false,overflow:"auto",alwaysShowVScrollbar:true,showAttributes:true,showMethods:false,backgroundColor:isc.nativeSkin?null:"black",basicMode:true,allowDynamicProperties:true,iconHoverStyle:"darkHover",itemHoverDelay:300,shouldUseField:function(_1){var _2=this.creator,_3=this.Super("shouldUseField",arguments);if(_2.$215u==null||!_3)return _3;return(_1.name.toLowerCase().contains(_2.$215u)||_1.title.toLowerCase().contains(_2.$215u))},editComponent:function(_1,_2){this.Super("editComponent",arguments);var _3=this.$46d;if(!_3)return;var _4=(isc.DS.getAutoIdField?isc.DS.getAutoIdField(_1):null);if(!_4||_4!="name")return;for(var i=0;i<_3.length;i++){var _6=_3[i];if(_6.name!="name")continue;var _7=_6.validators;if(!_7){_7=_6.validators=[]}
_7.add({type:"custom",errorMessage:"Two fields in the same component cannot have the same name",condition:function(_6,_16,_17,_18,_19){var _8=_6.form,_9=_8.currentComponent,_2=_9.liveObject,_10=_2.editContext;if(!_10)return true;var _11=_10.getEditNodeTree(),_12=_11.getParent(_9);if(_12){var _13=_11.getChildren(_12);for(var i=0;i<_13.length;i++){var _14=_13[i],_15=isc.DS.getAutoIdField(_14);if(_14!=_9&&_15=="name"&&_17==_14[_15])
{return false}}}
return true}});_6.validateOnExit=true}}};isc.A.componentAttributeEditorLayoutDefaults={_constructor:"VLayout",layoutMargin:0,membersMargin:0};isc.A.componentAttributeEditorFilterDefaults={_constructor:"DynamicForm",numCols:1,padding:0,cellPadding:0,colWidths:["*"],height:35,defaultItems:[{name:"filter",editorType:"TextItem",changeOnKeypress:true,width:"*",height:"*",showTitle:false,showHintInField:true,suppressBrowserClearIcon:true,hint:"Search All Attributes...",icons:[{name:"go",src:"search.png",hspace:5,inline:true,showRTL:true,click:function(_1,_2,_3){_1.search()}},{name:"clear",src:"actions/clear.png",height:12,width:12,inline:true,prompt:"Clear search",click:function(_1,_2,_3){_1.clearSearch()}}],changed:function(_1,_2,_3){_1.fireOnPause("searchOnKP",{target:_1,methodName:"search"},300)},keyPress:function(_1,_2,_3){if(_3=="Escape"){_2.clearSearch();return false}}}],clearSearch:function(){this.getItem("filter").clearValue();this.search()},search:function(){var _1=this.getItem("filter").getValue();this.creator.filterComponentAttributeEditor(_1)}};isc.A.componentMethodEditorDefaults={_constructor:"TComponentEditor",sortFields:true,autoDraw:false,autoFocus:false,overflow:"auto",alwaysShowVScrollbar:true,showAttributes:false,showMethods:true,backgroundColor:isc.nativeSkin?null:"black",basicMode:true,iconHoverStyle:"darkHover",itemHoverDelay:300,tipDetails:{changed:{message:"Did you know? You can use Visible When or Enabled When to make components or fields responsive to changes in value.",detail:"If you use the Changed event with a Workflow or Action to show or hide a component, that will only work when a user changes a value.<P>Instead of using the Changed event, use the \"Visible When\" property on the target component to control when it should be shown. This works no matter how a field gets a value, in situations where the Changed event doesn't fire (such as when a form begins editing an existing record).<P>The same is true for using a Changed event to enable or disable components or make form controls read-only. Use \"Enable When\" or \"Read Only When\" instead.<P>\"Visible When\", \"Enable When\" and \"Read Only When\" can be configured on many types of components, including Form Controls, Buttons, Menu Items and more. See below for the documentation<P>",docs:["Canvas.visibleWhen","FormItem.readOnlyWhen","Canvas.enableWhen"]}},showNotifications:function(){this.dismissOldNotifications();var _1=this.$46e||[];for(var i=0;i<_1.length;i++){if(_1[i].whenRuleTip!="true")continue;var _3=this.currentComponent,_4=_1[i].name,_5=_3&&isc.DS.getNearestSchema(_3.type),_6;while(!_6&&_5){var t=_5.ID+"_"+_4;if(this.tipDetails[t]){_6=t;break}
_5=_5.superDS()}
if(!_6&&this.tipDetails[_4])_6=_4;if(!_6)continue;var _8=this.getField(_1[i].name);if(!_8){this.delayCall("showNotifications",arguments);return}
if(this.builder.getHelpDialogEnabled(_6)){var _9=this.tipDetails[_6],_10=0;var _11=this.getFields();for(var j=0;j<_11.length;j++){var f=_11[j];if(f==_8)break;if(isc.isA.SectionItem(f)){_10+=f.getHeight()}}
var _14=_9.message,_15=[{title:"Click to learn more...",separator:"&nbsp;",target:this,methodName:"showLearnMore",argNames:["tipDetails"],args:[_9]}],_16={autoFitMaxWidth:340,appearMethod:"instant",duration:7000,messageIcon:"[SKIN]/Dialog/notify.png",messageIconWidth:32,messageIconHeight:32,x:_8.getPageLeft()+40,y:_8.getPageTop()+_8.getHeight()+_10};if(!this.$221y)this.$221y=[];this.$221y.add(isc.Notify.addMessage(_14,_15,"tipNotifications",_16));this.builder.setHelpDialogEnabled(_6,false)}}},dismissOldNotifications:function(){if(!this.$221y)return;for(var i=0;i<this.$221y.length;i++){isc.Notify.dismissMessage(this.$221y[i])}
delete this.$221y},showLearnMore:function(_1){this.dismissOldNotifications();var _2=_1.detail,_3=[];var _4=isc.Canvas.create({autoDraw:false,contents:_2});_3.add(_4);if(_1.docs){var _5=_1.docs;for(var i=0;i<_5.length;i++){isc.DocUtils.suppressOnClick=true;var _7=isc.JSDoc.hoverHTML(_5[i]);delete isc.DocUtils.suppressOnClick;var _8=isc.Canvas.create({autoDraw:false,styleName:"docHover",contents:_7});_3.add(_8)}}
var _9=isc.VLayout.create({top:-9999,width:600,overflow:"visible",membersMargin:10,padding:10,members:_3});if(_9.getVisibleHeight()>600){_9.setOverflow("auto");_9.setHeight(600)}
isc.Window.create({title:"More information",autoSize:true,autoCenter:true,isModal:true,dismissOnEscape:true,canDragReposition:true,canDragResize:true,maxWidth:600,showMinimizeButton:false,items:[_9]})}};isc.A.editorPaneDefaults={_constructor:"TTabSet",autoDraw:false,paneMargin:0,paneContainerProperties:{customEdges:["T"],overflow:"hidden"},tabBarProperties:{baseLineCapSize:0},tabBarControls:[isc.Img.create({src:"actions/rotate.png",autoDraw:false,width:16,height:16,layoutAlign:"center",cursor:"pointer",showRollOver:true,canHover:true,showHover:true,hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",click:function(){var _1=isc.SelectionOutline.getSelectedObject();if(_1&&_1.editContext){_1.editContext.changeOrientationOfNode(_1.editNode)}}}),isc.Img.create({src:"[SKIN]/../../ToolSkin/images/actions/remove.png",autoDraw:false,width:16,height:16,layoutAlign:"center",cursor:"pointer",canHover:true,showHover:true,hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover",prompt:"Remove current component",click:function(){var _1=isc.SelectionOutline.getSelectedObject();if(_1&&_1.editContext){_1.editContext.destroyNode(_1.editNode)}}}),isc.LayoutSpacer.create({width:10}),"tabScroller","tabPicker"],tabDeselected:function(_1,_2,_3,_4){this.$710=_2.ID},tabSelected:function(_1,_2,_3,_4){if(!this.$710)return;var _5=this.creator.getCurrentComponent(),_6=_5?_5[this.$710+"BasicMode"]:null,_7=_5?_5[_2.ID+"BasicMode"]:null;if(_6!=_7){this.creator.editComponent(_5,_5.liveObject)}else{this.creator.applyBasicModeSettings(_5)}},selectedEditorName:function(){var _1=this.getTabObject(this.selectedTab);if(_1&&_1.title)return _1.title.toLowerCase();return null},PROPERTIES:"properties",EVENTS:"events"};isc.A.applyButtonDefaults={_constructor:"TButton",resizeable:false,autoDraw:false,title:"Apply",click:"this.creator.saveComponentEditors();",disabled:true,width:75};isc.A.advancedButtonDefaults={_constructor:"TButton",resizeable:false,autoDraw:false,click:function(){var _1=this.creator.getCurrentComponent();if(this.creator.$215u!=null){this.creator.clearComponentAttributeFilter(_1)}else{this.creator.toggleBasicMode(_1)}
this.creator.$215v(_1,_1.liveObject)},disabled:true,width:75};isc.A.helpPaneDefaults={_constructor:"THTMLFlow",padding:10,autoDraw:false,overflow:"auto"};isc.A.projectPaneDefaults={_constructor:"TTabSet",paneMargin:0,autoDraw:false};isc.A.recentProjectsMenuDefaults={_constructor:"Menu",width:100,itemClick:function(_1){var _2=this.creator;_2.confirmSaveProject(function(){_2.loadProject(_1.projectFileName,_1.projectOwnerId)})},setDynamicItems:function(){var _1=this.data,_2=this.creator.project&&this.creator.project.fileName;if(_2!=null&&_1!=null){for(var i=0;i<_1.length;i++){var _4=_1[i];this.$59h(i,(_4.projectFileName==_2))}}
return this.Super("setDynamicItems",arguments)}};isc.A.existingDeploymentsMenuConstructor="Menu";isc.A.existingDeploymentsMenuDefaults={minFieldWidth:1,canHover:true,cellHoverHTML:function(_1,_2,_3){var _4=_1.record;if(_4&&_4.fileLastModified){return"<u>Last deployed:</u><br><br><nobr>"+_4.fileLastModified+"</nobr>"}
return null},fields:[{name:"title",autoFitWidth:true},{name:"actions",width:1}],actionButtonsConstructor:"HLayout",actionButtonsDefaults:{layoutMargin:5,membersMargin:5,defaultLayoutAlign:"center",height:"100%"},redeployButtonTitle:"Redeploy",redeployButtonConstructor:"Button",redeployButtonDefaults:{width:80,click:function(){var _1=this.creator,_2=_1.creator;_2.showDeploymentWindow(_1.getEventDeploymentRecord())}},manageButtonTitle:"Manage",manageButtonConstructor:"Button",manageButtonDefaults:{width:80,click:function(){var _1=this.creator,_2=_1.creator;_2.manageDeployment(_1.getEventDeploymentRecord());isc.Menu.hideAllMenus()}},visitButtonTitle:"Visit",visitButtonConstructor:"Button",visitButtonDefaults:{width:80,click:function(){var _1=this.creator.getEventDeploymentRecord();window.open(isc.DeploymentEditor.getDeploymentURL(_1.fileName,_1.fileType));isc.Menu.hideAllMenus()}},getEventDeploymentRecord:function(){var _1=this.getRecord(this.getEventRow());return _1?_1.record:null},maxDeploymentLength:5,setData:function(_1,_2,_3,_4){_1.setSort([{property:"fileLastModified",direction:"descending"}]);var _5=[],_6=this.creator,_7=this.maxDeploymentLength;for(var i=0;i<_1.length&&i<_7;i++){var _9={record:_1[i],title:isc.DeploymentEditor.getDeploymentTitle(_1[i]),embeddedComponentFields:["actions"],embeddedComponent:this.createAutoChild("actionButtons",{members:[this.createAutoChild("redeployButton",{title:this.redeployButtonTitle}),this.createAutoChild("visitButton",{title:this.visitButtonTitle}),this.createAutoChild("manageButton",{title:this.manageButtonTitle})]})};_5.add(_9)}
if(_1.length>_7){_5.add({title:"See all...",click:function(){_6.showDeploymentsWindow();return false}})}
this.invokeSuper(null,"setData",_5,_2,_3,_4)},initWidget:function(){this.Super("initWidget",arguments);this.observe(this.dataSource,"dataChanged","observer.setData(observed.getCacheData())")},itemClick:function(_1){var _2=this.creator;_2.manageDeployment(_1.record);isc.Menu.hideAllMenus()}};isc.A.screenMenuButtonDefaults={_constructor:"TMenuButton",autoDraw:false,title:"Screen",width:80};isc.A.removeButtonDefaults={_constructor:"ImgButton",autoDraw:false,src:"[SKIN]/../../ToolSkin/images/actions/remove.png",width:16,height:16,showRollOver:false,showDown:false,prompt:"Remove",hoverStyle:"darkHover",visibility:"hidden",click:function(){var _1=this.creator.projectComponents.getEditContext(),_2=_1.getSelectedEditNodes();for(var i=0;i<_2.length;i++){_1.destroyNode(_2[i])}}};isc.A.bringToFrontButtonDefaults={_constructor:"TButton",autoDraw:false,title:"Bring to front",height:20,width:80,visibility:"hidden",click:function(){var _1=this.creator.projectComponents.getEditContext(),_2=_1.getSelectedEditNodes();for(var i=0;i<_2.length;i++){_2[i].liveObject.bringToFront()}}};isc.A.sendToBackButtonDefaults={_constructor:"TButton",autoDraw:false,title:"Send to back",height:20,width:80,visibility:"hidden",click:function(){var _1=this.creator.projectComponents.getEditContext(),_2=_1.getSelectedEditNodes();for(var i=0;i<_2.length;i++){_2[i].liveObject.sendToBack()}}};isc.A.operationsPaletteDefaults={_constructor:isc.TTreePalette,getIcon:function(_1){var _2=this.creator.getServiceElementIcon(_1);if(_2)return _2;return this.Super("getIcon",arguments)}};isc.A.schemaViewerDefaults={_constructor:isc.TTreeGrid,autoDraw:false,recordDoubleClick:"this.creator.operationSelected()",fields:[{name:"name",title:"Service/PortType/Operation",treeField:true},{name:"serviceType",title:"Type"}],getIcon:function(_1){var _2=this.creator.getServiceElementIcon(_1);if(_2)return _2;return this.Super("getIcon",arguments)}};isc.A.schemaViewerSelectButtonDefaults={_constructor:isc.TButton,autoDraw:false,title:"Select",click:"this.creator.operationSelected()"};isc.A.commonEditorFunctions={itemChange:function(_1,_2,_3){this.logInfo("itemChange on: "+_1+", value now: "+_2,"editing");if(_1.name=="classSwitcher"){this.builder.switchComponentClass(_2);return true}
if(_1.name=="type"){var _4=isc.DataSource.get("ListGridField"),_5=isc.DataSource.get("FormItem"),_6=this.dataSource,_7=false;if(_4||_5){while(_6!=null){if(_6==_4||_6==_5){_7=true;break}
_6=(_6.inheritsFrom?isc.DS.get(_6.inheritsFrom):null)}}
if(_7){this.saveItem(_1,_2);this.editComponent(this.currentComponent,this.currentComponent.liveObject)}}
if(this.immediateSave){if(this.canImmediateSaveItem(_1,_2)){this.saveItem(_1,_2)}else{_1.$48z=true}
return true}else{if(isc.isA.ExpressionItem(_1)||isc.isA.CheckboxItem(_1)||isc.isA.CriteriaItem(_1)||isc.isA.FormulaEditorItem(_1)||isc.isA.SummaryEditorItem(_1)||isc.isA.ExpressionEditorItem(_1)||(isc.isA.DynamicPropertyEditorItem(_1)&&isc.isA.DynamicProperty(_2)))
{this.saveItem(_1,_2)}else{_1.$48z=true}
return true}},implicitSaveOnBlur:true,performImplicitSave:function(_1,_2){if(_2)return;if(this.immediateSave&&_1.$48z&&!this.canImmediateSaveItem(_1)&&_1.validate())
{var _3=this.getValue(_1.name);if(_3!=null){this.saveItem(_1,_3)}}},canImmediateSaveItem:function(_1,_2){if(!this.currentComponent)return false;var _3=this.currentComponent,_4=_3.liveObject||this.builder.projectComponents.getLiveObject(_3);if(isc.isA.ExpressionItem(_1)||isc.isA.CheckboxItem(_1)||isc.isA.CriteriaItem(_1)||isc.isA.FormulaEditorItem(_1)||isc.isA.SummaryEditorItem(_1)||isc.isA.ExpressionEditorItem(_1)||(isc.isA.DynamicPropertyEditorItem(_1)&&isc.isA.DynamicProperty(_2)))
{return true}
if(isc.isA.FormItem(_4)){if(_1.name=="name"||_1.name=="title")return false;if(isc.isA.HeaderItem(_4)&&_1.name=="defaultValue")return false}else if(_4._constructor&&(_4._constructor=="ListGridField"||_4._constructor=="TreeGridField"||_4._constructor=="TileGridField"||_4._constructor=="DetailViewerField"))
{if(_1.name=="name"||_1.name=="title")return false}else if(_1.name=="ID"||_1.name=="title"){return false}
return true},itemKeyPress:function(_1,_2){if(_2=="Enter"&&(!this.immediateSave||!this.canImmediateSaveItem(_1))){this.save()}},saveItem:function(_1,_2){return this.saveItems([_1],[_2])},save:function(){if(!this.validate())return;var _1=[],_2=[];for(var i=0;i<this.items.length;i++){var _4=this.items[i];if(_4.$48z){_1.add(_4);_2.add(this.getValue(_4.name));_4.$48z=false}}
var _5=this.saveItems(_1,_2);return _5},saveItems:function(_1,_2){if(!_1||_1.length==0)return true;var _3=this.currentComponent,_4={};for(var i=0;i<_1.length;i++){var _6=_1[i],_7=_2[i];_4[_6.name]=_7}
return this.saveProperties(_4,_3)},saveProperties:function(_1,_2){if(!_2)return;var _3=_2.liveObject||this.builder.projectComponents.getLiveObject(_2);this.logInfo("applying changed properties: "+this.echo(_1)+" to: "+this.echoLeaf(_3),"editing");var _4=_3,_5,_6;if(isc.isA.FormItem(_3)||(_3._constructor&&_3._constructor=="ListGridField")){if(_1["name"]!=_6){_5={property:"name",oldValue:_3.name,newValue:_1.name}}
if(isc.isA.FormItem(_3)){_4=_3.form}else{var _7=this.builder.projectComponents.getEditContext().getEditNodeTree(),_8=_7.getParent(_2);_4=_8.liveObject}}else if(_1["ID"]!=_6){_5={property:"ID",oldValue:_3.ID,newValue:_1.ID}}
var _9=_3.editContext,_10=this.builder.projectComponents.getEditNodeTree(),_11=_10.getChildren(_2),_12=this.builder.projectComponents.getSelectedRecords(),_13=[];if(!_9)return;_9.savingComponentProperties=true;_9.$192h=true;for(var i=0;i<_11.length;i++){var _15=_11[i],_16=_15.liveObject;if(_15.type=="DynamicProperty"){var _17=_1[_16.name];if(_17&&!isc.isA.DynamicProperty(_17)){_3.clearDynamicProperty(_16.name);_9.removeNode(_15,true)}}}
for(var _18 in _1){var _19=_1[_18];if(_19!=null&&isc.isA.DynamicProperty(_19)){var _20=_19.getUniqueProperties(),_21=_9.getEditFieldsList(_19),_22=false;_20=isc.applyMask(_20,_21);for(var i=0;i<_11.length;i++){var _15=_11[i],_16=_15.liveObject;if(_15.type=="DynamicProperty"&&_16.name==_18){_9.removeNodeProperties(_2,_18);_9.removeNodeProperties(_15,["dataPath","formula","textFormula"]);_9.setNodeProperties(_15,_20);_13.add(_18);_22=true;break}}
if(!_22){var _23=isc.addProperties({type:"DynamicProperty",defaults:_20,name:_20.name},_9.findPaletteNode("type","DynamicProperty"));var _15=_9.makeEditNode(_23);_9.addNode(_15,_2,null,"dynamicProperties");_9.removeNodeProperties(_2,_18);_13.add(_18)}}}
if(_13.length>0){for(var i=0;i<_13.length;i++){delete _1[_13[i]]}}
if(_13.length>0){this.builder.projectComponents.deselectAllRecords();this.builder.projectComponents.selectRecords(_12)}
delete _9.$192h;this.builder.projectComponents.setNodeProperties(_2,_1);_9.savingComponentProperties=false;this.builder.updateComponentPropertiesSectionTitle(_3);var _24=this.builder.getCurrentlyVisibleEditor(),_25=_2[_24.ID+"BasicMode"];if(_25==false){_2.$711=true}
if(_5){this.builder.notifyIDOrFieldNameChange(_4,_5.property,_5.oldValue,_5.newValue)}
return true}};isc.A.$1751={};isc.A.rootComponentDefaults={_constructor:"Canvas",overflow:"hidden",getObjectField:function(_1){var _2=this.creator.getScreenMockupMode(this.creator.currentScreen);if(!_2)return this.Super("getObjectField",arguments);var _3=isc.ClassFactory.getClass(_1);if(isc.isA.Canvas(_3)){return"children"}else{return null}},visibilityChanged:function(_1){if(_1&&this.$203n){this.creator.showInstructions();delete this.$203n}},editProxyDefaults:{dropOut:function(){var _1=this.Super("dropOut",arguments);var _2=isc.SelectionOutline.getSelectedObject();if(_2&&_2.editProxy){_2.editProxy.showSelectedAppearance(false)}
return _1}}};isc.A.librarySearchDefaults={_constructor:"DynamicForm",autoDraw:false,height:35,numCols:1,cellPadding:0,selectOnFocus:true,searchDefaults:{name:"search",editorType:"TextItem",height:"*",width:"*",showTitle:false,hint:"Search...",showHintInField:true,suppressBrowserClearIcon:true,icons:[{name:"go",src:"search.png",hspace:5,inline:true,showRTL:true,click:function(_1,_2,_3){_1.search()}},{name:"clear",src:"actions/clear.png",height:12,width:12,inline:true,prompt:"Clear search",click:function(_1,_2,_3){_1.clearSearch();_2.focusInItem()}}],iconWidth:16,iconHeight:16,keyPress:function(_1,_2,_3){if(_3=="Enter"){_2.search();return false}
if(_3=="Escape"){_2.clearSearch();return false}
this.fireOnPause("paletteSearch",{target:_2,methodName:"search"},300)}},initWidget:function(){this.fields=[isc.addProperties({},this.searchDefaults,this.searchProperties)];this.Super("initWidget",arguments)},clearSearch:function(_1){this.clearValue("search");if(this.$206d!=null){this.$206d=null;if(!_1)this.$148l()}
this.creator.librarySearchClear.hide()},isSearching:function(){return(this.$206d!=null)},search:function(){var _1=this.getValue("search");if(_1==this.$206d)return;if(_1==null||_1==""){this.clearSearch();return}
this.creator.$210g("paletteSearch",_1);this.$148l(_1)},$148l:function(_1){this.creator.refreshLibraryComponents(null,true,_1);this.$206d=_1;this.creator.librarySearchClear.show()},addNode:function(_1){var _2=this.creator.getScreenMockupMode(this.creator.currentScreen),_3=_1.type||_1.className,_4=isc.ClassFactory.getClass(_3),_5=this.creator.projectComponents,_6=_5.getEditContext(),_7=_6.makeEditNode(_1),_8=this.creator.projectComponents.getDefaultParent(_7,true);if(!_8){var _9="No applicable parent component was found for the new component";if(!_5.getSelectedRecord()){_9="No parent component was selected for the new component"}
isc.Notify.addMessage(_9);return}
_7.dropped=true;if(!isc.isA.DynamicForm(_8.liveObject)&&_4&&_4.isA("FormItem")){_7=_6.addWithWrapper(_7,_8)}else{_7=_6.addNode(_7,_8)}
if(_2)_7.liveObject.moveTo(20,20)}};isc.A.librarySearchClearDefaults={_constructor:"Label",autoDraw:false,height:25,width:"100%",align:"right",wrap:false,contents:"Clear filter/show all components",styleName:"searchStatusBar",cursor:"pointer",click:function(){this.creator.librarySearch.clearSearch()}};isc.A.projectComponentsSearchDefaults={_constructor:"GridSearch",searchProperty:"ID",hint:"Find Live Component By ID..."};isc.A.dataSourceListSearchDefaults={_constructor:"GridSearch",searchProperty:"title",hint:"Find DataSource...",autoParent:"dataSourcePane"};isc.A.dataSourcePaneDefaults={_constructor:"VLayout",height:225};isc.A.screenPaneDefaults={_constructor:"VLayout"};isc.A.deploymentWindowConstructor="Window";isc.A.deploymentWindowDefaults={autoCenter:true,isModal:true,showModalMask:true,showMinimizeButton:false,title:"New Deployment",visibility:"hidden",width:700,height:500};isc.A.deploymentEditorConstructor="DeploymentEditor";isc.A.deploymentEditorDefaults={width:"100%",membersMargin:5,margin:5};isc.A.deploymentsWindowConstructor="Window";isc.A.deploymentsWindowDefaults={title:"Pick a Deployment to Manage",showMinimizeButton:false,showModalMask:true,visibility:"hidden",autoCenter:true,isModal:true,width:500,height:400};isc.A.deploymentsManagerConstructor="DeploymentManagerLauncher";isc.A.deploymentsManagerDefaults={width:"100%",membersMargin:5,margin:5};isc.A.superUserHelpText="A superuser is treated as having access to all roles.";isc.A.editSampleUsersWindowConstructor="Window";isc.A.editSampleUsersWindowDefaults={isModal:true,autoCenter:true,showMinimizeButton:false,width:"80%",autoSize:true,getBodyBreadthPolicy:function(){return"fill"},showModalMask:true,title:"Edit Test Users",initWidget:function(){var _1=this.creator;var _2=this;this.info=isc.Label.create({padding:5,contents:"Edit test users and roles below.<P>You can switch users while designing screens to try out role-based rules, and test users can also be used with test deployments."});var _3=isc.Auth.getCurrentUser();this.currentUserSelector=isc.DynamicForm.create({items:[{editorType:"SelectItem",name:"user",title:"Current User",value:_3?_3.userId:null,getValueMap:function(){if(_2.editGrid==null)return;var _4={};for(var i=0;i<_2.editGrid.getTotalRows();i++){if(_2.editGrid.recordMarkedAsRemoved(i))continue;var _6=_2.editGrid.getEditedRecord(i);_4[_6.userId]=(_6.firstName+" "+_6.lastName)}
return _4}}]});var _7=this.creator.superUserHelpText;var _8=isc.Validator.getStandardEmailValidators();_8.add({type:"custom",errorMessage:"User email must be unique",condition:function(_18,_19,_20,_21,_22){var _9=_22.component,_10=_22.rowNum;for(var i=0;i<_9.getTotalRows();i++){if(_10==i)continue;if(_9.getEditedRecord(i).email==_20){return false}}
return true}});var _11=this.editGrid=isc.ListGrid.create({autoFetchData:false,dataSource:isc.Auth.getUserSchema(),showHeaderMenuButton:false,selectionType:"none",showRollOver:false,canEdit:true,editEvent:"click",stopOnErrors:true,modalEditing:true,listEndEditAction:"next",saveLocally:true,autoSaveEdits:false,autoFitData:"vertical",autoFitMaxHeight:200,canRemoveRecords:true,removeRecordClick:function(_10,_18){if(!this.recordMarkedAsRemoved(_10)){var _12=0;for(var i=0;i<this.getTotalRows();i++){if(this.recordMarkedAsRemoved(i))continue;_12++}
if(_12<2)return}
var _13=this.getEditedRecord(_10);var _14=_2.currentUserSelector.getItem("user");var _15=false;if(_14.getValue()==_13.userId){_15=true}
this.Super("removeRecordClick",arguments);if(_15){_14.setValue(this.data.get(0).userId)}
_14.updateValueMap()},canEditCell:function(_10,_18){if(_18==0)return(this.data.get(_10)==null);return this.Super("canEditCell",arguments)},useAllDataSourceFields:true,fields:[{name:"userId",required:true,validators:[{type:"custom",errorMessage:"User ID must be unique",condition:function(_18,_19,_20,_21,_22){var _9=_22.component,_10=_22.rowNum;for(var i=0;i<_9.getTotalRows();i++){if(_10==i)continue;if(_9.getEditedRecord(i).userId==_20){return false}}
return true}}],change:function(_18,_19,_20,_21){var _14=_2.currentUserSelector.getItem("user");if(_14.getValue()==_21){_14.setValue(_20)}},changed:function(_18,_19,_20){var _14=_2.currentUserSelector.getItem("user");_14.updateValueMap()}},{name:"email",required:true,validators:_8},{name:"firstName",required:true,changed:function(_18,_19,_20){var _14=_2.currentUserSelector.getItem("user");_14.updateValueMap()}},{name:"lastName",required:true,changed:function(_18,_19,_20){var _14=_2.currentUserSelector.getItem("user");_14.updateValueMap()}},{name:"superUser",icon:"[SKINIMG]actions/help.png",padding:5,getFieldTitle:function(){return"<span style='padding-left:5px;'>"+this.title+"</span>"},iconClick:function(){isc.say(_7);return false},prompt:_7},{name:"roles",getEditorValueMap:function(){return isc.Auth.getAvailableRoles()}}]});this.addNewButton=isc.Button.create({title:"Add New",click:function(){_11.startEditingNew()}});this.saveButton=isc.Button.create({title:"Save",click:function(){var _9=_2.editGrid,_16=false;if(_9.hasErrors()){var _17=_9.getAllEditRows();for(var i=0;i<_17.length;i++){if(!_9.recordMarkedAsRemoved(_17[i])&&_9.rowHasErrors(_17[i])){_16=true;break}}}
if(_16){isc.warn("Test User data did not pass validation");return}
_9.saveAllEdits();_1.updateSampleUsers(_9.getData(),true);_1.updateCurrentUser({userId:_2.currentUserSelector.getValue("user")});_2.hide()}});this.cancelButton=isc.Button.create({title:"Cancel",click:function(){_2.hide()}});this.items=[this.info,this.currentUserSelector,isc.VStack.create({height:"*",membersMargin:5,layoutMargin:10,defaultLayoutAlign:"right",members:[this.editGrid,this.addNewButton]}),isc.HLayout.create({height:30,align:"center",membersMargin:5,members:[this.saveButton,this.cancelButton]})];return this.Super("initWidget",arguments)},show:function(){var _1=this.creator.project,_2=_1&&_1.authentication,_3=_2&&_2.users;if(_3==null)_3=[];this.editGrid.setData(_3.duplicate());this.currentUserSelector.setValue("user",_2.lastSelectedUser);return this.Super("show",arguments)}};isc.A.editSampleRolesWindowConstructor="Window";isc.A.editSampleRolesWindowDefaults={isModal:true,showMinimizeButton:false,autoCenter:true,width:"80%",autoSize:true,getBodyBreadthPolicy:function(){return"fill"},showModalMask:true,title:"Edit Roles",description:"Define the available roles below.  Once these roles have been defined, you can use them to control whether controls are visible or enabled, whether fields can be edited by the current user, and more.",blurbConstructor:"Label",blurbDefaults:{padding:10,height:10},roleGridConstructor:"ListGrid",roleGridDefaults:{autoFetchData:true,selectionType:"none",showRollOver:false,canEdit:true,editEvent:"click",stopOnErrors:true,modalEditing:true,listEndEditAction:"next",autoSaveEdits:false,autoFitData:"vertical",autoFitMaxHeight:200,canRemoveRecords:true,useAllDataSourceFields:true,fields:[{name:"name",required:true,validators:[{type:"custom",errorMessage:"Role name must be unique",condition:function(_1,_2,_3,_4,_5){var _6=_5.component,_7=_5.rowNum;for(var i=0;i<_6.getTotalRows();i++){if(_7==i)continue;if(_6.getEditedRecord(i).name==_3){return false}}
return true}},{type:"custom",errorMessage:'The string "*super*" cannot be used as a role-name. It is reserved for super-users. See documentation for dataSourceField.editRequiresRole for details.',condition:function(_1,_2,_3){if(_3=="*super*")return false;return true}}]}]},addNewButtonConstructor:"Button",addNewButtonDefaults:{title:"Add New",click:function(){this.creator.roleGrid.startEditingNew()}},saveButtonConstructor:"Button",saveButtonDefaults:{title:"Save",click:function(){var _1=this.creator.roleGrid,_2=false;if(_1.hasErrors()){var _3=_1.getAllEditRows();for(var i=0;i<_3.length;i++){if(!_1.recordMarkedAsRemoved(_3[i])&&_1.rowHasErrors(_3[i])){_2=true;break}}}
if(_2){isc.warn("Role data did not pass validation")}else if(!_1.hasChanges()){this.creator.hide()}else{_1.saveAllEdits(null,{target:this.creator,methodName:"updateSampleRoles"})}}},updateSampleRoles:function(){this.creator.updateSampleRolesFromDS();this.hide()},cancelButtonConstructor:"Button",cancelButtonDefaults:{title:"Cancel",click:function(){this.creator.hide()}},initWidget:function(){this.blurb=this.createAutoChild("blurb",{contents:this.description});this.roleGrid=this.createAutoChild("roleGrid",{dataSource:this.creator.roleDS});this.addNewButton=this.createAutoChild("addNewButton");this.saveButton=this.createAutoChild("saveButton");this.cancelButton=this.createAutoChild("cancelButton");this.items=[this.blurb,isc.VStack.create({height:"*",membersMargin:5,layoutMargin:10,defaultLayoutAlign:"right",members:[this.roleGrid,this.addNewButton]}),isc.HLayout.create({height:30,align:"center",membersMargin:5,members:[this.saveButton,this.cancelButton]})];return this.Super("initWidget",arguments)}};isc.A.runConfigFormDefaults={_constructor:isc.DynamicForm,autoDraw:false,width:650,height:"100%",colWidths:[100,"*"],wrapItemTitles:false,setSkin:function(_1){var _2=this.creator.getDefaultDensity(_1);if(!_2){_2=this.creator.getDefaultDensity("default")}
this.setValue("density",_2)}};isc.A.runConfigSkinFieldDefaults={name:"skin",editorType:"TSelectItem",title:"Skin",width:280,changed:function(_1,_2,_3){_1.setSkin(_3)}};isc.A.runConfigDensityFieldDefaults={name:"density",editorType:"TSelectItem",title:"Density",width:280,valueMap:{"dense":"Dense","compact":"Compact","medium":"Medium","expanded":"Expanded","spacious":"Spacious"}};isc.A.runConfigDeviceFieldDefaults={name:"device",editorType:"TSelectItem",title:"Device",width:280,defaultToFirstOption:true,valueMap:{"auto":"Auto-detect","desktop":"Desktop","tablet":"Tablet","handset":"Phone"},valueIcons:{"auto":"","desktop":"desktop.png","tablet":"tablet.png","handset":"smartphone.png"}};isc.A.runConfigUserIdFieldDefaults={name:"userId",editorType:"TSelectItem",title:"User",width:280,allowEmptyValue:true,addUnknownValues:false};isc.A.$2071=[{value:"auto",title:"Auto-detect"},{value:"desktop",title:"Desktop",icon:"desktop.png"},{value:"tablet",title:"Tablet",icon:"tablet.png"},{value:"handset",title:"Phone",icon:"smartphone.png"}];isc.A.$2072={Tahoe:"spacious",Obsidian:"spacious",Stratus:"spacious","default":"compact"};isc.A.updateAccountWindowConstructor="Window";isc.A.updateAccountWindowDefaults={width:850,autoSize:true,isModal:true,showModalMask:true,autoCenter:true,showMinimizeButton:false,title:"Update Account",visibility:"hidden",bodyProperties:{layoutMargin:10},hide:function(){var _1=this.creator.updateAccountEditor;if(_1)_1.clearValues();this.Super("hide",arguments)}};isc.A.updateAccountEditorConstructor="UpdateAccountEditor";isc.A.updateAccountEditorDefaults={width:"100%"};isc.A.manageUsersWindowConstructor="Window";isc.A.manageUsersWindowDefaults={width:600,height:400,autoCenter:true,isModal:true,showModalMask:true,showMinimizeButton:false,title:"Manage Users",visibility:"hidden"};isc.A.manageUsersPanelConstructor="ManageUsersPanel";isc.A.manageUsersPanelDefaults={width:"100%"};isc.A.instructionsPaneDefaults={_constructor:"VLayout",autoDraw:false,textDefaults:{_constructor:"Canvas",autoDraw:false,width:"100%",height:140,padding:20,contents:"Drag and drop components from<br>the library to create your screen.",styleName:"instructionsPane"},imageDefaults:{_constructor:"Img",autoDraw:false,src:"newScreenInstructions.png",layoutAlign:"center",overflow:"hidden",maxWidth:330,maxHeight:232,redrawOnResize:true,imageType:"center",getInnerHTML:function(){if(this.$211t==null){this.$211t=this.maxHeight/this.maxWidth}
var _1=this.width,_2=this.height,_3=_1,_4=Math.floor(_1*this.$211t);if(_4>_2){_4=_2;_3=Math.floor(_2/this.$211t)}
this.imageWidth=_3;this.imageHeight=_4;return this.Super("getInnerHTML",arguments)}},init:function(){this.Super("init",arguments);this.addAutoChild("text");this.addAutoChild("image")},$jo:false,$1515:function(){var _1=this.masterElement,_2=_1.getRect();_2[0]+=_1.getLeftBorderSize()+_1.getLeftMargin();_2[1]+=_1.getTopBorderSize()+_1.getTopMargin();_2[2]-=_1.getLeftBorderSize()+_1.getRightBorderSize()+_1.getLeftMargin()+_1.getRightMargin();_2[3]-=_1.getTopBorderSize()+_1.getBottomBorderSize()+_1.getTopMargin()+_1.getTopMargin();if(this.top<=-9000)_2[1]=this.top;this.setRect(_2)},masterResized:function(){this.$1515()},editProxyDefaults:{willAcceptDrop:function(_1,_2){return this.getPassThruComponent().editProxy.willAcceptDrop()},drop:function(){return this.getPassThruComponent().editProxy.drop()},dropOver:function(){return this.getPassThruComponent().editProxy.dropOver()},dropMove:function(){return this.getPassThruComponent().editProxy.dropMove()},dropOut:function(){return this.getPassThruComponent().editProxy.dropOut()},dragOver:function(){return this.getPassThruComponent().editProxy.dragOver()},getPassThruComponent:function(){var _1=this.creator,_2=_1.creator,_3=_2.getBaseOrRootComponent();return _3}}};isc.A.dataSourcePickerConstructor='ProjectFileLoadDialog';isc.A.dataSourcePickerDefaults={title:'Pick DataSource',actionButtonTitle:'Pick DataSource',fileNameTitle:"DataSource name",fileType:'ds',fileFormat:'xml',showLoadFileUI:function(){if(this.creator.hostedMode){this.noFilesMessage="No datasources found";this.disableFileName(true)}
this.Super("showLoadFileUI",arguments);this.excludeFiles=this.creator.project.datasources.map(function(_1){return _1.dsName});if(this.creator.userId&&!this.creator.userIsGuest()){this.directoryListing.setSort([{property:"fileLastModified",direction:"descending"}]);if(this.creator.allowLoadingOtherUsersScreensAndDataSources){this.directoryListing.showField("ownerId")}
this.directoryListing.initialCriteria={ownerId:this.creator.userId};delete this.directoryListing.$201d}},directoryListingProperties:{canEdit:false,showFilterEditor:true,filterOnKeypress:true,filterLocalData:true,fields:[{name:"fileName",title:"Name",width:"*"},{name:"ownerId",title:"Owner",width:"*",hidden:true},{name:"fileLastModified",title:"Last Modified",type:"datetime",width:150}],setData:function(_1){if(_1&&!isc.isA.ResultSet(_1)&&!isc.isAn.emptyArray(_1)){_1=isc.ResultSet.create({dataSource:this.dataSource,allRows:_1});if(!this.$201d){this.$201d=true;if(this.initialCriteria){this.setFilterEditorCriteria(this.initialCriteria);_1.setCriteria(this.initialCriteria)}}}
this.Super("setData",arguments)}}};isc.A.$2099="loadSharedDataSource";isc.A.downloadDataSourceDialogTitle="Export DataSource [\${dsID}]";isc.A.downloadDataSourceDialogPrompt="Choose the format in which to export this DataSource definition.  If you're making use of server capabilities, you should export to XML.";isc.A.downloadDataSourceDialogButtonTitle="Export";isc.A.dsEditorPropertyNames=["requirePK","autoAddPK","makeUniqueTableName","canSelectPrimaryKey","canAddChildSchema","showMoreButton","showLegalValuesButton"];isc.A.gridDropBindingDialogDefaults={_constructor:isc.DynamicForm,width:"100%",height:"100%",autoDraw:false,width:350,colWidths:[30,"*"],defaultFields:[{name:"bindToDataSource",type:"checkbox",showTitle:false,showLabel:false},{shouldSaveValue:false,showTitle:false,type:"staticText",defaultValue:"Bind to existing DataSource",click:function(_1){_1.selectAction("bindToDataSource")}},{showSaveValue:false,type:"SpacerItem",showTitle:false},{name:"dataSource",showTitle:false,type:"comboboxitem",width:"*",showHintInField:true,hint:"DataSource..",changed:function(_1){_1.selectAction("bindToDataSource")},validators:[{type:"requiredIf",expression:"item.form.getValue('bindToDataSource') == true"}]},{name:"createDataSource",type:"checkbox",showTitle:false,showLabel:false},{shouldSaveValue:false,showTitle:false,type:"staticText",defaultValue:"Create a new DataSource..",click:function(_1){_1.selectAction("createDataSource")}},{showSaveValue:false,type:"SpacerItem",showTitle:false},{name:"dsWizard",showTitle:false,type:"comboboxitem",width:"*",showHintInField:true,hint:"Type..",changed:function(_1){_1.selectAction("createDataSource")},validators:[{type:"requiredIf",expression:"item.form.getValue('createDataSource') == true"}]},{name:"doNothing",type:"checkbox",showTitle:false,showLabel:false},{shouldSaveValue:false,showTitle:false,type:"staticText",defaultValue:"Do nothing now; add data later",click:function(_1){_1.selectAction("doNothing")}}],values:{doNothing:true},init:function(){this.fields=isc.shallowClone(this.defaultFields);if(this.targetDataSources==null||this.targetDataSources.length==0){this.fields.find("name","bindToDataSource").disabled=true;this.fields.find("name","dataSource").disabled=true}else{this.fields.find("name","dataSource").valueMap=this.targetDataSources}
this.fields.find("name","dsWizard").valueMap=this.targetDSWizards;this.Super("init",arguments)},selectAction:function(_1){var _2=this.getValue(_1);if(!_2&&this.itemChange(this.getItem(_1),true,_2)){this.setValue(_1,true)}},mutexItems:["bindToDataSource","createDataSource","doNothing"],itemChange:function(_1,_2,_3){if(!this.mutexItems.contains(_1.name))return true;if(_3&&!_2)return false;for(var i=0;i<this.mutexItems.length;i++){var _5=this.getItem(this.mutexItems[i]);if(_5.name!=_1.name){this.setValue(_5.name,false)}}
if(_2&&_1.name=="createDataSource"&&!this.getValue("dsWizard")){var _6=this.getField("dsWizard");_6.setValue(_6.valueMap[0])}
return true}};isc.A.formDropBindingDialogDefaults={_constructor:isc.DynamicForm,width:"100%",height:"100%",autoDraw:false,width:350,colWidths:[30,"*"],defaultFields:[{name:"bindToDataSource",type:"checkbox",showTitle:false,showLabel:false},{shouldSaveValue:false,showTitle:false,type:"staticText",defaultValue:"Bind to existing DataSource",click:function(_1){_1.selectAction("bindToDataSource")}},{showSaveValue:false,type:"SpacerItem",showTitle:false},{name:"dataSource",showTitle:false,type:"comboboxitem",width:"*",showHintInField:true,hint:"DataSource..",changed:function(_1){_1.selectAction("bindToDataSource")},validators:[{type:"requiredIf",expression:"item.form.getValue('bindToDataSource') == true"}]},{name:"createDataSource",type:"checkbox",showTitle:false,showLabel:false},{shouldSaveValue:false,showTitle:false,type:"staticText",defaultValue:"Create a new DataSource..",click:function(_1){_1.selectAction("createDataSource")}},{showSaveValue:false,type:"SpacerItem",showTitle:false},{name:"dsWizard",showTitle:false,type:"comboboxitem",width:"*",showHintInField:true,hint:"Type..",changed:function(_1){_1.selectAction("createDataSource")},validators:[{type:"requiredIf",expression:"item.form.getValue('createDataSource') == true"}]},{name:"doNothing",type:"checkbox",showTitle:false,showLabel:false},{shouldSaveValue:false,showTitle:false,type:"staticText",defaultValue:"Do nothing now; add fields by hand",click:function(_1){_1.selectAction("doNothing")}}],values:{doNothing:true},init:function(){this.fields=isc.shallowClone(this.defaultFields);if(this.targetDataSources==null||this.targetDataSources.length==0){this.fields.find("name","bindToDataSource").disabled=true;this.fields.find("name","dataSource").disabled=true}else{this.fields.find("name","dataSource").valueMap=this.targetDataSources}
this.fields.find("name","dsWizard").valueMap=this.targetDSWizards;this.Super("init",arguments)},selectAction:function(_1){var _2=this.getValue(_1);if(!_2&&this.itemChange(this.getItem(_1),true,_2)){this.setValue(_1,true)}},mutexItems:["bindToDataSource","createDataSource","doNothing"],itemChange:function(_1,_2,_3){if(!this.mutexItems.contains(_1.name))return true;if(_3&&!_2)return false;for(var i=0;i<this.mutexItems.length;i++){var _5=this.getItem(this.mutexItems[i]);if(_5.name!=_1.name){this.setValue(_5.name,false)}}
if(_2&&_1.name=="createDataSource"&&!this.getValue("dsWizard")){var _6=this.getField("dsWizard");_6.setValue(_6.valueMap[0])}
return true}};isc.A.captureErrorReport=true;isc.A.captureUsageData=true;isc.A.monitorServerConnection=true;isc.A.ignoreServerCommLoss=isc.Browser.seleniumPresent;isc.A.serverReconnectWindowConstructor="ServerReconnectWindow";isc.A.initialServerCheckInterval=2;isc.A.serverCommLossWaitText="Trying to reconnect in ... ${time}";isc.A.serverReconnectNowText="Reconnect Now";isc.A.serverCommLossPingText="<span style='line-height:250%'>Pinging now to check server status<span>";isc.A.showPingDuration=1500;isc.A.failedLoadWindowConstructor="Window";isc.A.failedLoadWindowDefaults={title:"Problem with your project",showMinimizeButton:false,showCloseButton:false,dismissOnEscape:true,visibility:"hidden",showModalMask:true,autoCenter:true,autoSize:true,isModal:true,width:400};isc.A.failedLoadHostedMessage="There is a critical issue with this project, preventing it from being developed further. We are aware of this and have captured data for analysis. Please create a new project or open another project to proceed.";isc.A.failedLoadLocalMessage="There is a critical issue with this project, preventing it from being developed further.  Consult the client and server logs for details. Please create a new project or open another project to proceed.";isc.A.failedLoadViewConstructor="VBFailedLoadView";isc.A.pageReloadWindowConstructor="Window";isc.A.pageReloadWindowDefaults={title:"An error has occurred",showMinimizeButton:false,showCloseButton:false,dismissOnEscape:true,visibility:"hidden",showModalMask:true,autoCenter:true,autoSize:true,isModal:true,width:400};isc.A.pageReloadTimeoutSeconds=8;isc.A.pageReloadWindowMessage="Oops, something's gone wrong and we need to reload the page. Don't worry, your work is safe and you can keep going where you left off.  Reloading in ${countdown} seconds.";isc.A.pageReloadViewConstructor="VBReloadView";isc.B.push(isc.A.$132q=function isc_VisualBuilder__updateEditComponentRemovability(_1){if(_1==null)_1=this.$132r;else this.$132r=_1;var _2=this.projectComponents.data,_3=this.canAddRootComponents||!_2.isRoot(_2.getParent(_1))||(_1.alwaysAllowRootDrop==true||_1.alwaysAllowRootDrop=="true");this.editorPane.tabBarControls[1].setVisibility(_3)});isc.evalBoundary;isc.B.push(isc.A.$2162=function isc_VisualBuilder__updateEditComponentRotatability(_1){if(_1==null)_1=this.$132r;else this.$132r=_1;var _2=(_1?_1.type||_1.className:null),_3=(_1?_1.liveObject:null),_4=(_1&&(_2=="VLayout"||_2=="HLayout"||(_2=="LayoutResizeBar"&&isc.isA.Layout(_3.parentElement)&&!isc.isA.DataView(_3.parentElement)&&!isc.isA.Deck(_3.parentElement)))),_5=(_3&&(_2=="LayoutResizeBar"?!_3.vertical:_3.vertical));this.editorPane.tabBarControls[0].setVisibility(_4);this.editorPane.tabBarControls[0].prompt="Flip layout to "+(_5?"horizontal":"vertical")});isc.evalBoundary;isc.B.push(isc.A.setCanAddRootComponents=function isc_VisualBuilder_setCanAddRootComponents(_1){this.canAddRootComponents=_1;this.projectComponents.setProperty("canDropRootNodes",_1);this.$132q()});isc.evalBoundary;isc.B.push(isc.A.$1735=function isc_VisualBuilder__forceOfflineStorage(){if(this.storageMode=="dataSourceOnly"){return false}else if(this.storageMode=="offlineOnly"){return true}else{return!this.userId}});isc.evalBoundary;isc.B.push(isc.A.exportProject=function isc_VisualBuilder_exportProject(_1,_2){var _3=this;var _4=null;if(_1!=null)_4=_1;else if(this.project.name)_4=this.project.name;if(_4==null){isc.warn("You need to specify the project you want to export");return}else{this.$210g("export",_4)}
var _5=this.getProjectOwnerId(),_6=this.getProjectFileName();this.projectDataSource.getFile({ownerId:_5,fileName:_6,fileType:'proj',fileFormat:'xml'},function(_11,_12,_13){if(!_12){isc.warn("Failed to read project. Check the project you want to export");return}
var _7=[],_8=[],_9=[];_2.projectDir={path:_2.projectDir+_4+".proj.xml",content:_12};isc.DMI.callBuiltin({methodName:"xmlToJS",arguments:[_12],callback:function(_14,_15){var _1=isc.eval(_15);_9=_1.screens.getAllNodes();for(var i=0;i<_9.size();i++){if(_9[i].fileName&&_9[i].fileName.length>0){_8.push(_9[i].fileName)}}
for(var i=0;i<_1.datasources.length;i++){_7.push(_1.datasources[i].dsName)}
_2.screensIDs=_8;_2.dataSourcesIDs=_7;isc.DMI.callBuiltin({methodName:"downloadZip",arguments:[_2||this.ProjectExportSettings],requestParams:{showPrompt:false,useXmlHttpRequest:false,timeout:0}});isc.Notify.addMessage("Export initiated",null,null,{duration:4000})}})},{willHandleError:true,operationId:(_5?"allOwners":null)})},isc.A.autoSaveCurrentSettings=function isc_VisualBuilder_autoSaveCurrentSettings(_1){if(_1)this.$1724.add(_1);this.fireOnPause("saveCurrentSettings","saveCurrentSettings",null,"return !isc.EH.dragging")},isc.A.saveCurrentSettings=function isc_VisualBuilder_saveCurrentSettings(){if(!isc.Browser.seleniumPresent){var _1=this.settingsDataSource;if(_1&&!this.$1735()){var _2=isc.DS.get("VisualBuilder").xmlSerialize(this.currentSettings);_1.saveFile(this.settingsFile,_2,null,{showPrompt:false})}else{isc.Offline.put(this.offlineStorageKey,isc.JSON.encode(this.currentSettings,{strictQuoting:true}))}}
var _3=this.$1724;for(var i=0;i<_3.length;i++)_3[i]();this.$1724=[]},isc.A.$110h=function isc_VisualBuilder__restoreSettings(_1){this.currentSettings=isc.JSON.decode(_1);if(this.currentSettings){if(this.currentSettings.projectID&&!this.currentSettings.projectFileName){this.currentSettings.projectFileName=this.$170c(this.currentSettings.projectID);delete this.currentSettings.projectID}
if(this.currentSettings.recentProjects&&isc.isAn.Array(this.currentSettings.recentProjects)){var _2=this;this.currentSettings.recentProjects.map(function(_3){if(_3.projectID&&!_3.projectFileName){_3.projectFileName=_2.$170c(_3.projectID);delete _3.projectID}})}}
this.setProperties(this.currentSettings)},isc.A.loadCurrentSettings=function isc_VisualBuilder_loadCurrentSettings(_1){var _2=this;var _3=this.settingsDataSource;if(_3&&!this.$1735()){_3.getFile(this.settingsFile,function(_5,_6,_7){if(_5.status>=0&&_6){if(isc.isAn.Array(_5.data)&&_5.data.length>0&&_5.data[0].fileContentsJS){_2.$1736(_5.data[0].fileContentsJS,_1)}else{_2.$171t(_6,_1)}}else{isc.RPCManager.sendRequest({actionURL:_2.defaultSettingsURL,willHandleError:true,httpMethod:'GET',useSimpleHttp:true,timeout:6000,callback:function(_8,_6,_9){if(_8.status>=0&&_6){_2.$171t(_6,_1)}else{_2.$1736("{}",_1)}}})}},{willHandleError:true,timeout:6000,operationId:"xmlToJs"})}else{try{var _4=isc.Offline.get(this.offlineStorageKey);if(_4)this.$110h(_4)}finally{this.fireCallback(_1)}}},isc.A.$171t=function isc_VisualBuilder__loadCurrentSettingsReply(_1,_2){var _3=this;isc.DMI.callBuiltin({methodName:"xmlToJS",arguments:[_1],requestParams:{willHandleError:true,timeout:6000},callback:function(_4,_1){try{if(_4.status>=0){_3.$110h(_1)}}
finally{_3.fireCallback(_2)}}})},isc.A.$1736=function isc_VisualBuilder__loadCurrentSettingsReplyJs(_1,_2){try{this.$110h(_1)}finally{this.fireCallback(_2)}},isc.A.userIsGuest=function isc_VisualBuilder_userIsGuest(){return!this.userId},isc.A.getProjectFileName=function isc_VisualBuilder_getProjectFileName(){return this.project?this.project.fileName:null},isc.A.getProjectOwnerId=function isc_VisualBuilder_getProjectOwnerId(){return this.project?this.project.getOwnerId():null},isc.A.getProjectDisplayName=function isc_VisualBuilder_getProjectDisplayName(){var _1=this.project?this.project.name:null;if(!_1)return"Untitled Project";if(_1.endsWith(".proj.xml")){return _1.slice(0,-9)}else if(_1.endsWith(".xml")){return _1.slice(0,-4)}else{return _1}},isc.A.setProject=function isc_VisualBuilder_setProject(_1){if(_1==this.project)return;if(this.project){this.ignore(this.project,"setFileName");this.ignore(this.project,"setName");this.ignore(this.project,"setScreenProperties");this.ignore(this.project,"removeScreen");this.ignore(this.project,"removeGroup");if(this.dataSourceList)this.ignore(this.project.datasources,"dataChanged");this.project.builder=null}
this.project=_1;if(_1){_1.projectDataSource=this.projectDataSource;_1.screenDataSource=this.screenDataSource;this.observe(_1,"setFileName","observer.updateProjectFileName();");this.observe(_1,"setName","observer.updateProjectName();");this.observe(_1,"setScreenProperties","observer.updateScreenProperties(returnVal);");this.observe(_1,"removeScreen","observer.checkCurrentScreen();");this.observe(_1,"removeGroup","observer.checkCurrentScreen();");if(this.dataSourceList)this.observe(_1.datasources,"dataChanged","observer.updateDataSourceList();");_1.builder=this}
this.updateProjectFileName();this.updateProjectName();if(this.screenList){this.screenList.setData(_1?_1.screens:isc.Tree.create())}
if(this.dataSourceList)this.updateDataSourceList();if(this.project.currentScreenID&&!this.project.currentScreenFileName){this.project.currentScreenFileName=this.$170c(this.project.currentScreenID);delete this.project.currentScreenID}
delete this.currentScreen;this.clearRecentScreens();this.lastUsedDataSource=null;this.$216a=true;if(this.initialScreen){this.loadScreen(null,this.initialScreen);delete this.initialScreen;return}
var _2;if(this.project.currentScreenFileName){var _3=this.project.findScreen(this.project.currentScreenFileName);if(_3&&_3.mockupMode==this.mockupMode){this.setCurrentScreen(_3);_2=true}}
if(!_2)this.openDefaultScreen()},isc.A.$170c=function isc_VisualBuilder__convertIDtoFileName(_1){var _2=isc.DataSource.makeFileSpec(_1);return _2.fileName.split("/").last()},isc.A.updateDataSourceList=function isc_VisualBuilder_updateDataSourceList(){var _1=this;var _2=_1.dataSourceList.data.findAll("referenceInProject",false)||[];var _3=this.project.datasources.map(function(_6){var _4=_1.dataSourceList.data.find("ID",_6.dsName);if(_4){return _4}else{var _5=(isc.isA.MockDataSource(_6)?"MockDataSource":_6.dsType);return _1.projectComponents.editContext.makeDSPaletteNode(_6.dsName,_5)}});_3.addList(_2);this.dataSourceList.setData(_3)},isc.A.checkCurrentScreen=function isc_VisualBuilder_checkCurrentScreen(){if(this.currentScreen){if(this.currentScreen.fileName&&this.currentScreen.fileName!=""){var _1=this.project.findScreen(this.currentScreen.fileName);if(!_1)this.openDefaultScreen()}else{var _2=this.project.screens.getAllNodes();for(var i=0;i<_2.length;i++){var _4=_2[i];if(this.currentScreen==_4){return}}
this.openDefaultScreen()}}},isc.A.openDefaultScreen=function isc_VisualBuilder_openDefaultScreen(){var _1;if(this.singleScreenMode){_1=this.project.untitledScreen()}else{_1=this.project.lastSavedScreen(this.mockupMode)}
if(!_1){this.createNewScreen()}else{this.setCurrentScreen(_1)}},isc.A.createNewScreen=function isc_VisualBuilder_createNewScreen(_1,_2){var _3=this,_4=this.project;var _5=function(_7,_8){_3.resetUndoPosition();var _6=_4.addScreen(null,_7,_8);_6.mockupMode=_3.mockupMode;_3.setCurrentScreen(_6);_3.$210g("createScreen",_6.title);return _6};if(this.autoNameAndSaveProjectsAndScreens){_4.autoAssignScreenName(function(_7){var _6=_5(_7,_7);_4.setScreenDirty(_6,true);if(_1)_1(_6)},_2)}else{var _6=_5(null,"Untitled Screen");if(_1)_1(_6)}},isc.A.updateProjectFileName=function isc_VisualBuilder_updateProjectFileName(){if(this.singleScreenMode)return;this.currentSettings.projectFileName=this.project.fileName;this.currentSettings.projectOwnerId=this.project.getOwnerId();this.autoSaveCurrentSettings();this.updateRecentProjects()},isc.A.updateProjectName=function isc_VisualBuilder_updateProjectName(){if(this.projectName){this.projectName.setContents(this.getProjectDisplayName());var _1=this.project.isReadOnly();this.projectNamePane.setReadOnly(_1);this.dsNewButton.setDisabled(_1)}
this.updateRecentProjects()},isc.A.shareProject=function isc_VisualBuilder_shareProject(){var _1=this;var _2=function(){window.sharedProjects.fetchData({ownerId:window.user.username},function(_13){var _3=null;if(_13.totalRows>=20){var _3=_13.data[0].id}
var _4=isc.Math.randomUUID();var _5=_1.getParamsForProjectRunner();window.sharedProjects[_3===null?"addData":"updateData"]({id:_3,shareId:_4,parameters:isc.RPC.addParamsToURL("",_5)},function(_13){var _6;var _7;if(_1.projectRunnerShareBaseURL){_6=_1.projectRunnerShareBaseURL;_7=_6+_4+"/"}else{var _8=window.location.href,_9=window.location.pathname,_10=_9.substring(0,_9.lastIndexOf("/")+1);_6=_8.substring(0,_8.lastIndexOf(_10))+_10+_1.projectRunnerURL;_7=isc.RPC.addParamsToURL(_6,{shareId:_4})}
var _11="Your project has been shared at the following URL:<br><br><a target=_blank href='"+_7+"'>"+_7+"</a>";isc.say(_11,null,{title:"Share with others",icon:"actions/shareProjectLarge.png",buttons:[{title:"Copy URL",width:75,overflow:"visible",click:function(){var _12=document.createElement("input");_12.setAttribute("value",_7);document.body.appendChild(_12);_12.select();document.execCommand("copy");document.body.removeChild(_12);this.topElement.okClick()}},isc.Dialog.OK],autoFocusButton:1});_1.$210g("projectShare",_1.getProjectDisplayName())})},{sortBy:"lastAccessed",startRow:0,endRow:1})};this[this.singleScreenMode?"confirmSaveScreen":"confirmSaveProject"](_2)},isc.A.getParamsForProjectRunner=function isc_VisualBuilder_getParamsForProjectRunner(_1){var _2={};if(this.mockupMode){isc.addProperties(_2,{type:"screen",screen:this.currentScreen.fileName})}else if(this.singleScreenMode){isc.addProperties(_2,{type:"screen",screen:this.currentScreen.fileName})}else{var _3=this.project;isc.addProperties(_2,{type:"project",project:_3.fileName});if(_3.getOwnerId()!=null){isc.addProperties(_2,{ownerId:_3.getOwnerId()})}
if(_3.currentScreenId!=null){_2.screenId=_3.currentScreenId}
if(_3.currentScreenFileName){_2.currentScreen=_3.currentScreenFileName}
if(this.screenList){var _4=this.screenList.getSelectedRecord();if(_4)_2.currentScreen=_4.fileName}
_2.singleScreenMode=1}
if(_1){isc.addProperties(_2,{skin:_1.skin,density:_1.density,device:_1.device});if(_1.userId)_2.userId=_1.userId;if(_1.live&&isc.Messaging){var _5=""+isc.timestamp();_2.realTimeUpdates=_5;this.currentScreen.realTimeUpdates=_5}}
return _2},isc.A.runProject=function isc_VisualBuilder_runProject(_1){var _2=this;var _3=function(){if(!_2.mockupMode&&(!_2.project||!_2.project.fileName)){isc.say("Project must be saved before you can run it");return}
var _4=_2.getParamsForProjectRunner(_1);var _5=_2.projectRunnerURL;if(_2.projectRunnerRunBaseURL){_5=_2.projectRunnerRunBaseURL}
window.open(isc.RPC.addParamsToURL(_5,_4));_2.$210g("runProject",_2.getProjectDisplayName(),_1?_1.name:null)};if(this.mockupMode){var _6="autoSave.ui.xml";var _7=this.currentScreen;this.screenDataSource.saveFile({fileName:_6,fileType:'ui',fileFormat:'xml',fileAutoSaved:false,lastUsedInProject:_2.currentProject.fileName},_7.contents,function(){var _4=_2.getParamsForProjectRunner();_4.screen=_6;window.open(isc.RPC.addParamsToURL(_2.projectRunnerURL,_4))},{showPrompt:false});return}
this.saveUnsavedScreen(function(){_2[_2.singleScreenMode?"confirmSaveScreen":"confirmSaveProject"](_3)})},isc.A.saveUnsavedScreen=function isc_VisualBuilder_saveUnsavedScreen(_1){var _2,_3=this;if(this.screenList){var _4=this.screenList.getSelectedRecord();if(_4)_2=_4.fileName}
if(!_2&&!this.project.currentScreenFileName){var _5=function(_7){if(!_7)return;_3.cacheCurrentScreenContents();_3.project.saveScreenContents(_3.currentScreen,false,function(_8){if(_8.fileName){_3.project.currentScreenFileName=_8.fileName;if(_3.project.fileName){_3.project.save(function(){_3.fireCallback(_1)})}else{_3.fireCallback(_1)}}})};var _6=isc.Button.create({title:"Save Now",click:function(){_3.fireCallback(_5,["value"],[true]);isc.dismissCurrentDialog()}});isc.confirm("The current screen must be saved before it can be run",_5,{buttons:[isc.Dialog.CANCEL,_6],autoFocusButton:1})}else{this.fireCallback(_1)}},isc.A.confirmSaveScreen=function isc_VisualBuilder_confirmSaveScreen(_1){if(this.singleScreenMode&&this.currentScreen&&this.currentScreen.dirty){var _2=this;isc.confirm("Save current screen?",function(_3){if(_3==true){_2.saveScreenAs(_2.currentScreen,_1)}else if(_3==false){_2.fireCallback(_1)}},{buttons:[isc.Dialog.CANCEL,isc.Dialog.NO,isc.Dialog.YES],autoFocusButton:2})}else{this.fireCallback(_1)}},isc.A.confirmSaveProject=function isc_VisualBuilder_confirmSaveProject(_1){if(!this.project||this.project.isEmpty()||this.getProjectFileName()){this.fireCallback(_1)}else{var _2=this;isc.confirm("Save current project?",function(_3){if(_3==true){_2.project.save(_1)}else if(_3==false){_2.fireCallback(_1)}},{buttons:[isc.Dialog.CANCEL,isc.Dialog.NO,isc.Dialog.YES],autoFocusButton:2})}},isc.A.makeDefaultProject=function isc_VisualBuilder_makeDefaultProject(){var _1=this;isc.RPCManager.sendRequest({actionURL:_1.defaultProjectURL,willHandleError:true,httpMethod:'GET',useSimpleHttp:true,timeout:6000,callback:function(_2,_3,_4){if(_2.status>=0&&_3){_1.loadProjectReply(_2,{fileContents:_3},_4)}else{_1.makeNewProject(!_1.$214r)}}})},isc.A.addSampleDataSources=function isc_VisualBuilder_addSampleDataSources(_1){if(isc.Browser.seleniumPresent)return;var _2=["ProductLine","Product","Office","Employee","Customer","Order","OrderDetail","Payment"];var _3=this,_4=_3.dsDataSource,_5=[],_6=_2.length;for(var i=0;i<_2.length;i++){var _8=_2[i];_4.hasFile({fileName:_8,fileType:"ds",fileFormat:"xml"},function(_9,_10,_11){if(!_10){_5.add(_11.data.fileName)}
_3.$219z=_5.length;if(--_6==0){_3.$215x(_2,_5,_1)}})}},isc.A.$215x=function isc_VisualBuilder__addSampleDataSources(_1,_2,_3){var _4=isc.RPCManager.startQueue();var _5=this;var _6=function(_8){_5.project.addDatasource(_8)};for(var i=0;i<_1.length;i++){var _8=_1[i];if(_2.contains(_8)){this.dsDataSource.addData({"fileName":_8},function(_11){_6(_11.clientContext.id)},{"operationId":"copyClassicModels",clientContext:{id:_8}})}else{_6(_8)}}
if(!_4){var _9="<br>We've automatically added some sample DataSources to get you started.<p>You can drag & drop DataSources onto grids, table layouts and other bindable components to configure them.";isc.RPCManager.sendQueue(function(_11){var _10=350;if(!_3){isc.Notify.addMessage(_9,[],"dsListNotifications",{duration:0,canDismiss:true,messageIcon:isc.Canvas.$wz,disappearMethod:"instant",x:_5.dataSourceList.body.getPageLeft()-(_10),y:_5.dataSourceList.body.getPageTop(),labelProperties:{width:_10}})}
delete _5.$219z})}},isc.A.getDefaultProjectAuthenticationData=function isc_VisualBuilder_getDefaultProjectAuthenticationData(){if(!this.useSampleUsersAndRoles)return null;return{provider:"inlineSampleUsers",users:[{userId:"joe",email:"jpadmin@company.com",firstName:"Joe",lastName:"Admin",title:"Admin",superUser:true},{userId:"steve",email:"stuser@company.com",firstName:"Steve",lastName:"User",title:"Staff",roles:["view"],phone:"867 5309"}],lastSelectedUser:"joe",availableRoles:[{name:"admin",description:"This role allows users to administrate the application"},{name:"view",description:"This role allows users to view the application"}]}},isc.A.makeNewProject=function isc_VisualBuilder_makeNewProject(_1,_2){var _3=isc.Project.create({builder:this});_3.authentication=this.getDefaultProjectAuthenticationData();if(this.autoNameAndSaveProjectsAndScreens){var _4=this;_3.autoAssignProjectName(function(_5){_3.setFileName(_5);_3.setName(_5);if(_1)_4.addSampleDataSources();_4.setProject(_3);_4.$210g("createProject",_5);_4.$211v=true;if(_2)_2()})}else{this.setProject(_3);this.$210g("createProject",_3.name);if(_2)_2()}});isc.evalBoundary;isc.B.push(isc.A.showLoadProjectUI=function isc_VisualBuilder_showLoadProjectUI(){if(!this.loadProjectDialog)this.loadProjectDialog=this.createAutoChild('loadProjectDialog',{dataSource:this.projectDataSource});this.loadProjectDialog.showLoadFileUI({target:this,methodName:"loadProjectReply"},"allOwners")},isc.A.loadProjectReply=function isc_VisualBuilder_loadProjectReply(_1,_2,_3){if(!_2||!_2.fileContents){if(_2&&_2.fileName){var _4=isc.Project.create({builder:this});_4.setFileSpec(_2);_4.authentication=this.getDefaultProjectAuthenticationData();this.setProject(_4);this.project.autoSave()}else{isc.warn("Failed to open project")}
return}
if(_2.fileContentsJS){this.loadProjectReplyJs(_2)}else{var _5=this;isc.DMI.callBuiltin({methodName:"xmlToJS",arguments:[_2.fileContents],callback:function(_6,_7){_2.fileContentsJS=_7;_5.loadProjectReplyJs(_2)}})}},isc.A.loadProjectReplyJs=function isc_VisualBuilder_loadProjectReplyJs(_1){var _2=isc.eval(_1.fileContentsJS);if(_2.screens){_2.screens.getAllNodes().map(function(_6){if(_6.contents)_6.dirty=new Date();if(isc.isA.String(_6.mockupMode)){_6.mockupMode=(_6.mockupMode=="true")}
if(isc.isA.String(_6.oldVersionLoaded)){_6.oldVersionLoaded=(_6.oldVersionLoaded=="true")}
if(_6.screenID){_6.fileName=this.$170c(_6.screenID);delete _6.screenID}})}
if(_2.authentication==null||isc.isAn.emptyObject(_2.authentication)){_2.authentication=this.getDefaultProjectAuthenticationData()}else if(_2.authentication.sampleUsers&&_2.authentication.sampleUsers.currentUser){_2.authentication.users=_2.authentication.sampleUsers.currentUser;delete _2.authentication.sampleUsers;var _3=_2.authentication.users;for(var i=0;i<_3.length;i++){var _5=_3[i];if(isc.isAn.Object(_5.roles)){_5.roles=isc.getValues(_5.roles)}}}
_2.builder=this;_2.setFileSpec(_1);this.setProject(_2)},isc.A.loadProject=function isc_VisualBuilder_loadProject(_1,_2){if(!_1){this.logWarn("Tried to loadProject without a fileName");return}
this.$214t=_1;isc.showPrompt("Loading Project... ${loadingImage}");var _3=this;this.projectDataSource.getFile({fileName:_1,ownerId:_2,fileType:'proj',fileFormat:'xml'},function(_7,_8,_9){delete _3.$214t;if(_7.status==0&&isc.isAn.Array(_7.data)&&_7.data.length>0){_3.loadProjectReply(_7,_7.data[0],_9)}else{_3.removeRecentProject(_1);isc.clearPrompt();var _4=_3.getRecentProjects(),_5=(_4.length>0?_4[0].projectFileName:null),_6=(_5?"Attempting to load "+_5+" instead.":"Starting a new project instead.");isc.warn("Error loading project: "+_1+"<p>"+_6,function(_10){if(_5)_3.loadProject(_5);else _3.makeDefaultProject()})}},{willHandleError:true,operationId:(_2?"allOwners":"xmlToJs")})},isc.A.resetProjectState=function isc_VisualBuilder_resetProjectState(){var _1=this,_2="Actions and workflows can update DataSources, hide/show components, change component titles, etc.<P>Would you like to reset the project to its initial state?";;isc.confirm(_2,function(_3){if(_3)_1.$2073()},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1,width:400,height:180})},isc.A.$2073=function isc_VisualBuilder__resetProjectState(){if(this.currentScreen&&this.currentScreen.dirty){this.delayCall("$2073");return}
var _1=this,_2=this.project;this.withoutDirtyTracking(function(){_1.projectComponents.destroyAll();_1.project.datasources.map(function(_4){var _3=isc.DS.get(_4.dsName);if(_3)_3.destroy()});_1.loadProject(_2.fileName,_2.getOwnerId())})},isc.A.confirmDeleteProject=function isc_VisualBuilder_confirmDeleteProject(_1){var _2=this;var _3=isc.ConfirmDeleteProjectDialog.create({projectName:this.getProjectFileName(),buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1,callback:function(_4){if(_4)_2.deleteProject(this.deleteAllResources,_1)}});_3.show()},isc.A.deleteProject=function isc_VisualBuilder_deleteProject(_1,_2){var _3=this;var _4=function(){_3.projectDataSource.removeFile({fileName:_3.project.fileName,fileType:'proj',fileFormat:'xml'},function(){_3.$214r=true;_3.removeRecentProject(_3.project.fileName);isc.Notify.addMessage("The project "+_3.project.fileName+" has been successfully deleted.");var _5=_3.getRecentProjects();if(_5&&_5.length>0){_3.loadProject(_5[0].projectFileName,_5[0].projectOwnerId)}else{_3.makeDefaultProject()}
if(_2)_3.fireCallback(_2)})};if(!_1){_4();return}
var _6=this.project.screens.getAllNodes(),_7=this.project.datasources,_8=[],_9=[];for(var i=0;i<_6.length;i++){var _11=_6[i];if(_11.fileName)_8.add(_11.fileName)}
this.loadAllProjectDataSources(function(){for(var i=0;i<_7.length;i++){var _12=_7[i].dsName,_13=isc.DS.get(_12);if(_13&&_13.apidoc!=false&&_13.isSampleDS!=true){_9.add(_7[i].dsName)}}
var _14=_8.length+_9.length;if(_14>0){if(_8.length>0){for(var i=0;i<_8.length;i++){var _15=_8[i];_3.screenDataSource.removeFile({fileName:_15,fileType:'ui',fileFormat:'xml'},function(){if(--_14==0){_4()}})}}
if(_9.length>0){for(var i=0;i<_9.length;i++){var _15=_9[i];_3.dsDataSource.removeFile({fileName:_15,fileType:'ds',fileFormat:'xml'},function(){if(--_14==0){_4()}})}}}else{_4()}})},isc.A.slowLoadAllProjectDataSources=function isc_VisualBuilder_slowLoadAllProjectDataSources(_1){if(this.$219z){this.logDebug("Delaying DS load due to pending addSampleDataSources()");this.delayCall("slowLoadAllProjectDataSources",[_1],100);return}
var _2=this.project.datasources,_3=_2.getProperty("dsName");if(_3.length>0){this.delayCall("$216b",[_3,_1],this.dataSourcesSlowLoadInitialDelay)}else{this.fireCallback(_1)}},isc.A.$216b=function isc_VisualBuilder__loadNextDataSource(_1,_2){var _3=_1.pop();if(_3&&!isc.DS.get(_3)){var _4=this;isc.DS.load(_3,function(){_4.delayCall("$216b",[_1,_2],_4.dataSourcesSlowLoadDelay)});return}else if(_3){this.delayCall("$216b",[_1,_2]);return}
this.fireCallback(_2)},isc.A.loadAllRelatedDataSources=function isc_VisualBuilder_loadAllRelatedDataSources(_1,_2,_3){if(_3&&!isc.isAn.Array(_3))_3=[_3];var _4=_1.getFieldNames(),_5=[];for(var i=0;i<_4.length;i++){var _7=_4[i],_8=_1.getField(_7);if(!_8.includeFrom)continue;if(_3&&!_3.contains(_7))continue;var _9=_8.includeFrom,_10=_9.split(".");for(var j=0;j<_10.length-1;j++){var _12=_10[j];if(!_5.contains(_12))_5.add(_12)}}
if(_5.length>0){var _13=this;var _14=function(){for(var i=0;i<_5.length;i++){var _12=_5[i],_15=isc.DS.get(_12);_13.project.addDatasource(_12,_15.serverType);isc.ClassFactory.$180h(null);var _16=_15.hasOwnProperty("mockData")?"mock":"fields";_13.$210g("addSharedDS",_12,_16)}
var _17={};for(var i=0;i<_4.length;i++){var _7=_4[i],_8=_1.getField(_7);if(!_8.includeFrom)continue;var _9=_8.includeFrom,_10=_9.split("."),_18=_10[_10.length-2],_19=_10[_10.length-1],_20=isc.DS.get(_18);if(!_20)continue;var _21=_20.getField(_19);if(!_21)continue;if(_21.includeFrom){if(!_17[_18]){_17[_18]=[]}
_17[_18].add(_19)}}
if(isc.isAn.emptyObject(_17)){if(_2)_13.fireCallback(_2,"relatedDataSources",[_5]);return}
var _22=isc.getKeys(_17).length;for(var _12 in _17){var _20=isc.DS.get(_12),_23=_17[_12];_13.loadAllRelatedDataSources(_20,function(_25){if(_25)_5.addList(_25);if(--_22==0){if(_2)_13.fireCallback(_2,"relatedDataSources",[_5])}},_23)}};var _24=[];for(var i=0;i<_5.length;i++){if(!isc.DS.get(_5[i]))_24.add(_5[i])}
if(_24.length>0){isc.ClassFactory.$180h(true);isc.DS.load(_24,function(){_14()})}else{_14()}}},isc.A.loadAllProjectDataSources=function isc_VisualBuilder_loadAllProjectDataSources(_1){var _2=this.project.datasources,_3=[];for(var i=0;i<_2.length;i++){if(!isc.DS.get(_2[i].dsName))_3.add(_2[i].dsName)}
if(_3.length>0){isc.DS.load(_3,_1)}else{this.fireCallback(_1)}},isc.A.getRecentProjects=function isc_VisualBuilder_getRecentProjects(){if(!this.recentProjects)this.recentProjects=[];return this.recentProjects},isc.A.setRecentProjects=function isc_VisualBuilder_setRecentProjects(_1){var _2=this.getRecentProjects();_2.setLength(0);_2.addList(_1)},isc.A.removeRecentProject=function isc_VisualBuilder_removeRecentProject(_1){var _2=this.recentProjects;if(_2){var _3=_2.find("projectFileName",_1);if(_3){_2.remove(_3);this.autoSaveCurrentSettings()}}},isc.A.updateRecentProjects=function isc_VisualBuilder_updateRecentProjects(){var _1=this.getProjectFileName();if(!_1||_1==this.singleScreenModeProjectFileName)return;var _2=this.getRecentProjects();var _3=_2.findIndex("projectFileName",_1);if(_3!=-1)_2.removeAt(_3);_2.addAt({projectFileName:_1,projectOwnerId:this.getProjectOwnerId(),title:this.getProjectDisplayName()},0);if(_2.getLength()>this.recentProjectsCount){_2.setLength(this.recentProjectsCount)}
this.currentSettings.recentProjects=_2;this.autoSaveCurrentSettings()},isc.A.launchReifyPreview=function isc_VisualBuilder_launchReifyPreview(){var _1=this,_2=this.project,_3=this.currentScreen,_4="?reifyPreview=yes";var _5=function(){_1.reifyWindow=window.open("/tools/bmmlImporter.jsp"+_4)};var _6=isc.isA.OfflineFileSource(this.screenDataSource);if(!_6)_4+="&screenDS="+_1.screenDataSource.getID();if(_3.fileName){_4+="&mockup="+_3.fileName;_1.cacheCurrentScreenContents();_1.project.saveScreenContents(_3,true,_5)}else{if(_2.fileName){_4+="&mockup="+_2.fileName+"&projectDS="+(_6?"":_1.projectDataSource.getID())}
_2.autoSave(_5)}},isc.A.launchGoToBuilder=function isc_VisualBuilder_launchGoToBuilder(){var _1=this,_2=this.project,_3=this.currentScreen;if(_3==null)return;_1.cacheCurrentScreenContents();if(_1.openFullBuilderSeparately){this.fireCallback("$1741")}else if(_3.fileName){_1.project.saveScreenContents(_3,true,"$1741")}else{_2.autoSave("$1741")}},isc.A.$1741=function isc_VisualBuilder__launchGoToBuilder(){var _1=this,_2=this.project,_3=this.currentScreen,_4=isc.MockupImporter.create(),_5=_1.openFullBuilderSeparately;_4.reifyComponentXml(_3.contents,function(_11,_12){isc.DMI.callBuiltin({methodName:"xmlToJS","arguments":_11,callback:function(_13,_14,_15){var _6=isc.Canvas.getPrototype().autoDraw;isc.setAutoDraw(false);var _7=[];isc.Class.globalEvalAndRestore(_13.data+"; getTopLevelWidgets()",null,null,{getTopLevelWidgets:function(){for(var i=0;i<_12.length;i++){var _9=_12[i].ID||_12[i].autoID;if(_12[i]._constructor!="ValuesManager"&&_12[i]._constructor!="MockDataSource"&&window[_9].parentElement==null)
{window[_9].destroy();_7.add(_9)}}}});_11+=isc.MockupImporter.getDataViewXml(_7);isc.setAutoDraw(_6);_2.saveGoToBuilderScreen("New Screen",_11,function(_16,_14){var _10=isc.URIBuilder.create(_1.fullBuilderURL||window.location.href);_10.setQueryParam("currentScreen",_14.fileName);_10.setQueryParam("mockups",0);if(_5)window.open(_10.uri);else window.location.assign(_10.uri)})}})})},isc.A.updateReifyPreviewSoon=function isc_VisualBuilder_updateReifyPreviewSoon(){var _1=this;if(_1.pendingActionOnPause("updateReify"))return;var _2=_1.reifyWindow;_1.fireOnPause("updateReify",function(){if(_2.closed){delete _1.reifyWindow}else{_2.scheduleReifyUpdate()}},this.$174u,"return !isc.EH.dragging")},isc.A.confirmMenuAction=function isc_VisualBuilder_confirmMenuAction(_1,_2,_3,_4,_5){var _6,_7=this;var _8=this.getHelpDialogEnabled(_1);if(!_8)return this[_3]();var _9=isc.DynamicForm.create({width:500,autoDraw:false,bottomPadding:5,topPadding:5,cellPadding:5,numCols:3,colWidths:[50,_4,"*"],items:[{showTitle:false,editorType:"CanvasItem",height:50,icons:[{width:32,height:32,src:"[SKIN]/Dialog/confirm.png"}]},{name:"message",editorType:"StaticTextItem",showTitle:false,colSpan:2,cellHeight:50,height:50,value:_5},{editorType:"ButtonItem",title:"Cancel",width:125,align:"right",endRow:false,colSpan:2,click:function(){_6.destroy()}},{editorType:"ButtonItem",title:_2,width:125,startRow:false,click:function(){_7[_3]();_6.destroy()}},{name:"hide",editorType:"CheckboxItem",title:"Don't show this message again",colSpan:2,changed:function(_9,_10,_11){_7.setHelpDialogEnabled(_1,!_11)},showIf:function(){return!_7.hostedmode||!_7.userIsGuest()}}]});_6=isc.Window.create({title:"Confirm",autoSize:true,items:[_9],autoCenter:true});_6.show()},isc.A.confirmReifyPreview=function isc_VisualBuilder_confirmReifyPreview(){this.confirmMenuAction(this.$174v,"Reify now","launchReifyPreview",200,"Reify Preview will analyze your mockup and produce a screen from it, and show that screen in a new browser window.  If you continue to change your mockup, the Reify Preview window will automatically update.")},isc.A.confirmOpenInBuilder=function isc_VisualBuilder_confirmOpenInBuilder(){this.confirmMenuAction(this.$1742,"Go to Visual Builder","launchGoToBuilder",235,"Visual Builder is a tool that allows you to add more advanced capabilities to your mockup.<p>You can use Visual Builder to take the next steps required to turn your mockup into a working application, or just to produce a high-fidelity mockup for usability or user acceptance testing.")},isc.A.warnOnce=function isc_VisualBuilder_warnOnce(_1,_2,_3,_4){var _5=this.getHelpDialogEnabled(_1);if(!_5)return _3(true);if(!_4)_4={};if(!_4.icon)_4.icon=isc.Dialog.getInstanceProperty("warnIcon");if(!_4.title)_4.title=isc.Dialog.WARN_TITLE;var _6=isc.ConfirmOnceDialog.create(isc.addProperties({builder:this,dialogId:_1,message:_2,buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1,callback:_3},_4));_6.show()},isc.A.setHelpDialogEnabled=function isc_VisualBuilder_setHelpDialogEnabled(_1,_2,_3){var _4=this.currentSettings,_5=_4.helpDialogs||{};if(this.hostedMode&&this.userIsGuest()){this.logInfo("setHelpDialogEnabled(): settings may not be changed by guest");return}
if(!isc.isA.String(_1)){this.logWarn("setHelpDialogEnabled() called with an invalid dialogId: "+_1);return}
_5[_1]=!!_2;_4.helpDialogs=_5;this.autoSaveCurrentSettings(_3)},isc.A.getHelpDialogEnabled=function isc_VisualBuilder_getHelpDialogEnabled(_1){var _2=this.currentSettings,_3=_2.helpDialogs||{};var _4=_3[_1];if(_4!=null&&isc.isA.String(_4))_4=(_4.toLowerCase()=="true");return(this.hostedMode&&this.userIsGuest())||_4!=false},isc.A.showAddScreenGroupUI=function isc_VisualBuilder_showAddScreenGroupUI(_1){var _2=this.project.addGroup(_1,"New Group");var _3=this.screenList.getRecordIndex(_2);this.screenList.delayCall("startEditing",[_3,0])},isc.A.loadScreen=function isc_VisualBuilder_loadScreen(_1,_2,_3,_4,_5,_6){var _7=this;if(!_5){_5=function(_10,_11,_12){if(!_2){_2=_11.fileName;_11=_11.fileContents}
var _8=_7.project.addScreen(_1,_2,_2,_11,false);_7.setCurrentScreen(_8);if(_6){_7.$210g(_6,_8.title,_7.getProjectDisplayName())}}}
if(_2){var _9=this.project.getOwnerId();this.screenDataSource.getFile({ownerId:_9,fileName:_2,fileType:'ui',fileFormat:'xml'},_5,{operationId:(_9?"allOwners":null)})}else{if(!this.loadScreenDialog){this.loadScreenDialog=this.createAutoChild('loadScreenDialog',{dataSource:this.screenDataSource})}
if(_3)this.loadScreenDialog.setTitle(_3);if(_4)this.loadScreenDialog.setActionButtonTitle(_4);this.loadScreenDialog.showLoadFileUI(_5)}},isc.A.showCopyExistingScreenUI=function isc_VisualBuilder_showCopyExistingScreenUI(_1){var _2=this;this.loadScreen(_1,null,"Copy Screen","Copy Screen",function(_6,_4,_7){var _3=_4.fileName,_4=_4.fileContents;_2.project.getUniqueScreenCopyName(_3,function(_8){var _5=_2.project.addScreen(_1,_8,_8,_4,false);_2.project.saveScreenContents(_5);_2.setCurrentScreen(_5)})})},isc.A.showLoadSharedScreenUI=function isc_VisualBuilder_showLoadSharedScreenUI(_1){var _2=this;this.warnOnce(this.$2098,"Since the selected screen will be shared, changes made by any user can affect multiple projects.",function(_3){if(_3){_2.loadScreen(_1,null,"Load Shared Screen","Load Screen",null,"addSharedScreen")}},{buttons:[isc.Dialog.CANCEL,{title:"Continue",width:75,overflow:"visible",click:function(){this.topElement.okClick()}}],autoFocusButton:1})},isc.A.deleteScreen=function isc_VisualBuilder_deleteScreen(_1){var _2=this;this.screenDataSource.removeFile({fileName:_1.fileName,fileType:'ui',fileFormat:'xml'},function(){_2.project.removeScreen(_1);isc.Notify.addMessage("The screen "+_1.fileName+" has been successfully deleted.")});this.$210g("deleteScreen",_1.title,this.getProjectDisplayName())},isc.A.removeEmbeddedDataSources=function isc_VisualBuilder_removeEmbeddedDataSources(){if(!this.projectComponents)return;var _1=this.projectComponents.getEditContext().getEditNodeArray();if(_1&&_1.length>0){for(var i=0;i<_1.length;i++){var _3=_1[i];if(isc.isA.MockDataSource(_3.liveObject)){var _4=this.dataSourceList.data.find("ID",_3.ID);if(_4&&_4.referenceInProject==false){this.dataSourceList.removeData(_4)}}}}},isc.A.cacheCurrentScreenContents=function isc_VisualBuilder_cacheCurrentScreenContents(){if(this.currentScreen==null)return;this.currentScreen.contents=this.getUpdatedSource()},isc.A.setCurrentScreen=function isc_VisualBuilder_setCurrentScreen(_1){var _2=this.currentScreen,_3=(_2?this.currentScreen.mockupMode:null);if(_2==_1)return;this.cacheCurrentScreenContents();this.removeEmbeddedDataSources();this.currentScreen=_1;this.resetUndoPosition();if(this.savingScreenLabel)this.savingScreenLabel.setContents("");if(!this.projectComponentsMenu)this.addChildren();if(_1){if(!this.$210h){this.$210h=true;this.$210g("appStart",this.getProjectFileName(),_1.title)}
if(_1.contents){this.withoutDirtyTracking(function(){this.projectComponents.destroyAll()});this.setScreenContents(_1.contents,_3)}else{this.hideInstructions();this.$2000=true;this.withoutDirtyTracking(function(){this.clearScreenUI()});var _4=this;this.project.fetchScreenContents(_1,function(_5){if(_5){_4.withoutDirtyTracking(function(){_4.projectComponents.destroyAll()});_4.setScreenContents(_5,_3);if(_1.fileName&&!_4.project.isReadOnly()){_4.savingScreenLabel.setContents("All changes saved")}}else{_4.updateScreenTitle();_4.showScreenUI();_4.refreshLibraryComponents();_4.updateProjectMenuControl();_4.updateRunMenuControl();_4.showInstructions();_4.updateUsersRolesMenuControl();_4.project.setScreenDirty(_1,true)}
_4.$2000=false;if(_4.$211v){_4.$211w()}
if(_4.$216a){_4.slowLoadAllProjectDataSources(function(){isc.clearPrompt()})}})}}else{this.show();this.updateScreenTitle();if(_4.$216a){_4.slowLoadAllProjectDataSources(function(){isc.clearPrompt()})}}
this.project.setCurrentScreenFileName(_1.fileName);this.project.setCurrentScreenId(_1.id);this.updateProjectName();if(this.screenList)this.screenList.selectSingleRecord(_1);this.updateRecentScreens();if(!this.$2000&&this.$211v){this.$211w()}},isc.A.$211w=function isc_VisualBuilder__newProjectReady(){if(!this.$211v)return;this.$211v=false;isc.Notify.addMessage("New Project created");this.projectName.editProxy.startInlineEditing()},isc.A.setScreenContents=function isc_VisualBuilder_setScreenContents(_1,_2,_3){var _4=this,_5=_3||_1,_6=(_3?"getPaletteNodesFromJS":"getPaletteNodesFromXML");this.projectComponents[_6](_5,function(_24){var _7=(_24&&_24.length>0?_24[0]:null),_8=(_24&&_24.length>0?_24[_24.length-1]:null);if((_7&&_7.type=="MockupContainer")||(_8&&_8.type=="MockupContainer"))
{var _9=(_7.type=="MockupContainer"?_7:_8),_10=_9.defaults,_11=_24;if(_10.dataSources||_10.components){_11=[];_11.addList(_10.dataSources);_11.addList(_10.components)}
var _12=[];for(var i=0;i<_11.length;i++){var _14=_11[i],_15=_14.type||_14._constructor;if(_15&&_15!="MockupContainer"){var _10=(_14.defaults?_14.defaults:isc.addProperties({},_14));_12.add({type:_15,defaults:_10})}}
_4.mockupMode=_4.currentScreen.mockupMode=true;_4.refreshLibraryComponents(function(){_4.updateScreenTitle();if(_2!=_4.currentScreen.mockupMode){_4.showScreenUI()}
if(_12)_4.projectComponents.addFromPaletteNodes(_12);_4.updateSelectionActionButtons();_4.promptUserToCopyProject();if(_4.initialVersion){_4.revertScreen(_4.currentScreen,_4.initialVersion);delete _4.initialVersion}})}else{_4.mockupMode=_4.currentScreen.mockupMode=false;_4.refreshLibraryComponents(function(){_4.updateScreenTitle();if(_2!=_4.currentScreen.mockupMode){_4.showScreenUI()}
if(_24){_4.projectComponents.addFromPaletteNodes(_24);_4.withoutDirtyTracking(function(){_4.projectComponents.getEditContext().screenLoadComplete()});var _16=_4.projectComponents.getEditContext().getLoadingErrors();if(_16){var _17="Screen loaded with errors:<ul>";for(var i=0;i<_16.length;i++){_17+="<li>"+_16[i]+"</li>"}
isc.Notify.addMessage(_17,null,null,{canDismiss:true,duration:0})}
var _18=_4.projectComponents.getEditContext().getEditNodeArray();if(_18&&_18.length>0){for(var i=0;i<_18.length;i++){var _14=_18[i];if(isc.isA.Canvas(_14.liveObject)){if(_4.editingOn){_4.projectComponents.getEditContext().selectSingleEditNode(_14)}
_4.projectComponents.scrollRecordIntoView(_4.projectComponents.getRecordIndex(_14));if(_14.type==_4.initialComponent.type){_14.showDropIcon=true}
break}}}}
_4.updateSelectionActionButtons();if(!_4.canAddRootComponents){var _19=_4.projectComponents.getRootEditNode(),_20=_4.projectComponents.getEditNodeTree().getChildren(_19);for(var i=0;i<_20.length;i++){var _21=_20[i];if(isc.isA.Canvas(_21)){_21._canRemove=false;_4.projectComponents.markForRedraw();break}}}
var _18=_4.projectComponents.getEditContext().getEditNodeArray();if(_18)_18.map(function(_14){if(_14.isLoaded&&_14.liveObject&&isc.isA.DataSource(_14.liveObject)){var _22=_14.liveObject;var _23=_4.dataSourceList.data.find("ID",_22.name);if(_23&&_23.referenceInProject!=false){_14.referenceInProject=true}}});_4.addCurrentScreenMockDataSourcesToList();_4.promptUserToCopyProject();if(_4.initialVersion){_4.revertScreen(_4.currentScreen,_4.initialVersion);delete _4.initialVersion}})}
_4.updateRunMenuControl()})},isc.A.promptUserToCopyProject=function isc_VisualBuilder_promptUserToCopyProject(){var _1=this.project;if(_1.promptToCopy&&_1.isReadOnly()){isc.warn("This project is read-only. If you would like to edit, please make a copy.",function(_2){if(_2){_1.duplicate();return}},{buttons:[isc.Dialog.CANCEL,{title:"Copy Project",width:75,overflow:"visible",click:function(){this.topElement.okClick()}}],autoFocusButton:1})}
delete _1.promptToCopy},isc.A.addCurrentScreenMockDataSourcesToList=function isc_VisualBuilder_addCurrentScreenMockDataSourcesToList(){var _1=this;var _2=_1.projectComponents.getEditContext().getEditNodeArray();var _3=[];if(_2)_2.map(function(_8){if(_8.isLoaded&&_8.liveObject&&isc.isA.DataSource(_8.liveObject)){var _4=_8.liveObject;var _5=_1.dataSourceList.data.find("ID",_4.name);if(!_5&&!_3.contains(_4.name)){var _6=(isc.isA.MockDataSource(_4)?"MockDataSource":_4.serverType);var _7=_1.projectComponents.editContext.makeDSPaletteNode(_4.name,_6);_7.referenceInProject=false;_1.dataSourceList.addData(_7);_3.add(_4.name)}}})},isc.A.updateScreenProperties=function isc_VisualBuilder_updateScreenProperties(_1){if(this.screenList){var _2=this.screenList.getRecordIndex(_1);if(_2>=0){this.screenList.refreshRow(_2);this.screenList.applyHilites()}}
this.updateScreenTitle()},isc.A.getCurrentScreenTitle=function isc_VisualBuilder_getCurrentScreenTitle(){var _1="Untitled screen";if(this.currentScreen&&this.currentScreen.title){_1=this.currentScreen.title;if(_1.endsWith(".xml"))_1=_1.slice(0,-4)}
return _1},isc.A.updateScreenTitle=function isc_VisualBuilder_updateScreenTitle(){if(this.middleStack){var _1=this.getScreenMockupMode(this.currentScreen),_2=(_1&&this.singleScreenMode?"Mockup":this.getCurrentScreenTitle()),_3=(!_1&&!this.singleScreenMode);var _4=this.middleStack.getSectionNumber("applicationSection");if(_3!=this.middleStack.sections[_4].canCollapse&&this.middleStack.isDrawn()){var _5=this.middleStack.getSectionHeader(_4),_6=this.middleStack.sections[_4],_7=_5.controlsLayout.getMembers(),_8=_6.items[0],_9=[];for(var i=_7.length-1;i>=0;i--){_9.addAt(_7[i],0);_5.controlsLayout.removeMember(_7[i])}
_6.items=[];this.middleStack.removeSection(_6);this.middleStack.addSection({title:_2,autoShow:true,ID:"applicationSection",canCollapse:_3,items:[_8],controls:_9},0)}else{this.middleStack.setSectionTitle("applicationSection",_2);this.middleStack.getSections()[0].canCollapse=_3}
this.enableScreenTitleEditing()}
if(this.runButton)this.runButton.setDisabled(!this.$1738())},isc.A.enableScreenTitleEditing=function isc_VisualBuilder_enableScreenTitleEditing(){var _1=this,_2=this.middleStack.getSectionHeader("applicationSection");var _3=isc.isA.SectionHeaderLayout(_2)?_2.titleLabel:_2;if(!this.currentScreen.fileName||this.currentScreen.oldVersionLoaded||this.project.isReadOnly())
{if(_3&&_3.editNode){_3.setEditMode(false,_3.editContext,_3.editNode)}
return}
var _4=_3.editContext,_5=_3.editNode;if(!_4){_4=isc.EditContext.create({rootComponent:{type:"Canvas"},rootLiveObject:isc.Canvas.create({left:-5000,autoDraw:false}),enableInlineEdit:true,editNodeUpdated:function(_5,_4,_16){if(_16.contains("title")){var _6=_1,_7=_6.project,_8=_6.currentScreen.title,_9=_5.defaults.title;if(_8!=_9){if(_9==null||_9==""){_4.setNodeProperties(_5,{title:_8})}else{_7.screenDataSource.getFile({ownerId:_7.getOwnerId(),fileName:_9,fileType:'ui',fileFormat:'xml'},function(_17,_18,_19){if(_17.data&&_17.data.length>0){var _10=_9+" ("+_7.fileName+")";var _11=_17.data[0],_12=_11.lastUsedInProject;if(_12&&_12==_7.fileName){isc.warn("Cannot rename screen: "+_9+" already exists.");_4.setNodeProperties(_5,{title:_8});return}
var _13="You already have screen called \""+_9+"\""+(_12?", last used in project \""+_12+"\"":"")+".<P>Would you like to name your screen \""+_10+"\" instead?";isc.warn(_13,function(_20){if(_20){_7.renameScreenTo(_10);return}
_4.setNodeProperties(_5,{title:_8})},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1});return}
_7.renameScreenTo(_9)})}}}}});var _14={type:"SectionStackSection",liveObject:_3,editProxyProperties:{getOverrideProperties:function(){var _15=this.Super("getOverrideProperties",arguments);isc.addProperties(_15,{prompt:"Double-click to rename screen",hoverStyle:"darkHover",hoverWrap:false,hoverAutoFitWidth:false});return _15}}};_5=_4.makeEditNode(_14)}
_4.enableEditing(_5)});isc.evalBoundary;isc.B.push(isc.A.getScreenMockupMode=function isc_VisualBuilder_getScreenMockupMode(_1){if(!_1)return this.mockupMode;var _2=(_1.mockupMode!=null?_1.mockupMode:this.mockupMode);if(isc.isA.String(_2))_2=(_2=="true");return _2},isc.A.saveScreenAs=function isc_VisualBuilder_saveScreenAs(_1,_2){this.cacheCurrentScreenContents();var _3=this;this.project.saveScreenAs(_1,function(_4){if(_2){_3.fireCallback(_2)}else if(_1==_3.currentScreen){_3.setCurrentScreen(_4)}})},isc.A.revertScreen=function isc_VisualBuilder_revertScreen(_1,_2,_3){if(_1==this.currentScreen)this.cacheCurrentScreenContents();var _4=_1.contents;delete _1.contents;var _5=this;this.project.fetchScreenContents(_1,function(_6){if(_6){if(_1==_5.currentScreen){_5.withoutDirtyTracking(function(){_5.$214s=true;_5.projectComponents.destroyAll();delete _5.$214s});_5.projectComponents.addPaletteNodesFromXML(_6);if(_2!=null&&!_3){isc.Notify.addMessage("You are viewing an older version of this screen. Save to create a new screen and continue design without the changes made in subsequent versions.")}}
_1.oldVersionLoaded=(!_3&&_2!=null);if(_5.savingScreenLabel){if(_5.project.isReadOnly()){_5.savingScreenLabel.setContents("")}else if(_1.oldVersionLoaded){_5.savingScreenLabel.setContents(_2.toShortDateTime())}else{_5.savingScreenLabel.setContents("All changes saved")}}}else{isc.say("Reversion failed.");_1.contents=_4}},_2,_3)},isc.A.loadProjectScreen=function isc_VisualBuilder_loadProjectScreen(_1,_2,_3){this.initialScreen=_2;this.initialVersion=_3;this.loadProject(_1)},isc.A.loadViewFromXML=function isc_VisualBuilder_loadViewFromXML(_1,_2){this.cacheCurrentScreenContents();_1.contents=_2;this.project.setScreenDirty(_1,false);var _3=this;this.withoutDirtyTracking(function(){_3.projectComponents.destroyAll()});var _4=(this.currentScreen?this.currentScreen.mockupMode:null);this.setScreenContents(_1.contents,_4)},isc.A.$2202=function isc_VisualBuilder__exportProjectReadmeForSC(){return"This is an export of a Reify (Reify.com) project intended for use with SmartClient.  If you are instead using\nSmartGWT, please return to Reify and export in SmartGWT format.\n\nPlease read the Reify for Developers overview to understand what to do with this export:\n\n\thttps://www.smartclient.com/smartclient-latest/isomorphic/system/reference/?id=group..reifyForDevelopers\n\nIf all you want to do is see your Reify project running outside of Reify.com, you can just download a standard\nSmartClient SDK from SmartClient.com, start the included Tomcat server, overlay the files from this export\nonto the \"isomorphicSDK\" directory structure, and navigate to the .jsp from this export, which should be\ndirectly in the isomorphicSDK directory if you have overlaid files properly.\n\nThe same approach will work for any existing SmartClient project if you overlay the files onto your webroot,\nassuming that you have not, for whatever reason, disabled the default JSP tags from the SDK, or disabled\nthe ProjectLoader or ScreenLoader servlets that are present by default in web.xml.\n\nRunning in this mode will use the MockDataSources from your Reify project, so reloading the page will drop\nany changes made to data.  To actually deploy your application with persistent storage, those MockDataSources\nwill need to be replaced with real DataSources - the Reify for Developers overview linked above explains\nthis in detail.\n\nEnjoy!\n\n\t- the Reify.com team"},isc.A.$2203=function isc_VisualBuilder__exportProjectReadmeForSGWT(){return"This is an export of a Reify (Reify.com) project intended for use with SmartGWT.  If you are instead using\nSmartClient, please return to Reify and export in SmartClient format.\n\nPlease read the Reify for Developers overview to understand what to do with this export:\n\n\thttps://smartclient.com/smartgwtee-latest/javadoc/com/smartgwt/client/docs/ReifyForDevelopers.html\n\nIf all you want to do is see your Reify project running outside of Reify.com, you can just download a standard\nSmartGWT SDK from SmartClient.com, set up a project, overlay the files from this export onto the \"war\"\nfolder of your GWT project, and navigate to the .html file from this export, which should be right next to\nyour host .html file if you have overlaid files properly.\n\nThe same approach will work for any existing SmartGWT project, assuming that you have not, for whatever\nreason, disabled the ProjectLoader or ScreenLoader servlets that are included in the web.xml file provided\nwith our sample SmartGWT projects.\n\nRunning in this mode will use the MockDataSources from your Reify project, so reloading the page will drop\nany changes made to data.  To actually deploy your application with persistent storage, those MockDataSources\nwill need to be replaced with real DataSources - the Reify for Developers overview linked above explains\nthis in detail.\n\nEnjoy!\n\n\t- the Reify.com team"},isc.A.$191b=function isc_VisualBuilder__exportProjectScreenAsJSP(_1,_2){var _3=this;var _4="Drawing,Analytics,Workflow";if(_2==this.currentScreen)this.cacheCurrentScreenContents();var _5='<%@ page contentType="text/html; charset=UTF-8"%>\n<%@ taglib uri="/WEB-INF/iscTaglib.xml" prefix="isomorphic" %>\n<HTML><HEAD><TITLE>'+_2.title+'</TITLE>\n</HEAD><BODY>\n<SCRIPT>\n<isomorphic:loadISC skin="'+_3.skin+'"'+(_3.modulesDir?' modulesDir="'+_3.modulesDir+'"':"")+(_4?(' includeModules="'+_4+'"'):"")+'/>\n</SCRIPT>\n';for(var i=0;i<_3.globalDependencies.deps.length;i++){var _7=_3.globalDependencies.deps[i];if(_7.type=="js"){_5+='<SCRIPT SRC='+(_7.url.startsWith("/")?_3.webRootRelWorkspace:_3.basePathRelWorkspace+"/")+_7.url+'></SCRIPT>\n'}else if(_7.type=="schema"){_5+='<SCRIPT>\n<isomorphic:loadDS name="'+_7.id+'"/></SCRIPT>\n'}else if(_7.type=="ui"){_5+='<SCRIPT>\n<isomorphic:loadUI name="'+_7.id+'"/></SCRIPT>\n'}else if(_7.type=="css"){_5+='<LINK REL="stylesheet" TYPE="text/css" HREF='+(_7.url.startsWith("/")?_3.webRootRelWorkspace:_3.basePathRelWorkspace+"/")+_7.url+'>\n'}}
var _8;if(_1!=null){var _9=(_2.fileName&&_2.fileName.length>0?_2.title:null);_8='<isomorphic:loadProject name="'+_1+'" '+(_9?'currentScreenName="'+_9+'" ':'')+' />\n'}else{_8='<isomorphic:XML>\n'+_2.contents+'\n</isomorphic:XML>'}
_5+='<SCRIPT>\nisc.Page.setAppImgDir("'+_3.basePathRelWorkspace+'/graphics/");\n'+_8+'</SCRIPT>\n</BODY></HTML>';return _5},isc.A.$189r=function isc_VisualBuilder__exportProjectAsHTML(_1,_2,_3){if(_2==this.currentScreen)this.cacheCurrentScreenContents();var _4=(_2.fileName&&_2.fileName.length>0?_2.title:null);var _5=_3.split('/'),_6=_5.length-1,_7=[];for(var i=0;i<_6;i++){_7.add('..')}
var _9=_7.join("/");if(_9.length>0)_9+="/";var _10='<!DOCTYPE html>\n<HTML><HEAD>\n<META http-equiv="content-type" content="text/html; charset=UTF-8">\n<TITLE>'+_2.title+'</TITLE>\n<SCRIPT>window.isomorphicDir = "isomorphic/"; </SCRIPT>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Core.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Foundation.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Containers.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Grids.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Forms.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_DataBinding.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Calendar.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Drawing.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Analytics.js"></script>\n<script type="text/javascript" src="isomorphic/system/modules/ISC_Workflow.js"></script>\n<SCRIPT SRC="isomorphic/skins/Tahoe/load_skin.js"></SCRIPT>\n</HEAD><BODY>\n<SCRIPT src="isomorphic/projectLoader?projectName='+_1+(_4?'&currentScreenName='+_4:'')+'"></SCRIPT>\n</BODY></HTML>\n';return _10},isc.A.exportScreenAsJSP=function isc_VisualBuilder_exportScreenAsJSP(_1){var _2=this,_3=this.$191b(null,_1);this.addAutoChild("jspFileSource");this.jspFileSource.showSaveFileUI(_3,function(_5,_6,_7){if(!isc.isAn.Array(_6))_6=[_6];var _4=window.location.href;if(_4.indexOf("?")>0)_4=_4.substring(0,_4.indexOf("?"));_4=_4.substring(0,_4.lastIndexOf("/"));_4+=(_4.endsWith("/")?"":"/")+_2.workspaceURL+_6[0].name;isc.say("Your screen can be accessed at:<P><a target=_blank href='"+_4+"'>"+_4+"</a>")})},isc.A.getRecentScreens=function isc_VisualBuilder_getRecentScreens(){if(!this.recentScreens)this.recentScreens=[];return this.recentScreens},isc.A.clearRecentScreens=function isc_VisualBuilder_clearRecentScreens(){this.recentScreens=null},isc.A.updateRecentScreens=function isc_VisualBuilder_updateRecentScreens(){var _1=this.getRecentScreens();var _2=_1.findIndex("screen",this.currentScreen);if(_2!=-1)_1.removeAt(_2);_1.addAt({screenFileName:this.currentScreen.fileName,title:this.getCurrentScreenTitle(),screen:this.currentScreen},0);if(_1.getLength()>this.recentScreensCount){_1.setLength(this.recentScreensCount)}},isc.A.markDirty=function isc_VisualBuilder_markDirty(){if(!this.disableDirtyTracking&&!isc.$75u&&this.project){this.project.setScreenDirty(this.currentScreen,true)}},isc.A.withoutDirtyTracking=function isc_VisualBuilder_withoutDirtyTracking(_1){try{this.disableDirtyTracking+=1;this.fireCallback(_1)}
finally{this.disableDirtyTracking-=1}},isc.A.withoutAutoSaving=function isc_VisualBuilder_withoutAutoSaving(_1){var _2=this.project||{};try{_2.disableAutoSave+=1;this.fireCallback(_1)}
finally{_2.disableAutoSave-=1}},isc.A.previewAreaResized=function isc_VisualBuilder_previewAreaResized(){if(this.rootLiveObject==null)return;var _1=this.rootLiveObject.getVisibleWidth();var _2=this.rootLiveObject.getVisibleHeight();if(this.projectMenu)this.projectMenu.previewAreaResized(_1,_2)},isc.A.getUsersRolesTitleSizes=function isc_VisualBuilder_getUsersRolesTitleSizes(){if(!this.$215n){var _1=this.usersRolesLabel?this.usersRolesLabel.getStateName():"normal",_2=this.getUsersRolesMenuButtonTitle(true,false),_3=this.getUsersRolesMenuButtonTitle(false,true),_4=this.getUsersRolesMenuButtonTitle(false,false);this.$215n=[isc.Canvas.measureContent("<nobr><b>"+_2+"</b></nobr>",_1,false,true),isc.Canvas.measureContent("<nobr><b>"+_3+"</b></nobr>",_1,false,true),isc.Canvas.measureContent("<nobr><b>"+_4+"</b></nobr>",_1,false,true)]}
return this.$215n},isc.A.getUsersRolesMenuButtonTitle=function isc_VisualBuilder_getUsersRolesMenuButtonTitle(_1,_2){if(_1==null&&_2==null){_1=this.shortURTitle;_2=this.mediumURTitle}
var _3=isc.Auth.getCurrentUser(),_4=isc.Auth.isSuperUser(),_5=isc.Auth.getRoles();if(_3==null)return"Users & Roles";else{var _6="";if(_3.firstName)_6+=_3.firstName;if(_3.lastName)_6+=" "+_3.lastName;if(!_1){if(_5&&_5.length>0){_6+=" ("+(_4?isc.Canvas.imgHTML("[SKINIMG]actions/help.png",16,16)+" super-user":_5.join(","))+")"}
if(!_2){_6="Viewing as "+_6}}
return"<i>"+_6+"</i>"}},isc.A.showImportDialog=function isc_VisualBuilder_showImportDialog(_1){if(!this.$482){this.$482=isc.LoadFileDialog.create({actionStripControls:["spacer:10","pathLabel","previousFolderButton","spacer:10","upOneLevelButton","spacer:10","refreshButton","spacer:2"],directoryListingProperties:{canEdit:false},title:"Import File",rootDir:"/",initialDir:"[VBWORKSPACE]",webrootOnly:false,loadFile:function(_4){if(_4.match(/\.(xml|js)$/i)==null){isc.say("Only JS or XML files may be imported (must end with .js or .xml");return}
var _2=this;isc.DMI.callBuiltin({methodName:"loadFile",arguments:[this.currentDir+"/"+_4],callback:function(_5){if(_4.match(/\.xml$/i)!=null){isc.DMI.callBuiltin({methodName:"xmlToJS",arguments:_5.data,callback:function(_5){_2.fileLoaded(_5.data)}})}else{_2.fileLoaded(_5.data)}}})},fileLoaded:function(_4){var _3=_1.creator.project.addScreen(null,null,"Imported Screen");_1.creator.setCurrentScreen(_3);_1.creator.projectComponents.destroyAll();_1.creator.projectComponents.addPaletteNodesFromJS(_4);this.hide()}})}else{this.$482.directoryListing.data.invalidateCache()}
this.$482.show()},isc.A.showNewDataSourceDialog=function isc_VisualBuilder_showNewDataSourceDialog(_1){var _2=this;var _3=isc.Label.create({width:"100%",height:30,contents:"How do you want to create your DataSource?"});var _4=_1.map(function(_9){return _9.title});var _5=isc.DynamicForm.create({width:"100%",height:"*",numCols:1,items:[{name:"wizard",showTitle:false,type:"radioGroup",width:"*",wrap:false,defaultValue:_4[0],valueMap:_4}]});var _6=isc.IButton.create({autoDraw:false,title:"Cancel",width:75,click:function(){this.topElement.closeClick()}});var _7=isc.IButton.create({autoDraw:false,title:"OK",width:75,click:function(){var _8=_5.getValue("wizard"),_9=_1.find("title",_8),_10=_9.wizardRecord;_2.showDSWizard(_10);this.topElement.closeClick()}});var _11=isc.HLayout.create({autoDraw:false,height:30,membersMargin:10});_11.addMembers([isc.LayoutSpacer.create(),_6,_7]);var _12=isc.VLayout.create({width:"100%",height:"100%",padding:10,membersMargin:10,members:[_3,_5,_11]});var _13=isc.TWindow.create({title:"Create new DataSource",width:300,height:225,isModal:true,showModalMask:true,autoCenter:true,items:[_12]});_13.show()},isc.A.showScreenSourceCode=function isc_VisualBuilder_showScreenSourceCode(){var _1=this.codeWindow,_2=this.currentScreen;if(_2)this.$210g("viewScreenCode",_2.title);var _3=this.getScreenMockupMode(_2),_4=(this.showXmlScreenCode!=false),_5=(this.showJsScreenCode!=false&&!_3);if(_1&&!_1.destroyed){if((_4&&!this.codePreview)||(_5&&!this.jsCodePreview)){_1.destroy();_1=null}}
if(_1==null||_1.destroyed){if(_4)this.codePreview=this.createAutoChild("codePreview");if(_5)this.jsCodePreview=this.createAutoChild("jsCodePreview");if(_4&&_5){this.codePane=this.createAutoChild("codePane");this.codePane.addTab({title:"XML Code",pane:this.codePreview,width:150,click:this.getID()+".updateSource();"});this.codePane.addTab({title:"JS Code",pane:this.jsCodePreview,width:150,click:this.getID()+".updateSource();"})}
var _6=(_4&&_5?this.codePane:(_4?this.codePreview:this.jsCodePreview)),_7=(!_3&&this.allowScreenCodeEditing);_1=this.codeWindow=this.createAutoChild("codeWindow",{codePane:_6,canSaveChanges:_7});_1.addItems([_6])}
this.updateSource();_1.animateShow()},isc.A.updateSource=function isc_VisualBuilder_updateSource(){var _1=this.getUpdatedSource();if(!_1)return;var _2=new RegExp("(\\r\\n|[\\r\\n])","g");_1=_1.replace(_2,"\n");if(this.codePreview){this.codePreview.setValues({codeField:_1})}
if(this.jsCodePreview&&(!this.codePane||(this.codePane.isDrawn()&&this.codePane.getSelectedTab().pane==this.jsCodePreview)))
{isc.xml.toJSCode(_1,this.getID()+".jsCodePreview.setContents(data)")}},isc.A.showMultiActionWindow=function isc_VisualBuilder_showMultiActionWindow(_1){var _2=this.multiActionWindow;if(_2==null||_2.destroyed){_2=this.multiActionWindow=this.createAutoChild("multiActionWindow")}
_2.setTitle(_1.sourceComponent.ID+" "+_1.sourceMethod+"() Actions");var _3=this.multiActionPanel;if(_3==null||_3.destroyed){_3=this.multiActionPanel=this.createAutoChild("multiActionPanel",{builder:this,cancelClick:function(){this.builder.multiActionWindow.hide()}});if(_2.items!=null)_2.removeItems(_2.items);_2.addItems([_3])}
_3.configureFor(_1);_3.saveClick=function(_5){this.builder.multiActionWindow.hide();_1.bindingComplete(_5)};var _4=this;_3.getActionTitle=function(_5,_6,_7){return _4.getActionTitle(_5,_6,_7)};_2.show()},isc.A.filterComponentAttributeEditor=function isc_VisualBuilder_filterComponentAttributeEditor(_1){if(_1)_1=_1.toLowerCase();if(_1==this.$215u)return;var _2=this.getCurrentComponent();if(!_2)return;if(_1==null||_1==""){this.clearComponentAttributeFilter(_2)}else{if(this.componentAttributeEditor.$694){this.toggleBasicMode(_2);this.$215w=true}
this.$215u=_1}
this.$215v(_2,_2.liveObject)},isc.A.clearComponentAttributeFilter=function isc_VisualBuilder_clearComponentAttributeFilter(_1){if(this.componentAttributeEditorFilter){this.componentAttributeEditorFilter.clearValue("filter")}
delete this.$215u;if(this.$215w){this.toggleBasicMode(_1);delete this.$215w}},isc.A.manageDeployment=function isc_VisualBuilder_manageDeployment(_1){var _2=this.deploymentConsoleURL;window.open(isc.RPC.addParamsToURL(_2,{id:_1.id}))},isc.A.loadBMMLMockup=function isc_VisualBuilder_loadBMMLMockup(_1,_2,_3,_4,_5,_6,_7,_8){isc.showPrompt("Importing mockup... ${loadingImage}");var _9=this,_10=function(_31,_32,_33,_27,_28){var _11=_1.substring(0,_1.lastIndexOf("/")),_12=(_11=="[READ_ONLY]"?"[VBWORKSPACE]":_11);var _13=isc.MockupImporter.create({dropMarkup:_4==null?true:_4,trimSpace:_5==null?true:_5,fillSpace:_6==null?true:_6,mockupPath:_1,assetPath:_12,fieldNamingConvention:_7});_13[_32](_31,function(_34,_35,_36){if(_34){_9.createNewScreen(function(_37){_9.projectComponents.destroyAll();var _14=[];for(var i=0;i<_35.length;i++){var l=_35[i],_17=l.ID||l.autoID;if(l._constructor!="ValuesManager"&&l._constructor!="MockDataSource"&&l.autoDraw==null)
{_14.add(_17)}}
var _18=_9.libraryComponents.getPrefixAsId(_37.title);_34+=isc.MockupImporter.getDataViewXml(_14,_18,true);_9.projectComponents.getPaletteNodesFromXML(_34,function(_38){for(var i=0;i<_38.length;i++){var _19=_38[i];if(_19.autoDraw!==false&&_19.component&&_19.component.defaults){delete _19.component.defaults.autoDraw}}
var _20=_9.projectComponents.getEditContext();_20.reassignIDs=true;_9.projectComponents.addFromPaletteNodes(_38);_20.reassignIDs=false;if(_8){var _21=_20.getEditNodeArray();if(_21)_21.map(function(_19){if(_19.isLoaded&&_19.liveObject&&isc.isA.DataSource(_19.liveObject)){var _22=_19.liveObject;if(isc.isA.MockDataSource(_22)){_19.referenceInProject=true;var _23="MockDataSource";_9.project.addDatasource(_22.name,_23);var _24=_20.makeDSPaletteNode(_22.name,_23);_9.saveDSToFile(_22.name,_24)}}})}
_9.addCurrentScreenMockDataSourcesToList();isc.clearPrompt()})},_33)}else{isc.clearPrompt()}},_27,_28)};if(_1.match(/^https?:\/\//,"i")){isc.RPCManager.sendRequest({useHttpProxy:true,actionURL:_1,callback:function(_32){_10(_32.data,"bmmlToXml","Imported BMML")}})}else{if(_2){var _22=isc.DS.get("BMPRReader");_22.fetchData({ID:_2,recordType:"resource",branchId:"Master"},function(_32){if(_32.status<0){isc.clearPrompt();isc.RPC.runDefaultErrorHandling(_32);return}
var _25=_32.data,_26,_27,_28;for(var i=0;i<_25.length;i++){var _29=_25[i],_30=_29.attributes,_31=_29.data;if(_30.kind=="mockup"){_26=_31}else if(_30.kind=="symbolLibrary"){if(!_27)_27=[];_27.add(_29)}else if(_30.kind=="asset"){if(!_28)_28=[];_28.add(_29)}}
if(_26){_10(_26,"bmmlJsToXml","Imported BMPR",_27,_28)}},{willHandleError:true})}else if(_3!=null){_10(_3,"bmmlToXml","Imported BMML")}else{isc.DMI.callBuiltin({methodName:"loadFile",arguments:[_1],callback:function(_32){_10(_32.data,"bmmlToXml","Imported BMML")}})}}},isc.A.getServiceElementIcon=function isc_VisualBuilder_getServiceElementIcon(_1){var _2=_1.serviceType;if(_2=="service"||_2=="categoryProject")return"service.png";else if(_2=="portType")return"portType.png";else if(_2=="operation")return"operation.png";else if(_2=="message_in")return"email_in.png";else if(_2=="message_out")return"email_out.png";else if(_2=="simpleType")return"page_single.png";else if(_2=="complexType")return"page_multiple.png";return null},isc.A.notifyIDOrFieldNameChange=function isc_VisualBuilder_notifyIDOrFieldNameChange(_1,_2,_3,_4){this.updateAllComponentEventReferences(_1,_2,_3,_4);var _5=(isc.isA.ListGrid(_1)?"selectedRecord":"values"),_6=[];if(_2=="ID"){_6[_6.length]={pattern:new RegExp("^"+_3+"\\."+_5),replacement:_4+"."+_5}}else{var _7=_1.ID+"."+_5+"."+_4;_6[_6.length]={pattern:new RegExp(_1.ID+"\\."+_5+"\\."+_3),replacement:_7};if(_1.dataSource){var _8=(isc.isA.DataSource(_1.dataSource)?_1.dataSource:isc.DS.get(_1.dataSource)),_9=_8.ID;if(_8.getField(_3)){_6[_6.length]={pattern:new RegExp(_9+"\\."+_3),replacement:(_8.getField(_4)?_9+"."+_4:_7)}}}}
if(isc.isA.FormItem(_1))_1=_1.form;if(_1.getRuleScopeDataBoundComponents){var _10=_1.getRuleScopeDataBoundComponents();for(var i=0;i<_10.length;i++){this.updateComponentRuleScopeProperties(_10[i],_6)}}},isc.A.updateAllComponentEventReferences=function isc_VisualBuilder_updateAllComponentEventReferences(_1,_2,_3,_4){if(!isc.jsdoc.hasData())return false;var _5=this.projectComponents.editContext.getEditNodeArray();for(var i=0;i<_5.length;i++){var _7=_5[i];var _8=_7.defaults,_9=_7.liveObject,_10=(_9.getClassName?_9.getClassName():_9._constructor),_11={};for(var _12 in _8){var _13=_8[_12];if(_13==null||_13=="")continue;if(isc.isA.StringMethod(_13)&&_13.value)_13=_13.value;var _14=isc.VisualBuilder.getEventDefinition(_10,_12);if(_14){var _15=false;{if(isc.isAn.Array(_13)){for(var j=0;j<_13.length;j++){var _17=_13[j];if(_17.target==_3){_17.target=_4;_15=true}}}else if(isc.isA.StringMethod(_13)){var _17=_13.value;if(_17.target==_3){_17.target=_4;_15=true}}else{var _17=_13;if(_17.target==_3){_17.target=_4;_15=true}}}
if(_15)_11[_12]=_13}}
if(!isc.isAn.emptyObject(_11)){this.projectComponents.setNodeProperties(_7,_11)}}},isc.A.updateComponentRuleScopeProperties=function isc_VisualBuilder_updateComponentRuleScopeProperties(_1,_2,_3,_4){var _5=isc.DS.getNearestSchema(_4||_1.getClassName());var _6=this.$1752(_5);if(_6){var _7=this.projectComponents.getEditContext(),_8=_7.getEditNodeArray().find("liveObject",_1);if(!_8)return;for(var i=0;i<_6.length;i++){var _10=_6[i];var _11=isc.jsdoc.getAllGroupsForAttribute(_5.ID,_10);if(_11!=null&&(_11.contains("dynamicCriteria")||_11.contains("ruleCriteria"))){var _12=_8.defaults[_10];if(_12){if(_3&&_3.length>0&&this.$1753(_12,_3)){this.projectComponents.removeNodeProperties(_8,_10)}else if(_2&&_2.length>0&&this.$1754(_12,_2)){var _13={};_13[_10]=_12;this.projectComponents.setNodeProperties(_8,_13)}}}
var _14=_5.getField(_10);if(_14&&(_14.type=="UserFormula"||_14.type=="UserSummary")&&(_14.useRuleScope==true||_14.useRuleScope=="true")){var _15=_8.defaults[_10];if(_15&&_15.text){if(_3&&_3.length>0&&this.$176t(_15,_3)){this.projectComponents.removeNodeProperties(_8,_10)}else if(_2&&_2.length>0&&this.$176u(_15,_2)){var _13={};_13[_10]=_15;this.projectComponents.setNodeProperties(_8,_13)}}}}}
if(isc.isA.DynamicForm(_1)){var _16=_1.items;for(var i=0;i<_16.length;i++){this.updateComponentRuleScopeProperties(_16[i],_2,_3)}}
if(isc.isA.ListGrid(_1)){var _17=_1.getAllFields();for(var i=0;i<_17.length;i++){this.updateComponentRuleScopeProperties(_17[i],_2,_3,"ListGridField")}}},isc.A.$1752=function isc_VisualBuilder__getTypeFieldnames(_1){var _2;if(_1&&_1.fields){_2=this.$1751[_1.ID];if(!_2){_2=(isc.isAn.Array(_1.fields)?_1.fields.getProperty("name"):isc.getKeys(_1.fields));var _3=isc.ClassFactory.getClass(_1.ID);if(_3){var _4=_3.getSuperClass();if(_4){var _5=isc.DS.getNearestSchema(_4.getClassName()),_6=this.$1752(_5);if(_6){_2.addList(_6)}}}
this.$1751[_1.ID]=_2}}
return _2},isc.A.$1754=function isc_VisualBuilder__replaceCriteriaValuePaths(_1,_2){var _3=_1.operator,_4=false;if(_3=="and"||_3=="or"){var _5=_1.criteria;for(var i=0;i<_5.length;i++){if(this.$1754(_5[i],_2)){_4=true}}}else{for(var i=0;i<_2.length;i++){var _7=_2[i];if(_1.valuePath!=null){var _8=_1.valuePath.replace(_7.pattern,_7.replacement);if(_1.valuePath!=_8){_1.valuePath=_8;_4=true}}
if(_1.fieldName!=null){var _9=_1.fieldName.replace(_7.pattern,_7.replacement);if(_1.fieldName!=_9){_1.fieldName=_9;_4=true}}}}
return _4},isc.A.$1753=function isc_VisualBuilder__criteriaHasMatchingValuePath(_1,_2){var _3=_1.operator;if(_3=="and"||_3=="or"){var _4=_1.criteria;for(var i=0;i<_4.length;i++){if(this.$1753(_4[i],_2)){return true}}}else{for(var i=0;i<_2.length;i++){var _6=_2[i];if((_1.valuePath!=null&&_1.valuePath.match(_6))||(_1.fieldName!=null&&_1.fieldName.match(_6)))
{return true}}}
return false},isc.A.$176u=function isc_VisualBuilder__replaceFormulaVariables(_1,_2){if(!_1.text)return false;var _3=false;for(var i=0;i<_2.length;i++){var _5=_2[i];var _6=_1.text.replace(_5.pattern,_5.replacement);if(_1.text!=_6){_1.text=_6;_3=true}}
return _3},isc.A.$176t=function isc_VisualBuilder__formulaHasVariable(_1,_2){if(!_1.text)return false;for(var i=0;i<_2.length;i++){var _4=_2[i];if(_1.text.match(_4))return true}
return false},isc.A.keyPress=function isc_VisualBuilder_keyPress(){if(isc.EH.getKey()=="Delete"||isc.EH.getKey()=="Backspace"){if(!this.editingOn)return;var _1=isc.SelectionOutline.getSelectedObject();if(_1&&_1.editContext){var _2=_1.editNode;if(_2&&_2._canRemove===false){return}
var _3=this.projectComponents;var _4=this;this.confirmComponentDelete(_2,function(_6){var _5=_3.data.getParent(_2);if(_5){isc.EditContext.selectCanvasOrFormItem(_5.liveObject)}
_1.editContext.destroyNode(_2)});return false}}},isc.A.confirmComponentDelete=function isc_VisualBuilder_confirmComponentDelete(_1,_2){var _3=this.projectComponents;var _4=function(_10,_11,_8,_12){var _5=_3.getField(_12);if(_5.formatCellValue){_10=_5.formatCellValue(_10,_11,_8,_12,_3)}else{_10=_3.formatCellValue(_10,_11,_8,_12)}
return _10};var _6=_1.ID,_7=_1.type;var _8=this.projectComponents.getRecordIndex(_1);if(_8>=0){_6=_4(_6,_1,_8,_3.getFieldNum("ID"));_7=_4(_7,_1,_8,_3.getFieldNum("type"))}
var _9=_6+" ["+_7+"]";isc.ask("Do you want to delete "+_9+"?",function(_10){if(_10)_2(_8)},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1})},isc.A.destroy=function isc_VisualBuilder_destroy(){this.setProject(null);this.ignore(this.projectComponents,"editNodeUpdated");this.Super("destroy",arguments)},isc.A.init=function isc_VisualBuilder_init(){this.mockupsMenuDefaults={_constructor:"Menu",title:"Mockups",width:60,getSubmenu:function(_30){_30=this.getItem(_30);if(_30.title=="Switch Mockup"&&_30.submenu.length==0){var _1=this.creator,_2=this,_3=_1.project.screens.getAllNodes(),_4=function(_71,_30,_72){if(_30.record==_1.currentScreen)return;_2.confirmSaveMockup(function(){_1.setCurrentScreen(_30.record)})},_5=function(_71,_72,_30){return(_30.record==_1.currentScreen)},_6=[];for(var i=0;i<_3.length;i++){var _8=_3[i];if(_8.mockupMode){_6.add({title:_8.title,record:_8,checkIf:_5,click:_4})}}
_30.submenu=_6}else if(_30.title=="Switch Project"&&_30.submenu.length==0){var _1=this.creator,_2=this,_9=_1.getRecentProjects(),_4=function(_71,_30,_72){var _10=_30.record;if(_10.projectFileName==_1.project.fileName)return;_2.confirmSaveProject(function(){_1.loadProject(_30.record.projectFileName,_30.record.projectOwnerId)})},_5=function(_71,_72,_30){return(_30.record.projectFileName==_1.project.fileName)},_6=[];for(var i=0;i<_9.length;i++){var _10=_9[i];_6.add({title:_10.title,record:_10,checkIf:_5,click:_4})}
_30.submenu=_6}
return this.Super("getSubmenu",arguments)},confirmSaveMockup:function(_71){var _1=this.creator;if(_1.currentScreen&&_1.currentScreen.dirty){isc.confirm("Save current screen?",function(_72){if(_72==true){_1.saveScreenAs(_1.currentScreen,_71)}else if(_72==false){_1.fireCallback(_71)}},{buttons:[isc.Dialog.CANCEL,isc.Dialog.NO,isc.Dialog.YES],autoFocusButton:2})}else{this.fireCallback(_71)}},confirmSaveProject:function(_71){var _1=this.creator;if(!_1.project||_1.project.isEmpty()||_1.getProjectFileName()){this.fireCallback(_71)}else{var _11=this;isc.confirm("Save current project?",function(_72){if(_72==true){_1.project.save(_71)}else if(_72==false){_11.fireCallback(_71)}},{buttons:[isc.Dialog.CANCEL,isc.Dialog.NO,isc.Dialog.YES],autoFocusButton:2})}},data:[{title:"Clear Mockup",icon:"actions/revertScreen.png",click:function(_71,_30,_72){var _1=_72.creator;_1.projectComponents.destroyAll()}},{isSeparator:true},{title:"Switch Mockup",icon:"actions/switchScreen.png",enableIf:function(_71,_72,_30){var _1=_72.creator,_3=_1.project.screens.getAllNodes();var _12=0;for(var i=0;i<_3.length;i++){if(_3[i].mockupMode){if(++_12>1)break}}
return _12>1},submenu:[]},{isSeparator:true},{title:"Save",icon:"actions/saveScreen.png",dynamicTitle:function(_71,_72,_30){return"Save '"+_72.creator.getCurrentScreenTitle()+"'"},enableIf:function(_71,_72,_30){return _72.creator.currentScreen.fileName},click:function(_71,_30,_72){var _1=_72.creator;_1.cacheCurrentScreenContents();_1.project.saveScreenContents(_1.currentScreen)}},{title:"Save mockup as ...",icon:"actions/saveScreenAs.png",click:function(_71,_30,_72){var _1=_72.creator;_1.saveScreenAs(_1.currentScreen)}},{isSeparator:true},{title:"Switch Project",icon:"actions/recentProjects.png",submenu:[]}]};if(this.showXmlScreenCode!=false||this.showJsScreenCode!=false){this.mockupsMenuDefaults.data.add({isSeparator:true});this.mockupsMenuDefaults.data.add({title:"Show code for screen",icon:"actions/showScreenCode.png",click:function(_71,_30,_72){_72.creator.showScreenSourceCode()}})}
var _13=["New screen","Import from Balsamiq","Copy an existing screen","Load a shared screen","Switch screen","Skin","Resolution","Rename screen","Save screen","Save screen as ...","View recent version","Remove from project","Delete screen","Show code for screen"];var _14=["New screen","Import from Balsamiq","Copy an existing screen","Load a shared screen","Switch screen","Skin","Resolution","Rename screen","Save screen","Save screen as ...","View recent version","Revert","Remove from project","Delete screen","Show code for screen"];var _15=[{title:"New screen",icon:"actions/newScreen.png",enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){var _1=_72.creator;_1.confirmSaveScreen(function(){_1.createNewScreen()})}},{title:"Import screen",enabled:this.filesystemDataSourceEnabled,enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.confirmSaveScreen(function(){var _16="../../isomorphic/system/reference/SmartClient_Reference.html#group..visualBuilder";isc.ask("This feature allows you to import externally edited XML or JS code. The Visual Builder cannot fully capture all externally edited files. For more information, see the <a target=_blank href='"+_16+"'>Visual Builder Docs</a><br><br>Proceed with Import?",function(_73){if(_73)_72.creator.showImportDialog(_72)})})}},{title:"Import from Balsamiq",icon:"actions/importScreen.png",enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.confirmSaveScreen(function(){isc.BMMLImportDialog.create({isModal:true,showFileNameField:_72.creator.loadFileBuiltinIsEnabled,showAssetsNameField:_72.creator.saveFileBuiltinIsEnabled,showOutputField:_72.creator.saveFileBuiltinIsEnabled,showSkinSelector:false,submit:function(_73,_74,_75,_76,_77,_78,_79,_80,_81){_72.creator.loadBMMLMockup(_73,_74,_76,_78,_79,_80,_81,true);this.markForDestroy()}})})}},{title:"Copy an existing screen",icon:"actions/copyScreen.png",enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.confirmSaveScreen(function(){_72.creator.showCopyExistingScreenUI()})}},{title:"Load a shared screen",icon:"actions/loadSharedScreen.png",enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.confirmSaveScreen(function(){_72.creator.showLoadSharedScreenUI()})}},{title:"Recent screens",submenu:[]},{title:"Switch screen",icon:"actions/switchScreen.png",enableIf:function(_71,_72,_30){var _1=_72.creator,_3=_1.project.screens.getAllNodes();return _3.length>1},submenu:[]},{isSeparator:true},{title:"Rename screen",icon:"actions/renameScreen.png",enableIf:function(_71,_72,_30){return(_72.creator.currentScreen.fileName&&!_72.creator.currentScreen.oldVersionLoaded&&!_72.creator.project.isReadOnly())},click:function(_71,_30,_72){_72.creator.cacheCurrentScreenContents();_72.creator.project.renameCurrentScreen()}},{title:"Save screen",icon:"actions/saveScreen.png",dynamicTitle:function(_71,_72,_30){return"Save '"+_72.creator.getCurrentScreenTitle()+"'"},enableIf:function(_71,_72,_30){return _72.creator.currentScreen.fileName&&!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){var _17=new Date();_72.creator.cacheCurrentScreenContents();var _18;if(_72.creator.addScreenSaveReasonFromUndoLog){var _19=_72.creator.currentScreen.lastSave;if(_19!=null){if(isc.isA.String(_19))_19=new Date(_19);_18=_72.creator.projectComponents.editContext.getCombinedUndoLogDescriptions(_19.getTime())}}
_72.creator.project.setScreenProperties(_72.creator.currentScreen,{lastSave:_17,lastExplicitSave:_17});_72.creator.project.saveScreenContents(_72.creator.currentScreen,null,null,_18)}},{title:"Save screen as ...",icon:"actions/saveScreenAs.png",enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.saveScreenAs(_72.creator.currentScreen)}},{title:"Export as JSP",enabled:this.filesystemDataSourceEnabled,click:function(_71,_30,_72){_72.creator.exportScreenAsJSP(_72.creator.currentScreen)}},{isSeparator:true},{title:"View recent version",icon:"actions/recentScreenVersions.png",submenu:[]},{title:"Revert",icon:"actions/revertScreen.png",dynamicTitle:function(_71,_72,_30){return"Revert"},enableIf:function(_71,_72,_30){return _72.creator.currentScreen.fileName&&!_72.creator.project.isReadOnly()},submenu:[]},{isSeparator:true},{title:"Remove from project",icon:"actions/removeScreen.png",removeInSingleScreenMode:true,enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.project.removeScreen(_72.creator.currentScreen,true)}},{title:"Delete screen",icon:"actions/deleteScreen.png",dynamicTitle:function(_71,_72,_30){return"Delete '"+_72.creator.getCurrentScreenTitle()+"'"},enableIf:function(_71,_72,_30){return _72.creator.currentScreen.fileName&&!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){var _20="Delete screen '"+_72.creator.currentScreen.title+"' from server? This operation cannot be undone.";isc.confirm(_20,function(_73){if(_73)_72.creator.deleteScreen(_72.creator.currentScreen)},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1})}}];var _21=(this.hostedMode?_14:_13),_22=[];for(var j=0;j<_15.length;j++){var _24=_15[j];if(_24.isSeparator||_21.contains(_24.title)){_22.add(_24)}}
if((this.showXmlScreenCode!=false||this.showJsScreenCode!=false)&&_21.contains("Show code for screen"))
{_22.add({isSeparator:true});_22.add({title:"Show code for screen",icon:"actions/showScreenCode.png",click:function(_71,_30,_72){_72.creator.showScreenSourceCode()}})}
this.screenMenuDefaults={_constructor:"Menu",title:"Screen",width:60,draw:function(){this.Super("draw",arguments);this.refreshRecentVersions()},getSubmenu:function(_30){var _25;_30=this.getItem(_30);if(_30.title=="Recent screens"){var _1=this.creator,_3=_1.getRecentScreens(),_4=function(_71,_30,_72){if(_30.record==_1.currentScreen)return;_1.setCurrentScreen(_30.record)},_5=function(_71,_72,_30){return(_30.record==_1.currentScreen)},_6=[];for(var i=0;i<_3.length;i++){var _8=_3[i];_6.add({title:_8.title,record:_8.screen,checkIf:_5,click:_4})}
if(_30.submenu&&_30.submenu.length>0){_25=this.Super("getSubmenu",arguments)}
if(_25)_25.setData(_6);else _30.submenu=_6}else if(_30.title=="Switch screen"){var _1=this.creator,_3=_1.project.screens.getAllNodes(),_4=function(_71,_30,_72){var _73=_30.record,_74=_1.currentScreen;if(_73==_74)return;_1.$210g("switchScreen",_73.title,_74.title);_1.setCurrentScreen(_73)},_6=[];_3=_3.sortByProperty("lastSave",false,function(_30,_71,_72){var _26=_30[_71];return(isc.isA.String(_26)?new Date(_26):_26)});for(var i=0;i<_3.length;i++){var _8=_3[i];if(_8==_1.currentScreen)continue;_6.add({title:_8.title,record:_8,click:_4})}
if(_30.submenu&&_30.submenu.length>0){_25=this.Super("getSubmenu",arguments)}
if(_25)_25.setData(_6);else _30.submenu=_6}else if(_30.title=="View recent version"){if(_30.submenu&&_30.submenu.length>0){_25=this.Super("getSubmenu",arguments)}
this.refreshRecentVersions(_25)}else if(_30.title.startsWith("Revert")){if(_30.submenu&&_30.submenu.length>0){_25=this.Super("getSubmenu",arguments)}
this.refreshRevertVersions(_30,_25)}
if(!_25){_25=this.Super("getSubmenu",arguments);if(_25)_25.emptyMessage="[No entries]"}
return _25},refreshRecentVersions:function(_25){var _27,_1=this.creator,_28=_1.showRecentVersions;if(!_28)return;var _29=this.data,_30=_29.find("title","View recent version");if(!_30)return;var _31=_1.currentScreen,_22=_31.versions||[],_32=(_25?_25.data:_30.submenu),_6=[],_33=_22.map(function(_71){return _71.id}).max(),_34=function(){var _35=this.id==_33?_27:this.version;_1.revertScreen(_31,_35);_1.$210g("loadRecentVersion",_1.getCurrentScreenTitle(),_35)};for(var i=0,_36=_22.getLength();i<_36;i++){var _19=_22[i].fileLastModified,_18=_22[i].saveReason,_37=(!_31.oldVersionLoaded?i==0:isc.DateUtil.compareDates(_31.lastLoadVersion,_19)==0);if(isc.isA.String(_19))_19=new Date(_19);var _38=(i==_36-1?"Initial version":(_22[i].fileAutoSaved?"Auto saved ":"Manually saved ")+isc.VisualBuilder.timeSince(_19));_6.add({id:_22[i].id,version:_19,checked:_37,title:_38,saveReason:_18,click:_34})}
if(_32&&_32.length==_6.length)return;if(_25){_25.setData(_6);_25.autoFitData=(_6?"vertical":null);_25.overflow=(_6?"hidden":"visible");_25.bodyOverflow=(_6?"auto":"visible")}else{_30.submenu=isc.Menu.create({ID:"recentMenu",width:425,overflow:(_6?"hidden":"visible"),bodyOverflow:(_6?"auto":"visible"),autoFitData:(_6?"vertical":null),height:(_6?null:50),fixedFieldWidths:true,fixedRecordHeights:true,fields:[{name:"icon",width:25,getCellValue:function(_71,_30){return _71.getIcon(_30)},showIf:function(_71,_72,_73){return _71.shouldShowIconField()}},{name:"title",width:173,baseStyle:"menuTitleField",showHover:true,hoverWidth:400,hoverStyle:"darkHover",hoverHTML:function(_71,_26,_72,_73,_74){if(!_74.cellValueIsClipped(_72,_73))return null;return _26}},{name:"saveReason",width:200,baseStyle:"menuTitleField",showHover:true,hoverWidth:400,hoverStyle:"darkHover",hoverHTML:function(_71,_26,_72,_73,_74){if(!_74.cellValueIsClipped(_72,_73))return null;return _26}}],items:_6})}},refreshRevertVersions:function(_30,_25){var _27,_1=this.creator,_28=_1.showRecentVersions;if(!_28)return;var _22=_1.currentScreen.versions||[],_6=[],_33=_22.map(function(_71){return _71.id}).max(),_39=function(){var _30=this;isc.confirm("Revert screen to selected version?",function(_71){if(_71){var _35=_30.id==_33?_27:_30.version;_1.revertScreen(_1.currentScreen,_35,true);_1.$210g("revert",_1.getCurrentScreenTitle(),_1.getProjectDisplayName())}},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1})};var _40,_41,_42=_1.maxAutoSavesInRevertMenu,_43=[],_44=false;for(var i=0;i<_22.getLength();i++){if(_40==null&&!_22[i].fileAutoSaved){_40=_22[i].fileLastModified;if(isc.isA.String(_40))_40=new Date(_40);_41=_22[i]}else if(_43.length<_42&&_22[i].fileAutoSaved){if(!_44){_44=true;continue}
var _8=isc.shallowClone(_22[i]);if(isc.isA.String(_8.fileLastModified)){_8.fileLastModified=new Date(_8.fileLastModified)}
_43.add(_8)}}
if(_43.length>0){for(var i=0;i<_43.length;i++){var _8=_43[i],_38=(i==_43.length-1?"Initial version":"Auto saved "+isc.VisualBuilder.timeSince(_8.fileLastModified));_6.add({id:_8.id,version:_8.fileLastModified,title:_38,saveReason:_8.saveReason,click:_39})}}
if(_40||_45){_6.add({isSeparator:true});if(_40){var _38="Last manual save "+isc.VisualBuilder.timeSince(_40);_6.add({icon:"actions/saveScreen.png",id:_41.id,version:_41.fileLastModified,title:_38,saveReason:_41.saveReason,click:_39})}
var _45=_1.currentScreen.lastLoad,_46=_1.currentScreen;if(_45){var _38="Last loaded "+isc.VisualBuilder.timeSince(_45);_6.add({icon:"actions/loadSharedScreen.png",id:_33,title:_38,saveReason:_46.saveReason,click:_39})}}
if(_6.length==0)_6=null;if(_25){_25.setData(_6);_25.autoFitData=(_6?"vertical":null);_25.overflow=(_6?"hidden":"visible");_25.bodyOverflow=(_6?"auto":"visible")}else{_30.submenu=isc.Menu.create({ID:"revertMenu",width:400,overflow:(_6?"hidden":"visible"),bodyOverflow:(_6?"auto":"visible"),autoFitData:(_6?"vertical":null),height:(_6?null:50),fixedFieldWidths:true,fixedRecordHeights:true,fields:[{name:"icon",width:25,getCellValue:function(_71,_30){return _71.getIcon(_30)},showIf:function(_71,_72,_73){return _71.shouldShowIconField()}},{name:"title",width:173,baseStyle:"menuTitleField",showHover:true,hoverWidth:400,hoverStyle:"darkHover",hoverHTML:function(_71,_26,_72,_73,_74){if(!_74.cellValueIsClipped(_72,_73))return null;return _26}},{name:"saveReason",width:200,baseStyle:"menuTitleField",showHover:true,hoverWidth:400,hoverStyle:"darkHover",hoverHTML:function(_71,_26,_72,_73,_74){if(!_74.cellValueIsClipped(_72,_73))return null;return _26}}],items:_6})}},data:_22};if(this.singleScreenMode){var _47=this.screenMenuDefaults.data;_47.removeList(_47.findAll("removeInSingleScreenMode",true))}
var _48=[{title:"New project",icon:"actions/newProject.png",click:function(_71,_30,_72){_72.creator.confirmSaveProject("this.makeNewProject()")}},{title:"Open project",icon:"actions/loadProject.png",click:function(_71,_30,_72){_72.creator.confirmSaveProject("this.showLoadProjectUI();")}},{isSeparator:true},{title:"Recent projects",icon:"actions/recentProjects.png",enableIf:function(_71,_72,_30){if(!_30.submenu)_30.submenu=_72.creator.recentProjectsMenu;return _30.submenu&&_30.submenu.data.getLength()>0}},{isSeparator:true},{title:"Rename project",icon:"actions/renameProject.png",enableIf:function(_71,_72,_30){return _72.creator.project.fileName&&!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){var _1=_72.creator,_49=_72.creator.project.fileName;_1.project.rename(function(){_1.removeRecentProject(_49)})}},{title:"Save project",icon:"actions/saveProject.png",enableIf:function(_71,_72,_30){return _72.creator.project.fileName&&!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.project.save()}},{title:"Save project as ...",icon:"actions/saveProjectAs.png",enableIf:function(_71,_72,_30){return!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.project.saveAs()}},{title:"Copy project",icon:"actions/copyProject.png",click:function(_71,_30,_72){_72.creator.project.duplicate()}},{title:"Export Project",icon:"actions/exportProject.png",enabled:this.filesystemDataSourceEnabled||this.hostedMode,click:function(_71,_30,_72){_72.creator.project.exportProjectWindow(_72.creator.currentScreen,_72.creator)}},{isSeparator:true},{title:"Delete project",icon:"actions/deleteProject.png",enableIf:function(_71,_72,_30){return _72.creator.project.fileName&&!_72.creator.project.isReadOnly()},click:function(_71,_30,_72){_72.creator.confirmDeleteProject()}},{isSeparator:true},{title:"Reset project state",icon:"actions/revertScreen.png",enableIf:function(_71,_72,_30){return _72.creator.project.fileName},click:function(_71,_30,_72){_72.creator.resetProjectState()}},{isSeparator:true},{title:"Skin",icon:"actions/skin.png",submenu:[]},{title:"Resolution",icon:"actions/resolution.png",submenu:[]}];if(this.hostedMode){_48.addList([{isSeparator:true},{title:"Share",icon:"actions/shareProject.png",enableIf:function(_71,_72,_30){if(!window.user)return false;var _1=_72.creator;if(_1.singleScreenMode&&_1.currentScreen)return true;else if(_1.project&&!_1.project.isEmpty())return true},click:function(_71,_30,_72){var _1=_72.creator;_1.shareProject()}}])}
this.projectMenuDefaults={_constructor:"Menu",title:"Project",width:100,data:_48,setSkin:function(_26){this.creator.doAutoSave(this.getID()+".doSetSkin('"+_26+"')")},doSetSkin:function(_26){var _50=isc.clone(isc.params);_50.skin=_26;var _51=location.href;if(_51.contains("?"))_51=_51.substring(0,_51.indexOf("?"));_51+="?";for(var _52 in _50){_51+=encodeURIComponent(_52)+"="+encodeURIComponent(_50[_52])+"&"}
_51=_51.substring(0,_51.length-1);isc.Cookie.set(this.creator.loadAutoSaveCookie,"true");this.creator.$210g("skinChange",_26);location.replace(_51)},setNativeSkin:function(_26){this.creator.doAutoSave(this.getID()+".doSetNativeSkin("+_26+")")},doSetNativeSkin:function(_26){var _50=isc.clone(isc.params);_50.useNativeSkin=_26?1:0;var _51=location.href;if(_51.contains("?"))_51=_51.substring(0,_51.indexOf("?"));_51+="?";for(var _52 in _50){_51+=encodeURIComponent(_52)+"="+encodeURIComponent(_50[_52])+"&"}
_51=_51.substring(0,_51.length-1);isc.Cookie.set(this.creator.loadAutoSaveCookie,"true");location.replace(_51)},setResolution:function(_71,_72){this.creator.middleStack.setWidth(_71);this.creator.rootLiveObject.setHeight(_72);this.creator.$210g("resolutionChange",_71,_72);isc.Page.scrollTo(0,0)},previewAreaResized:function(_71,_72){if(this.$212a==null)return;if(this.$212a.currentResolutionItem.defaultResolutionItem){delete this.$212b;delete this.$212c}},getDefaultPreviewWidth:function(){if(this.$212b==null){this.$212b=this.creator.middleStack.width}
return this.$212b},getDefaultPreviewHeight:function(){if(this.$212c==null){this.$212c=this.creator.rootLiveObject.height}
return this.$212c},getSubmenu:function(_30){var _25;_30=this.getItem(_30);if(_30.title=="Skin"){if(this.$212d==null){var _53=this.creator.skinValueMap,_6=[],_54=this,_1=this.creator;if(!this.creator.hostedMode){_6.addList([{title:"Use high contrast tool skin",checked:!isc.nativeSkin,click:function(_71,_30,_72){_30.checked=!_30.checked;_72.$35q.setNativeSkin(!_30.checked)}},{isSeparator:true}])}
if(this.creator.canOpenSkinEditor){var _55=isc.Menu.create({title:'Custom Skins',submenu:[]});var _56=isc.DataSource.get('userSkin');_56.fetchData(null,function(_71,_22,_72){for(var _57=0;_57<_22.length;_57++){var _58=_22[_57];_55.submenu.add({name:_58.name,title:_58.title,click:function(_73,_30,_74,_75){_54.setSkin(_30.name)},checkIf:function(_73,_74,_30){return _1.skin==_30.name}})}},{fetchMode:'local',sortBy:'-created_at'});_6.add(_55)}
var _59=isc.Menu.create({title:'Standard Skins',submenu:[]});for(var _60 in _53){_59.submenu.add({name:_60,title:_53[_60],click:function(_71,_30,_72,_73){_54.setSkin(_30.name)},checkIf:function(_71,_72,_30){return _1.skin==_30.name}})}
_6.add(_59);_6.add({isSeparator:true});if(_1.canOpenSkinEditor){_6.add({title:'Open Skin Editor...',click:function(_71,_30,_72,_73){var _61=(_1.hostedMode?"/themes/":"/tools/skinTools/skinEditor.jsp");window.open(_61,"_blank")}})}
this.$212d=this.Super("getSubmenu",arguments);this.$212d.addProperties({data:_6})}
return this.$212d}else if(_30.title=="Resolution"){var _62=this.getDefaultPreviewWidth(),_63=this.getDefaultPreviewHeight();if(this.$212a==null){var _64=[[1024,768],[1280,1024]],_65=[];_65[0]={defaultResolutionItem:true,checkIf:function(_71,_72,_30){return(_30==_72.currentResolutionItem)},dynamicTitle:function(_71,_72,_30){return _30.width+"x"+_30.height+" [fit to browser]"},width:_62,height:_63};for(var i=0;i<_64.length;i++){_65.add({checkIf:function(_71,_72,_30){return(_30==_72.currentResolutionItem)},dynamicTitle:function(_71,_72,_30){return _30.width+"x"+_30.height},width:_64[i][0],height:_64[i][1]})}
this.$212a=this.Super("getSubmenu",arguments);this.$212a.addProperties({data:_65,itemClick:function(_30,_71){this.currentResolutionItem=_30;this.$35q.setResolution(_30.width,_30.height)}});this.$212a.currentResolutionItem=_65[0]}else{this.$212a.data[0].width=_62;this.$212a.data[0].height=_63}
return this.$212a}
if(!_25){_25=this.Super("getSubmenu",arguments);if(_25)_25.emptyMessage="[No entries]"}
return _25}};this.screenListDefaults={_constructor:"TTreeGrid",autoParent:"screenPane",canReparentNodes:true,canReorderRecords:true,canEdit:true,modalEditing:true,rowEditorEnter:function(){if(this.$286){isc.RPCManager.registerUnmaskedTarget(this.$286)}
if(this.$1943){isc.Timer.clear(this.$1943);delete this.$1943}
if(!this.fieldIsVisible("fileName"))this.showField("fileName")},rowEditorExit:function(){if(!this.$1943)this.$1943=this.delayCall("hideFileNameField")},hideFileNameField:function(){if(this.$286){isc.RPCManager.unregisterUnmaskedTarget(this.$286)}
delete this.$1943;this.hideField("fileName")},validateRow:function(_71){var _3=this.creator.project?this.creator.project.screens.getAllNodes():[],_66=this.getEditValues(_71);for(var i=0;_3&&i<_3.length;i++){if(i==_71)continue;if(_3[i].fileName==_66.fileName){var _67=this.getUniqueName(_3,_66.fileName);if(_67==null){isc.say("File name is already in use for another screen, and we cannot derive a unique alternative");return}
var _68=this;var _69=isc.Dialog.create({title:"Duplicate file name",message:"File name is already in use for another screen.  Please select how to proceed",icon:"[SKIN]ask.png",buttons:[isc.Button.create({title:"Overwrite '"+_66.fileName+"'"}),isc.Button.create({title:"Save As '"+_67+"'"}),isc.Button.create({title:"Cancel"})],buttonClick:function(_72,_57){if(_57<2){if(_57==1){this.setEditValue(_71,"fileName",_67)}
_68.endEditing()}
this.hide();this.destroy()}});_69.show();return false}}
return true},getUniqueName:function(_71,_72){for(var i=1;i<1000;i++){var _67=_72+i;var _70=false;for(var j=0;j<_71.length;j++){if(_71.fileName==_67){_70=true;break}
if(!_70){return _67}}}},showHeader:false,hilites:[{criteria:{_constructor:"AdvancedCriteria",fieldName:"dirty",operator:"notNull"},cssText:"color: red;"}],fields:[{name:"title",title:"Description",treeField:true,formatCellValue:function(_26,_71,_72,_73,_74){return _26.endsWith(".xml")?_26.slice(0,-4):_26}},{name:"fileName",title:"Filename",hidden:true}],screenContextMenuDefaults:{_constructor:"Menu",autoDraw:false,showIcon:false,showMenuFor:function(_71,_72){this.$109l=_71;this.$109m=_72;this.showContextMenu()},data:[{title:"Rename screen...",click:function(_71,_30,_72){_72.creator.edit(_72.$109m)}},{title:"Save",click:function(_71,_30,_72){_72.creator.creator.cacheCurrentScreenContents();_72.creator.creator.project.saveScreenContents(_72.$109l)}},{title:"Save as ...",click:function(_71,_30,_72){_72.creator.creator.saveScreenAs(_72.$109l)}},{title:"Export as JSP ...",enabled:this.filesystemDataSourceEnabled,click:function(_71,_30,_72){_72.creator.creator.exportScreenAsJSP(_72.$109l)}},{title:"Remove from project",click:function(_71,_30,_72){_72.creator.creator.project.removeScreen(_72.$109l,true)}},{title:"Delete on server",enableIf:function(_71,_72,_30){if(_30.enabled===false)return false;return _72.$109l.fileName},click:function(_71,_30,_72){var _20="Delete screen '"+_72.$109l.title+"' on the server? This operation cannot be undone.";isc.confirm(_20,function(_73){if(_73)_72.creator.creator.deleteScreen(_72.$109l)})}}]},groupContextMenuDefaults:{_constructor:"Menu",autoDraw:false,showIcon:false,showMenuFor:function(_71,_72){this.$109l=_71;this.$109m=_72;this.showContextMenu()},data:[{title:"Remove from project",click:function(_71,_30,_72){_72.creator.creator.project.removeGroup(_72.$109l)}},{title:"Rename",click:function(_71,_30,_72){_72.creator.startEditing(_72.$109m,0)}}]},initWidget:function(){this.Super("initWidget",arguments);this.screenContextMenu=this.createAutoChild("screenContextMenu");this.groupContextMenu=this.createAutoChild("groupContextMenu")},folderContextClick:function(_71,_72,_73){this.groupContextMenu.showMenuFor(_72,_73);return false},leafContextClick:function(_71,_72,_73){this.screenContextMenu.showMenuFor(_72,_73);return false},selectionStyle:"single",selectionChanged:function(_71,_72){if(this.$1944)return;this.$1944=true;this.cancelEditing();if(_72&&!_71.isFolder)this.creator.setCurrentScreen(_71);delete this.$1944}};this.screenAddButtonMenuDefaults={_constructor:"Menu",data:[{title:"New screen",click:function(_71,_30,_72){_72.creator.createNewScreen()}},{title:"Import screen",enabled:this.filesystemDataSourceEnabled,click:function(_71,_30,_72){var _16="../../isomorphic/system/reference/SmartClient_Reference.html#group..visualBuilder";isc.ask("This feature allows you to import externally edited XML or JS code. The Visual Builder cannot fully capture all externally edited files. For more information, see the <a target=_blank href='"+_16+"'>Visual Builder Docs</a><br><br>Proceed with Import?",function(_73){if(_73)_72.creator.showImportDialog(_72)})}},{title:"Import from Balsamiq",click:function(_71,_30,_72){isc.BMMLImportDialog.create({showFileNameField:_72.creator.loadFileBuiltinIsEnabled,showAssetsNameField:_72.creator.saveFileBuiltinIsEnabled,showOutputField:_72.creator.saveFileBuiltinIsEnabled,showSkinSelector:false,submit:function(_73,_74,_75,_76,_77,_78,_79,_80,_81){_72.creator.loadBMMLMockup(_73,_74,_76,_78,_79,_80,_81,true);this.markForDestroy()}})}},{title:"Load a shared screen",click:function(_71,_30,_72){_72.creator.showLoadSharedScreenUI()}},{isSeparator:true},{title:"New group",click:function(_71,_30,_72){_72.creator.showAddScreenGroupUI()}}]};this.Super("init",arguments);if(this.showRecentVersions==null)this.showRecentVersions=this.hostedMode;if(!this.showRecentVersions){var _47=this.screenMenuDefaults.data;_47.remove(_47.find("title","View recent version"))}
var _68=this;isc.DSWizard.loadWizardNodes(this,function(_22){_68.$200c=_22})});isc.evalBoundary;isc.B.push(isc.A.initWidget=function isc_VisualBuilder_initWidget(){this.Super('initWidget',arguments);var _1,_2=this.hostedMode;if(_2){this.clickStream=isc.ClickStream.getCommonFrameworkStream();if(this.captureUsageData)this.$210i();if(this.captureErrorReport)this.$209d();this.deployDataSource=isc.DS.get(this.deployDataSource||"hostedDeployments");if(this.shouldShowRegDevUserMenuItems())this.authorizeManageUsersPanel()}
if(!this.ignoreProgramErrors){this.observe(isc.Log,"$115i","observer.handleProgramError()")}
if(this.monitorServerConnection)this.startMonitoringServer();if(this.sessionTimeout)this.startTrackingSessionTimeout();if(this.$1735()){this.screenDataSource=this.projectDataSource=isc.OfflineFileSource.create()}else{this.screenDataSource=isc.DS.get(this.screenDataSource||(_2?"hostedScreens":"vbScreens"));this.projectDataSource=isc.DS.get(this.projectDataSource||(_2?"hostedProjects":"vbProjects"));_1=_2}
if(this.screenDataSource)this.screenDataSource.streamLogging=_1;if(this.projectDataSource)this.projectDataSource.streamLogging=_1;this.settingsDataSource=isc.DS.get(this.settingsDataSource||(_2?"hostedSettings":"vbSettings"));this.dsDataSource=isc.DS.get(this.dsDataSource||(_2?"hostedDataSources":"vbDataSources"));var _3;this.canExportJSP=this.canExportJSP!==_3?this.canExportJSP:_2?false:true;isc.addProperties(this.projectComponentsDefaults,{canDropRootNodes:this.canAddRootComponents});isc.designTime=true;this.loadCurrentSettings({target:this,methodName:"finishInitWidget"});isc.DynamicForm.addProperties({dragLineStyle:"vbDragLine"});var _4=document.getElementById('loadingWrapper');if(_4)isc.Element.clear(_4)});isc.evalBoundary;isc.B.push(isc.A.finishInitWidget=function isc_VisualBuilder_finishInitWidget(){if(!this.currentSettings)this.currentSettings={};isc.Page.setEvent("mouseDown",function(){var _1=isc.EditContext.titleEditor;if(_1){var x=isc.EH.getX(),y=isc.EH.getY();var _4=_1.getPageRect();if(x>=_4[0]&&x<=_4[0]+_4[2]&&y>=_4[1]&&y<=_4[1]+_4[3])
{}else{_1.blur(_1,_1.getItem("title"))}}});this.enableKeyHandler(true);if(this.defaultApplicationMode){this.editingOn=this.defaultApplicationMode.toLowerCase()=="edit"}else{this.editingOn=false}
this.paletteNodeDS=this.createAutoChild("paletteNodeDS");this.paletteDS=this.createAutoChild("paletteDS",{paletteNodeDS:this.paletteNodeDS,customComponentsURL:this.getCustomComponentsURL(),defaultComponentsURL:this.defaultComponentsURL,defaultMockupComponentsURL:this.defaultMockupComponentsURL});var _5=this;this.rootLiveObject=this.createAutoChild("rootComponent",{autoDraw:false,editorRoot:true,canFocus:true,width:"100%",height:"100%",resized:function(){_5.previewAreaResized()}});var _6=isc.VLayout.create({autoDraw:false,canFocus:false,width:"100%",height:"50%",border:"6px groove #666666",align:"center",defaultLayoutAlign:"center",members:[this.rootLiveObject]});this.previewArea=_6;var _5=this;this.globalDependencies=isc.DataSource.create({dataURL:this.globalDependenciesURL,recordXPath:"//dependency",fields:[{name:"type"}],loadDependencies:function(_11){this.deps=_11;for(var i=0;i<_11.length;i++){var _8=_11[i];if(_8.type=="js"||_8.type=="css"){if(_8.url.startsWith("/")){isc.FileLoader.loadFile("../.."+_8.url)}else{isc.FileLoader.loadFile(_8.url)}}else if(_8.type=="schema"){isc.DataSource.get(_8.id,function(){})}else if(_8.type=="ui"){}}}});this.globalDependencies.fetchData(null,this.getID()+".globalDependencies.loadDependencies(data)");if(this.singleScreenMode){this.showScreenList=false;this.showProjectMenu=false}
if(this.projectID&&!this.projectFileName){this.projectFileName=this.$170c(this.projectID);delete this.projectID}
if(this.singleScreenMode){var _9=isc.Offline.get(this.mockupMode?isc.Project.AUTOSAVE_MOCKUPS:isc.Project.AUTOSAVE_SINGLE_SCREEN);if(_9){this.loadProjectReply(null,{fileName:null,fileContents:_9},null)}else{this.makeDefaultProject()}}else if(this.project&&!isc.Browser.seleniumPresent){var _10=this.project;this.project=null;this.setProject(_10)}else if(this.projectFileName&&!isc.Browser.seleniumPresent){this.loadProject(this.projectFileName,this.projectOwnerId);if(!this.autoNameAndSaveProjectsAndScreens){this.makeNewProject()}}else{var _9=isc.Offline.get(this.mockupMode?isc.Project.AUTOSAVE_MOCKUPS:isc.Project.AUTOSAVE);if(_9){this.loadProjectReply(null,{fileName:null,fileContents:_9},null)}else{this.makeDefaultProject()}}},isc.A.doAutoSave=function isc_VisualBuilder_doAutoSave(_1){if(this.project){this.project.autoSave(_1)}},isc.A.hide=function isc_VisualBuilder_hide(){isc.SelectionOutline.deselect();this.Super("hide",arguments)},isc.A.clear=function isc_VisualBuilder_clear(){isc.SelectionOutline.deselect();this.Super("clear",arguments)},isc.A.showScreenUI=function isc_VisualBuilder_showScreenUI(){var _1=this.getScreenMockupMode(this.currentScreen);if(_1){this.mockupsMenuControl.show();this.projectMenuControl.hide();if(this.leftStack.getSectionNumber("componentProperties")>=0)this.leftStack.hideSection("componentProperties");if(this.leftStack.getSectionNumber("helpPane")>=0)this.leftStack.hideSection("helpPane");if(this.leftStack.getSectionNumber("componentLibrary")<0){var _2=this.rightStack.sectionForItem(this.librarySearch);this.librarySearch.deparent();this.libraryComponents.deparent();this.librarySearchClear.deparent();_2.items=[];this.rightStack.removeSection(_2);this.leftStack.addSection({title:"Component Library",ID:"componentLibrary",autoShow:true,items:[this.librarySearch,this.libraryComponents,this.librarySearchClear]},0);this.librarySearchClear.hide()}
this.middleStack.hideSection("componentTree");this.middleStack.setShowResizeBar(false);this.rightStack.hide();this.removeButton.show();this.bringToFrontButton.show();this.sendToBackButton.show();if(this.modeSwitcher)this.modeSwitcher.hide();this.screenMenuButton.hide();var _3=this.projectComponents.getEditContext();_3.isVisualBuilder=false;if(!this.mockupExtraPalettes)this.mockupExtraPalettes=this.createAutoChild("mockupExtraPalettes");_3.extraPalettes=this.mockupExtraPalettes;_3.allowNestedDrops=false;_3.selectedAppearance="outlineMask";_3.showSelectedLabel=false;this.rootLiveObject.childrenSnapToGrid=true;this.rootLiveObject.snapGridStyle="lines";_3.canSelectEditNodes=true;_3.selectionType=isc.Selection.MULTIPLE;_3.setEditProxyProperties(this.rootLiveObject,{supportsInlineEdit:false,allowNestedDrops:true,autoMaskChildren:true,persistCoordinates:true});this.rootLiveObject.setEditMode(true,this.projectComponents.getEditContext(),this.projectComponents.getRootEditNode());this.enableDeleteKeyHandler(true)}else{this.mockupsMenuControl.hide();this.projectMenuControl.show();if(this.leftStack.getSectionNumber("componentProperties")>=0)this.leftStack.showSection("componentProperties");if(this.leftStack.getSectionNumber("helpPane")>=0)this.leftStack.showSection("helpPane");this.middleStack.showSection("componentTree");this.middleStack.setShowResizeBar(true);if(this.rightStack.getSectionNumber("componentLibrary")<0){var _2=this.leftStack.sectionForItem(this.librarySearch);this.librarySearch.deparent();this.libraryComponents.deparent();this.librarySearchClear.deparent();_2.items=[];this.leftStack.removeSection(_2);this.rightStack.addSection({title:"Component Library",ID:"componentLibrary",autoShow:true,items:[this.librarySearch,this.libraryComponents,this.librarySearchClear]},0);this.librarySearchClear.hide();this.rightStack.show()}
this.removeButton.hide();this.bringToFrontButton.hide();this.sendToBackButton.hide();if(this.modeSwitcher&&this.middleStack.isDrawn()){this.modeSwitcher.show()}
if(this.previewArea.isVisible()){this.screenMenuButton.show()}
var _3=this.projectComponents.getEditContext();_3.isVisualBuilder=true;_3.allowNestedDrops=true;_3.selectionType=isc.Selection.SINGLE;_3.selectedAppearance="outlineEdges";_3.showSelectedLabel=true;if(!this.vbExtraPalettes)this.vbExtraPalettes=this.createAutoChild("vbExtraPalettes");_3.extraPalettes=this.vbExtraPalettes;this.rootLiveObject.autoMaskChildren=false;this.rootLiveObject.childrenSnapToGrid=false;this.rootLiveObject.setChildrenSnapAlign(false);_3.setEditProxyProperties(this.rootLiveObject,{supportsInlineEdit:false,allowNestedDrops:false,persistCoordinates:false});this.rootLiveObject.setEditMode(true,this.projectComponents.getEditContext(),this.projectComponents.getRootEditNode());this.enableDeleteKeyHandler(false)}
this.show()},isc.A.updateSelectionActionButtons=function isc_VisualBuilder_updateSelectionActionButtons(){var _1=this.projectComponents.getEditContext().getSelectedEditNodes();if(_1.length==0){this.removeButton.disable();this.sendToBackButton.disable();this.bringToFrontButton.disable()}else{this.removeButton.enable();this.sendToBackButton.enable();this.bringToFrontButton.enable()}},isc.A.enableKeyHandler=function isc_VisualBuilder_enableKeyHandler(_1){if(_1){if(!this.$1367){this.$1367=isc.Page.setEvent("keyPress",this)}}else{if(this.$1367){isc.Page.clearEvent("keyPress",this.$1367);delete this.$1367}}},isc.A.enableDeleteKeyHandler=function isc_VisualBuilder_enableDeleteKeyHandler(_1){this.$214k=_1},isc.A.pageKeyPress=function isc_VisualBuilder_pageKeyPress(_1,_2){if(!this.project||(this.project.saveScreenDialog&&this.project.saveScreenDialog.containsFocus()))return;var _3=isc.EH.getKey();if(this.$214k){var _4=this.projectComponents.getEditContext().getSelectedEditNodes();if(_4.length==0){if(_3=="Delete"||_3=="Backspace"){if(this.codePreview&&this.codePreview.hasFocus)return true;return false}
return}
if(!this.previewArea.containsFocus())return;if(_3=="Delete"||_3=="Backspace"){var _5=this.projectComponents.getEditContext();for(var i=0;i<_4.length;i++){_5.removeNode(_4[i])}
return false}}
if(this.hostedMode&&(_3=="Z"||_3=="Y")){if(isc.EH.ctrlKeyDown()){var _7=(this.project?this.project.isReadOnly():true);if(!_7){var _8=isc.EH.shiftKeyDown(),_9;if(_3=="Z"&&!_8){_9=this.getUndoRedoVersion(true)}else if((_3=="Z"&&_8)||_3=="Y"){_9=this.getUndoRedoVersion(false)}
if(_9){this.revertScreen(this.currentScreen,_9,true);this.$210g("revert",this.getCurrentScreenTitle(),this.getProjectDisplayName())}
return false}}}},isc.A.screenIsUndoVersion=function isc_VisualBuilder_screenIsUndoVersion(){if(!this.$214q||!this.currentScreen.versions)return false;var _1=this.currentScreen.versions;if(!_1||_1.getLength()==0)return false;return(isc.DateUtil.compareDates(this.$214q,_1[0].fileLastModified)!=0)},isc.A.resetUndoPosition=function isc_VisualBuilder_resetUndoPosition(_1){this.$214q=_1},isc.A.getUndoRedoVersion=function isc_VisualBuilder_getUndoRedoVersion(_1){var _2=this.currentScreen.versions;if(!_2)return null;var _3=this.$214q,_4;if(!_3&&_2.getLength()==0)return null;if(!_3){_3=_2[0].fileLastModified;this.$214q=_3}
for(var i=0;i<_2.getLength();i++){if(_2[i].fileAutoSaved){if(_1&&isc.DateUtil.compareDates(_4,_3)==0){return _2[i].fileLastModified}else if(!_1&&isc.DateUtil.compareDates(_2[i].fileLastModified,_3)==0){return _4}
_4=_2[i].fileLastModified}}
return null},isc.A.getUndoMarkerVersions=function isc_VisualBuilder_getUndoMarkerVersions(){var _1=this.currentScreen.versions;if(!_1)return null;var _2=this.$214q;if(!_2&&(!_1||_1.getLength()==0))return null;var _3=[];for(var i=1;i<_1.getLength();i++){if(_1[i].fileAutoSaved){if(isc.DateUtil.compareDates(_1[i].fileLastModified,_2)==0){break}
_3.add(_1[i].fileLastModified)}}
return _3},isc.A.updateMockupsMenuControl=function isc_VisualBuilder_updateMockupsMenuControl(){if(this.mockupsMenu)return;this.mockupsMenu=this.createAutoChild("mockupsMenu");this.mockupsMenuButton=this.createAutoChild("mockupsMenuButton",{menu:this.mockupsMenu});var _1=isc.RibbonGroup.create({bodyProperties:{membersMargin:0,layoutMargin:0},showTitle:false,layoutMargin:0,rowHeight:22,border:"0px",controls:[this.mockupsMenuButton]});this.mockupsMenuControl=this.createAutoChild("mockupsMenuControl",{members:[_1]})},isc.A.updateProjectMenuControl=function isc_VisualBuilder_updateProjectMenuControl(){if(this.projectName){this.projectName.setContents(this.getProjectDisplayName());var _1=this.project.isReadOnly();this.projectNamePane.setReadOnly(_1);this.dsNewButton.setDisabled(_1)}
if(this.projectMenu)return;if(this.showProjectMenu!=false){var _2=this.getRecentProjects();this.recentProjectsMenu=this.createAutoChild("recentProjectsMenu",{data:_2});this.projectMenu=this.createAutoChild("projectMenu");this.projectMenuButton=this.createAutoChild("projectMenuButton",{menu:this.projectMenu});var _3=isc.RibbonGroup.create({bodyProperties:{membersMargin:0,layoutMargin:0},showTitle:false,layoutMargin:0,rowHeight:22,border:"0px",controls:[this.projectMenuButton]});this.projectMenuControl=this.createAutoChild("projectMenuControl",{members:[_3]})}},isc.A.updateRunMenuControl=function isc_VisualBuilder_updateRunMenuControl(){var _1=this,_2=this.project,_3=_2.runConfigurations,_4,_5="Run";if(_3&&_3.length>0){for(var i=0;i<_3.length;i++){var _7=_3[i];if(_7.default==true||_7.default=="true"){_4=_7;_5="Run "+_7.name;break}}}
this.runMenuData=[];if(this.mockupMode){this.runMenuData.addList([{title:"Reify Preview",showIf:function(){return false},click:function(){_1.confirmReifyPreview()}},{title:"Open in Visual Builder",click:function(){_1.confirmOpenInBuilder()}}])}else{this.runMenuData.addList([{title:_5,icon:"actions/run.png",enableIf:function(_10,_11,_12){return _1.$1738()},click:function(_10,_11,_12){_1.runProject()}},{title:"Run as...",icon:"actions/runAs.png",click:function(){_1.editRunConfiguration(null,function(_7){if(_7.name){_1.saveRunConfiguration(_7)}
_1.runProject(_7)})}}]);if(_3&&_3.length>0){this.runMenuData.addList([{isSeparator:true},{title:"Saved Configurations",enabled:false}]);for(var i=0;i<_3.length;i++){var _7=_3[i];this.runMenuData.add({title:_7.name,checked:(_7.default==true||_7.default=="true"),enableIf:function(_10,_11,_12){return _1.$1738()},runConfig:_7,canCopy:true,canEdit:true,canDelete:true})}}}
if(this.runMenuData.length>1){if(this.runMenu){this.runButton.setTitle(_5);this.runMenu.setData(this.runMenuData);return}
this.runMenuDefaults={_constructor:"Menu",hoverStyle:"darkHover",fields:["icon","title",{name:"canCopy",width:16,showValueIconOnly:true,valueIcons:{"true":"actions/copyScreen.png"},showHover:true,hoverWrap:false,hoverHTML:function(_10,_11,_12,_13,_14){return(_11?"Copy configuration":null)}},{name:"canEdit",width:16,showValueIconOnly:true,valueIcons:{"true":"workflow/update.png"},showHover:true,hoverWrap:false,hoverHTML:function(_10,_11,_12,_13,_14){return(_11?"Edit configuration":null)}},{name:"canDelete",width:16,showValueIconOnly:true,valueIcons:{"true":"[SKIN]/../../../ToolSkin/images/actions/remove.png"},showHover:true,hoverWrap:false,hoverHTML:function(_10,_11,_12,_13,_14){return(_11?"Delete configuration":null)}}],data:this.runMenuData,itemClick:function(_10,_11){if(_11==2&&_10.runConfig){_1.editRunConfiguration(_10.runConfig,function(_7,_12){if(_12=="save"){_1.saveRunConfiguration(_7)}},true)}else if(_11==3&&_10.runConfig){_1.editRunConfiguration(_10.runConfig,function(_7,_12){if(_12=="save"){_1.saveRunConfiguration(_7,_10.runConfig.name)}else if(_12=="delete"){_1.removeRunConfiguration(_7)}})}else if(_11==4&&_10.runConfig){_1.removeRunConfiguration(_10.runConfig,true)}else if(_10.runConfig){_1.runProject(_10.runConfig)}}};this.runMenu=this.createAutoChild("runMenu")}
var _8=[this.runButton=this.createAutoChild("runButton",{title:_5,click:function(){_1.runProject(_4)}})];if(this.runMenuData.length>1){_8.add(this.createAutoChild("runMenuButton",{menu:this.runMenu}))}
var _9=isc.RibbonGroup.create({bodyProperties:{membersMargin:0,layoutMargin:0},showTitle:false,layoutMargin:0,rowHeight:22,border:"0px",controls:_8});this.runMenuControl=this.createAutoChild("runMenuControl",{members:[_9]})},isc.A.updateDeployMenuControl=function isc_VisualBuilder_updateDeployMenuControl(){if(!this.hostedMode)return;var _1=this,_2=this.project;this.deployMenuData=[{title:"Deploy to",icon:"actions/deploy.png",click:function(){_1.showDeploymentsWindow()},enableIf:function(_5,_6,_7){if(!_7.submenu)_7.submenu=_6.creator.existingDeploymentsMenu;return _1.hasExistingDeployments()}},{title:"New Deployment...",icon:"actions/new_deployment.png",click:function(){_1.showDeploymentWindow()}},{isSeparator:true},{title:"Manage...",click:function(){_1.showDeploymentsWindow()},enableIf:function(){return _1.hasExistingDeployments()}}];if(this.deployMenu){return}
this.deployMenuDefaults={_constructor:"Menu",title:"Deploy",width:200,data:this.deployMenuData,rowClick:function(_5,_6,_7){this.Super("rowClick",arguments);if(this.hasSubmenu(_5)){if(_5.click)_5.click()}}};this.existingDeploymentsMenu=this.createAutoChild("existingDeploymentsMenu",{dataSource:_1.createExistingDeploymentsDS()});this.updateExistingDeployments();this.deployMenu=this.createAutoChild("deployMenu");var _3=[this.deployMenuButton=this.createAutoChild("deployMenuButton",{menu:this.deployMenu})];var _4=isc.RibbonGroup.create({bodyProperties:{membersMargin:0,layoutMargin:0},showTitle:false,layoutMargin:0,rowHeight:22,border:"0px",controls:_3});this.deployMenuControl=this.createAutoChild("deployMenuControl",{members:[_4]})},isc.A.updateExistingDeployments=function isc_VisualBuilder_updateExistingDeployments(){var _1=this;this.deployDataSource.listFiles(null,function(_3,_4,_5){if(_4==null){_1.logWarn("unable to get existing deployments from DS: "+_3.data)}else{var _2=_1.existingDeployments;_2.setCacheData(_3.data);_2.updateCaches({dataSource:_2,invalidateCache:true})}},{operationId:"allOwners"})},isc.A.createExistingDeploymentsDS=function isc_VisualBuilder_createExistingDeploymentsDS(){var _1=this.existingDeployments;if(_1!=null)return _1;var _2=this;return this.existingDeployments=isc.DataSource.create({clientOnly:true,fields:[{name:"id",primaryKey:true},{name:"fileName",title:"Name"},{name:"fileType",title:"Type"}],updateCacheFromServer:function(_3,_4){switch(_3.operationType){case"add":this.addData(_4);break;case"update":this.updateData(_4);break}},getCacheLength:function(){return this.cacheData.getLength()},getRecord:function(_3){return this.cacheData.find("id",_3)}})},isc.A.hasExistingDeployments=function isc_VisualBuilder_hasExistingDeployments(){var _1=this.existingDeployments;return _1?_1.getCacheLength()>0:null},isc.A.showDeploymentWindow=function isc_VisualBuilder_showDeploymentWindow(_1){var _2=this.deploymentWindow;if(_2==null||_2.destroyed){_2=this.deploymentWindow=this.createAutoChild("deploymentWindow")}
_2.setTitle(_1?"Deploy to: "+isc.DeploymentEditor.getDeploymentTitle(_1):"New Deployment");var _3=this.deploymentEditor;if(_3==null||_3.destroyed){_3=this.deploymentEditor=this.createAutoChild("deploymentEditor")}
_2.addItem(_3);_2.show();_3.updateData();if(_1)_3.editRecord(_1);else _3.editNewRecord()},isc.A.showDeploymentsWindow=function isc_VisualBuilder_showDeploymentsWindow(){var _1=this.deploymentsWindow;if(_1==null||_1.destroyed){_1=this.deploymentsWindow=this.createAutoChild("deploymentsWindow")}
var _2=this.deploymentsManager;if(_2==null||_2.destroyed){_2=this.deploymentsManager=this.createAutoChild("deploymentsManager")}
_1.addItem(_2);_1.show();_2.updateData()},isc.A.editSampleUsers=function isc_VisualBuilder_editSampleUsers(){if(this.editSampleUsersWindow==null){this.editSampleUsersWindow=this.createAutoChild("editSampleUsersWindow")}
this.editSampleUsersWindow.show()},isc.A.updateCurrentUser=function isc_VisualBuilder_updateCurrentUser(_1){if(this.project==null)return;if(this.project.authentication==null)this.project.authentication={};var _2=this.project.authentication;_2.lastSelectedUser=_1.userId;this.project.autoSaveSoon(true);this.updateUsersRolesMenuControl()},isc.A.updateSampleUsers=function isc_VisualBuilder_updateSampleUsers(_1,_2){if(this.project==null)return;if(this.project.authentication==null)this.project.authentication={};this.project.authentication.users=_1.duplicate();this.project.autoSaveSoon();if(!_2)this.updateUsersRolesMenuControl()},isc.A.editSampleRoles=function isc_VisualBuilder_editSampleRoles(){if(this.editSampleRolesWindow==null){var _1=this.project,_2=_1&&_1.authentication,_3=_2&&_2.availableRoles;if(_3==null)_3=[];else{if(_3[0]&&_3[0].internalId==null){var _4=0;for(var i=0;i<_3.length;i++){if(_3[i].internalId==null){_3[i].internalId=_4++}}}}
this.roleDS=isc.DataSource.create({clientOnly:true,cacheData:_3.duplicate(),fields:[{name:"internalId",hidden:true,primaryKey:true,type:"sequence"},{name:"name",required:true,type:"identifier",validators:[{type:"isUnique"}]},{name:"description",type:"text",length:150}]});this.editSampleRolesWindow=this.createAutoChild("editSampleRolesWindow")}
this.editSampleRolesWindow.show()},isc.A.updateSampleRolesFromDS=function isc_VisualBuilder_updateSampleRolesFromDS(){var _1=this.roleDS.fetchData(null,{target:this,methodName:"updateSampleRoles"})},isc.A.updateSampleRoles=function isc_VisualBuilder_updateSampleRoles(_1,_2,_3){if(this.project==null)return;if(this.project.authentication==null)this.project.authentication={};this.project.authentication.availableRoles=_2.duplicate();var _4=_2.getProperty("name");isc.Auth.setAvailableRoles(_4);this.project.autoSaveSoon();this.updateUsersRolesMenuControl();var _5=false;var _6=this.project.authentication.users;if(_6&&_6.length>0){for(var i=0;(i<_6.length)&&!_5;i++){var _8=_6[i].roles;if(!isc.isAn.Array(_8))_8=[_8];for(var _9=0;_9<_8.length;_9++){if(_8[_9]==null||isc.isAn.emptyString(_8[_9]))continue;if(_4.indexOf(_8[_9])==-1){_5=true;break}}}}
if(_5){var _10=this;isc.ask("Available roles updated.<P>Specified roles for test users no longer match the roles available - update test user data?",function(_11){if(_11){_10.editSampleUsers()}},{title:"Update Test Users?"})}else{isc.notify("Available roles updated")}},isc.A.updateUsersRolesMenuControl=function isc_VisualBuilder_updateUsersRolesMenuControl(){if(!this.showUsersAndRoles)return;var _1=this,_2=this.project,_3=_2.authentication||{},_4=_3.availableRoles;var _5=[],_6=false;if(_4!=null){for(var i=0;i<_4.length;i++){_5[i]=isc.isAn.Object(_4[i])?_4[i].name:_4[i]}
_6=(Array.compareAscending(_5,isc.Auth.getAvailableRoles())!=0);isc.Auth.setAvailableRoles(_5)}
var _8=_3.users||[];if(this.sampleUsersMenu==null){this.sampleUsersMenu=this.createAutoChild("sampleUsersMenu");this.usersRolesMenu.items[0].submenu=this.sampleUsersMenu}
var _9=[];for(var i=0;i<_8.length;i++){var _10=_8[i];var _11=_10.superUser?["super-user"]:[];if(_10.roles!=null&&!_10.superUser){var _12=_10.roles;if(!isc.isAn.Array(_12))_12=[_12];for(var _13=0;_13<_12.length;_13++){if(_11.indexOf(_12[_13])==-1){_11.add(_12[_13])}}}
_9[i]={checkIf:function(_17,_18,_19){var _14=isc.Auth.getCurrentUser();return(_14!=null&&_14.userId!=null&&(_14.userId==_19.userId))},title:_10.firstName+" "+_10.lastName,roles:_11.join(", "),userId:_10.userId,click:function(_17,_18,_19){_1.updateCurrentUser(_18)}}}
this.sampleUsersMenu.setItems(_9);var _14=_3.lastSelectedUser,_15=false,_16=false;if(_14!=null){_14=_8.find("userId",_14)}
if(_14==null){_14=_8[0]}
if(_14){var _12=_14.roles;if(isc.isA.String(_12)&&_3.provider=="inlineSampleUsers"){_12=_12.split(",")}
if(_12!=null&&!isc.isAn.Array(_12))_12=[_12];_15=(_14!=isc.Auth.getCurrentUser());_16=(Array.compareAscending(_12,isc.Auth.getRoles())!=0);isc.Auth.setCurrentUser(_14);isc.Auth.setRoles(_12);isc.Auth.setSuperUser(_14.superUser)}
delete this.$215n;if(this.usersRolesLabel)this.usersRolesLabel.markForRedraw();if(this.editSampleUsersWindow&&this.editSampleUsersWindow.currentUserSelector!=null){this.editSampleUsersWindow.currentUserSelector.getItem("user").updateValueMap();this.editSampleUsersWindow.currentUserSelector.setValue("user",_14.userId)}
if(_6||_15||_16){_2.updateCurrentScreenDataSourcesSecurity()}});isc.evalBoundary;isc.B.push(isc.A.saveRunConfiguration=function isc_VisualBuilder_saveRunConfiguration(_1,_2){var _3=this.project,_4=_3.runConfigurations,_5=_1.name;if(!_4)_4=_3.runConfigurations=[];if(_1.default){var _6=_4.findAll("default","true");if(_6)_6.map(function(_1){delete _1.default})}
if(_2&&_2!=_5){var _7=_4.find("name",_5);if(_7)_4.remove(_7)}
var _8=_4.findIndex("name",_2||_5);if(_8>=0){_4[_8]=_1}else{_4.add(_1)}
_4.sortByProperty("name",true);_3.autoSaveSoon();this.updateRunMenuControl();isc.Notify.addMessage("Run configuration successfully saved")},isc.A.editRunConfiguration=function isc_VisualBuilder_editRunConfiguration(_1,_2,_3){var _4=this;var _5=function(_10){var _6=_10.cacheData;_6.add({name:'group2',title:'Standard Skins',customStyle:'cellDarkAltCol',canSelect:false});for(var _7 in _4.skinValueMap){_10.addData({name:_7,title:_4.skinValueMap[_7]})}
if(_4.canOpenSkinEditor){var _8=(_4.hostedMode?"/themes/":"/tools/skinTools/skinEditor.jsp");_10.addData({name:'launcher',title:'<a class="calMonthEventLink" target="_blank" href="'+_8+'">Open Skin Editor...</a>',customStyle:'cellDarkAltCol',canSelect:false})}
_4.makeRunConfigDialog(_1,_10,_2,_3);_4.runConfigWindow.show()};if(this.canOpenSkinEditor){var _9=isc.DataSource.get('userSkin');_9.getClientOnlyDataSource(null,function(_11){var _6=_11.cacheData;if(!_6.isEmpty()){_6.addAt({name:'group1',title:'Custom Skins',customStyle:'cellDarkAltCol',canSelect:false},0)}
_5(_11)},{sortBy:'-pk'})}else{var _10=isc.DataSource.create({clientOnly:true,fields:[{name:"pk",type:"sequence",primaryKey:true},{name:"name",type:"text"},{name:"title",type:"text"}],cacheData:[]});_5(_10)}},isc.A.removeRunConfiguration=function isc_VisualBuilder_removeRunConfiguration(_1,_2){var _3=this,_4=this.project,_5=_4.runConfigurations,_6=function(){_5.remove(_1);_4.autoSaveSoon();_3.updateRunMenuControl();isc.Notify.addMessage("Run configuration successfully deleted")};if(_2){isc.confirm("Delete saved configuration '"+_1.name+"'?",function(_7){if(_7)_6()},{buttons:[isc.Dialog.NO,isc.Dialog.YES],autoFocusButton:1})}else{_6()}},isc.A.getRunConfigurationCopyName=function isc_VisualBuilder_getRunConfigurationCopyName(_1){var _2=this.project,_3=_2.runConfigurations,_4=_1.name,_5=1,_6;_4=_4.replace(/\s+copy(?:\s+\d+)?$/,"");do{_6=_4+" copy "+_5++;var _7=_3.containsProperty("name",_6)}while(_7);return _6},isc.A.getDefaultDensity=function isc_VisualBuilder_getDefaultDensity(_1){return this.$2072[_1]},isc.A.getUserValueMap=function isc_VisualBuilder_getUserValueMap(){var _1=this.project&&this.project.authentication,_2=(_1&&_1.users)||[],_3={};for(var i=0;i<_2.length;i++){var _5=_2[i],_6=_5.roles,_7="";if(_5.firstName)_7+=_5.firstName;if(_5.lastName)_7+=" "+_5.lastName;if(_6){if(!isc.isAn.Array(_6))_6=[_6];if(_6.length>0){_7+=" ("+(_5.superUser?"super-user":_6.join(","))+")"}}else if(_5.superUser){_7+=" (super-user)"}
_3[_5.userId]=_7}
return _3},isc.A.makeRunConfigDialog=function isc_VisualBuilder_makeRunConfigDialog(_1,_2,_3,_4){var _5=this;if(this.runConfigForm)this.runConfigForm.markForDestroy();if(_1&&_4){_1=isc.addProperties({},_1,{name:this.getRunConfigurationCopyName(_1),default:false})}
var _6=isc.currentSkin.name,_7=this.getDefaultDensity(_6);if(!_7){_7=this.getDefaultDensity("default")}
var _8=(_1?_1:{skin:_6,density:_7}),_9=(_1!=null),_10=(_1?"":"(Optionally enter a name to re-use this config)");var _11=[{name:"name",type:"text",title:"Name",required:_9,hint:_10,width:280,wrapHintText:false},isc.addProperties({},this.runConfigSkinFieldDefaults,{optionDataSource:_2,valueField:'name',displayField:'title',pickListProperties:{formatCellValue:function(_21,_22,_23,_24){var _12='&nbsp;&nbsp;';return _22.canSelect===false?_21:_12+_21}}}),isc.addProperties({},this.runConfigDensityFieldDefaults)];if(this.showUsersAndRoles){var _13=isc.Auth.getCurrentUser(),_14=(_13&&_13.firstName?_13.firstName:"")+" "+(_13&&_13.lastName?_13.lastName:""),_15=this.getUserValueMap();_11.add(isc.addProperties({},this.runConfigUserIdFieldDefaults,{emptyDisplayValue:"Current user in Preview ("+_14+")",valueMap:_15}))}
_11.add(isc.addProperties({},this.runConfigDeviceFieldDefaults));if(isc.Messaging){_11.add({name:"live",type:"boolean",title:"Live (auto-refresh)"})}
_11.add({name:"default",type:"boolean",title:"Make default configuration"});this.runConfigForm=this.createAutoChild("runConfigForm",{fields:_11,values:_8});if(this.runConfigWindow)this.runConfigWindow.markForDestroy();var _16=(_1?"Save":"Run"),_17=(_1?"save":"run"),_18=[isc.IButton.create({title:"Cancel",width:75,layoutAlign:"center",click:function(){_5.runConfigWindow.closeClick()}}),isc.IButton.create({title:_16,width:75,layoutAlign:"center",click:function(){if(!_5.runConfigForm.validate())return;var _8=_5.runConfigForm.getValues();if(_3)_3(_8,_17);_5.runConfigWindow.closeClick()}})];var _19=isc.HLayout.create({height:30,width:this.runConfigForm.width,membersMargin:10});_19.addMember(isc.LayoutSpacer.create());_19.addMembers(_18);var _20=isc.VLayout.create({padding:5,membersMargin:5,members:[this.runConfigForm,_19]});this.runConfigWindow=isc.Window.create({title:(_1?"Edit Configuration":"Run Configuration"),showMinimizeButton:false,builder:this,isModal:true,showModalMask:true,autoCenter:true,autoSize:true,items:[_20]});_18[_18.length-1].focus()},isc.A.addChildren=function isc_VisualBuilder_addChildren(){this.hide();var _1=this;this.projectComponentsMenu=this.createAutoChild("projectComponentsMenu");this.addAutoChild("libraryComponents");this.addAutoChild("librarySearch",{grid:this.libraryComponents});this.addAutoChild("librarySearchClear");this.addAutoChild("projectComponents",{contextMenu:this.projectComponentsMenu,rootComponent:this.rootComponent,rootLiveObject:this.rootLiveObject,defaultPalette:this.libraryComponents,editContextProperties:{showSelectedLabelOnSelect:(this.hideLabelWhenSelecting!=true),canSelectEditNodes:true,useCopyPasteShortcuts:true,selectedEditNodesUpdated:function(){_1.updateSelectionActionButtons()},keepUndoLog:this.keepUndoLog}});this.libraryComponents.defaultEditContext=this.projectComponents.editContext;this.observe(this.projectComponents.editContext,"editNodeUpdated","observer.markDirty();");this.projectTree=this.projectComponents.data;if(this.showComponentAttributeEditor!=false){this.addAutoChild("componentAttributeEditorFilter",{backgroundColor:"papayawhip"});this.addAutoChild("componentAttributeEditor",isc.addProperties(this.commonEditorFunctions,{builder:this,immediateSave:this.immediatelySaveComponentChanges}));this.addAutoChild("componentAttributeEditorLayout",{members:[this.componentAttributeEditorFilter,this.componentAttributeEditor]})}
if(this.showComponentMethodEditor!=false){this.addAutoChild("componentMethodEditor",isc.addProperties(this.commonEditorFunctions,{canEditExpressions:this.canEditExpressions,builder:this}))}
this.addAutoChild("editorPane");if(this.showComponentAttributeEditor!=false){this.editorPane.addTab({title:"Properties",pane:this.componentAttributeEditorLayout})}
if(this.showComponentMethodEditor!=false){this.editorPane.addTab({title:"Events",pane:this.componentMethodEditor,tabSelected:function(_17,_18,_19){_19.showNotifications()}})}
if(!this.immediatelySaveComponentChanges){this.applyButton=this.createAutoChild("applyButton")}
if(this.showHelpPane!=false){this.helpPane=this.createAutoChild("helpPane",{contentsURL:this.helpPaneProperties.contentsURL})}
if(this.showLeftStack!=false){this.addAutoChild("leftStack",{visibility:(this.editingOn?"inherit":"hidden")});if(this.showEditorPane!=false){if(this.showAdvancedButton!=false){this.editorPaneButtonBar=isc.HStack.create({membersMargin:10,margin:2,height:20,align:"right"});this.advancedButton=this.createAutoChild("advancedButton");this.advancedButton.setTitle(this.componentAttributeEditor.basicMode?this.componentAttributeEditor.moreTitle:this.componentAttributeEditor.lessTitle);this.editorPaneButtonBar.addMember(this.advancedButton);if(this.applyButton)this.editorPaneButtonBar.addMember(this.applyButton)}
this.leftStack.addSection({title:"Component Properties",ID:"componentProperties",autoShow:true,items:[this.editorPane,this.editorPaneButtonBar]})}
if(this.showHelpPane!=false){this.leftStack.addSection({title:this.helpPaneProperties.headerTitle,ID:"helpPane",autoShow:false,items:[this.helpPane]})}}
this.showMiddleStack=this.showPreviewArea!=false||this.showProjectComponents!=false;var _2=[];if(this.showScreenMenu!=false){this.screenMenu=this.createAutoChild("screenMenu");this.screenMenuButton=this.createAutoChild("screenMenuButton",{menu:this.screenMenu,visibility:(this.editingOn?"inherit":"hidden")});_2.add(this.screenMenuButton)}
this.savingScreenLabel=this.createAutoChild("savingScreenLabel",{visibility:(this.editingOn?"inherit":"hidden")});this.savingScreenLabelSpacers=[isc.LayoutSpacer.create({width:"*"}),isc.LayoutSpacer.create({width:"*"})];_2.add(this.savingScreenLabelSpacers[0]);_2.add(this.savingScreenLabel);_2.add(this.savingScreenLabelSpacers[1]);if(this.showUsersAndRoles){this.usersRolesLabel=this.createAutoChild("usersRolesLabel");this.usersRolesMenuButton=this.createAutoChild("usersRolesMenuButton");_2.add(this.usersRolesLabel);_2.add(this.usersRolesMenuButton);this.usersRolesMenu=this.createAutoChild("usersRolesMenu");this.usersRolesMenuButton.menu=this.usersRolesMenu;this.updateUsersRolesMenuControl()}
this.removeButton=this.createAutoChild("removeButton");_2.add(this.removeButton);this.bringToFrontButton=this.createAutoChild("bringToFrontButton");_2.add(this.bringToFrontButton);this.sendToBackButton=this.createAutoChild("sendToBackButton");_2.add(this.sendToBackButton);if(this.showModeSwitcher!=false){var _3=this.modeSwitcher=this.createAutoChild("modeSwitcher");_2.add(_3)}
if(this.showMiddleStack!=false){this.addAutoChild("middleStack");if(this.showPreviewArea!=false){this.middleStack.addSection({titleLabelProperties:{overflow:"visible",width:150,padding:5,click:function(){if(this.editingOn){this.creator.getSectionStack().sectionHeaderClick(this.creator)}}},controlsLayoutConstructor:"HLayout",controlsLayoutProperties:{width:"*",overflow:"hidden",canAdaptWidth:true,adaptWidthBy:function(_17,_18){var _4=_18+_17;var _5=this.creator.getSectionStack().creator,_6=[_5.screenMenuButton,_5.usersRolesMenuButton,_5.removeButton,_5.bringToFrontButton,_5.sendToBackButton,_5.modeSwitcher];var _7=this.layoutMargin!=null?(2*this.layoutMargin):0;var _8=false;for(var i=0;i<_6.length;i++){if(_6[i]==null){continue}
if(_6[i].isDrawn()&&_6[i].isVisible()){_7+=_6[i].getWidth();if(_8){_7+=this.membersMargin}else{_8=true}}}
var _10=_5.savingScreenLabel,_11=_10.getWidth();var _12=_5.usersRolesLabel;if(_4<(_7+_11+this.membersMargin)){_10.hide();if(_12)_12.hide();return _17}else{if(!_10.isVisible()&&!_5.$2190){_10.show()}
_7+=_11+this.membersMargin}
var _13=_4-_7;var _14=_5.getUsersRolesTitleSizes();if(_13<_14[0]){if(_12)_12.hide()}else{if(_12)_12.markForRedraw();if(_13<(_14[1]+this.membersMargin)){_5.shortURTitle=true;_5.mediumURTitle=false;if(_12)_12.setWidth(_14[0])}else if(_13<(_14[2]+this.membersMargin)){_5.shortURTitle=false;_5.mediumURTitle=true;if(_12)_12.setWidth(_14[1])}else{_5.shortURTitle=false;_5.mediumURTitle=false;if(_12)_12.setWidth(_14[2])}
if(_12&&!_12.isVisible())_12.show()}
return _17}},title:"Application",autoShow:true,ID:"applicationSection",items:[this.previewArea],controls:_2});this.enableScreenTitleEditing()}
if(this.showProjectComponents!=false){this.projectComponentsSearch=this.createAutoChild("projectComponentsSearch",{grid:this.projectComponents});this.middleStack.addSection({name:"componentTree",title:"Component Tree",autoShow:this.editingOn,items:[this.projectComponents],controls:[this.projectComponentsSearch]})}}
if(this.collapseComponentTree==true)this.middleStack.collapseSection(1);this.showRightStack=(this.showLibraryComponents!=false||this.showScreenList!=false||this.showDataSourceList!=false);if(this.showRightStack!=false){this.addAutoChild("rightStack",{visibility:(this.editingOn?"inherit":"hidden")});if(this.showLibraryComponents!=false){this.rightStack.addSection({title:"Component Library",ID:"componentLibrary",autoShow:true,items:[this.librarySearch,this.libraryComponents,this.librarySearchClear]});this.librarySearchClear.hide()}
if(this.showScreenList!=false||this.showDataSourceList!=false){var _15=this.showScreenList!=false&&this.showDataSourceList!=false;if(_15){this.projectPane=this.createAutoChild("projectPane");this.rightStack.addSection({name:"project",title:"Project Resources",autoShow:true,items:[this.projectPane]})}
if(this.showScreenList!=false){this.screenPane=this.createAutoChild("screenPane");this.addAutoChild("screenList");this.addAutoChild("screenListToolbar");this.screenAddButtonMenu=this.createAutoChild("screenAddButtonMenu");this.addAutoChild("screenAddButton",{menu:this.screenAddButtonMenu});if(this.projectPane){this.projectPane.addTab({title:"Screens",pane:this.screenPane})}else{this.rightStack.addSection({title:"Screens",autoShow:true,items:[this.screenPane]})}}
if(this.showDataSourceList!=false){this.dataSourcePane=this.createAutoChild("dataSourcePane");this.addAutoChildren(["dataSourceList","dataSourceListToolbar","dsEditButton","dsNewButton"]);if(this.hostedMode)this.dataSourceList.hideField("dsType");this.dsNewButton.menu=this.createAutoChild("dsNewButtonMenu");this.dataSourceListSearch=this.createAutoChild("dataSourceListSearch",{grid:this.dataSourceList});if(this.projectComponents){this.projectComponents.extraPalettes=[this.dataSourceList]}
if(this.projectPane){this.projectPane.addTab({title:"DataSources",pane:this.dataSourcePane})}else{this.rightStack.addSection({name:"dataSources",title:"DataSources",autoShow:true,items:[this.dataSourcePane]})}
if(this.project){this.observe(this.project.datasources,"dataChanged","observer.updateDataSourceList();");this.updateDataSourceList()}}}}
this.updateMockupsMenuControl();this.updateProjectMenuControl();this.updateRunMenuControl();this.updateDeployMenuControl();this.addAutoChild("pageHeader");this.addAutoChild("logo");this.addAutoChild("projectName");this.addAutoChild("projectNamePane");var _16=isc.addProperties({},this.projectNameDefaults);_16.type=this.projectNameConstructor;_16.liveObject=this.projectName;this.projectNamePane.addNode(this.libraryComponents.makeEditNode(_16));this.addAutoChild("projectNameSpacer");this.pageHeader.addMember(this.mockupsMenuControl);this.pageHeader.addMember(this.projectMenuControl);this.pageHeader.addMember(this.runMenuControl);if(this.hostedMode){this.pageHeader.addMember(this.deployMenuControl)}
this.addAutoChild("userNameSpacer");if(this.hostedMode){this.addAutoChild("userMenuButton");this.userMenuButton.menu=this.createAutoChild("userMenu")}
this.addAutoChild("workspace");if(this.showLeftStack!=false)this.workspace.addMember(this.leftStack);if(this.showMiddleStack!=false)this.workspace.addMember(this.middleStack);if(this.showRightStack!=false)this.workspace.addMember(this.rightStack);if(this.modeSwitcher&&!this.editingOn){this.modeSwitcher.autoSwitchToPreviewMode()}},isc.A.isInPreviewMode=function isc_VisualBuilder_isInPreviewMode(){return(this.modeSwitcher?this.modeSwitcher.isSelected():false)},isc.A.autoSwitchToEditMode=function isc_VisualBuilder_autoSwitchToEditMode(){if(this.modeSwitcher)return this.modeSwitcher.autoSwitchToEditMode()},isc.A.$1738=function isc_VisualBuilder__runProjectEnabled(){if(this.singleScreenMode&&this.currentScreen)return true;else if(this.project&&!this.project.isEmpty())return true;return false},isc.A.signOut=function isc_VisualBuilder_signOut(){if(this.signOutURL)window.location.assign(this.signOutURL);this.$210g("logout",this.getSessionLengthInSeconds())},isc.A.showUpdateAccountWindow=function isc_VisualBuilder_showUpdateAccountWindow(){var _1=this.updateAccountWindow;if(_1==null||_1.destroyed){_1=this.updateAccountWindow=this.createAutoChild("updateAccountWindow")}
var _2=this.updateAccountEditor;if(_2==null||_2.destroyed){_2=this.updateAccountEditor=this.createAutoChild("updateAccountEditor")}
_2.refreshData();_1.addItem(_2);_1.show()},isc.A.shouldShowRegDevUserMenuItems=function isc_VisualBuilder_shouldShowRegDevUserMenuItems(){return this.hasDevRecord?!!isc.DS.get("registeredDevelopers"):false},isc.A.authorizeManageUsersPanel=function isc_VisualBuilder_authorizeManageUsersPanel(){var _1=this,_2=_1.organization;if(!_2||_2=="-"){this.logWarn("Can't manager users - you haven't entered an organization");return}
isc.DS.get("registeredDevelopers").fetchData(null,function(_7,_8,_9){if(_8&&_8.length!=0){_1.logInfo("Can't manage users - your organization already has an owner");return}
var _3={title:"Manage Users",click:function(_10,_11,_4){_4.creator.showManageUsersWindow()}};var _4=_1.userMenuButton&&_1.userMenuButton.menu;if(_4){if(_4.findIndex({title:_3.title})<0){var _5=_4.findIndex({title:"Update Account"});if(_5>=0)_4.addItem(_3,_5+1)}}else{var _6=_1.userMenuDefaults.regDevItems;var _5=_6.findIndex({title:"Update Account"});if(_5>=0)_6.addAt(_3,_5+1)}},{operationId:"ownerRecord"})},isc.A.showManageUsersWindow=function isc_VisualBuilder_showManageUsersWindow(){var _1=this.manageUsersWindow;if(_1==null||_1.destroyed){_1=this.manageUsersWindow=this.createAutoChild("manageUsersWindow")}
var _2=this.manageUsersPanel;if(_2==null||_2.destroyed){_2=this.manageUsersPanel=this.createAutoChild("manageUsersPanel")}else{_2.usersGrid.refresh()}
_1.addItem(_2);_1.show()},isc.A.editComponent=function isc_VisualBuilder_editComponent(_1,_2){var _3=this.getCurrentComponent(),_4=this.$215u;if((!_3||_3!=_1)&&_4!=null){this.clearComponentAttributeFilter(_3)}
this.$215v(_1,_2);if(!_3&&_4){if(this.componentAttributeEditorFilter){this.componentAttributeEditorFilter.setValue("filter",_4)}
this.filterComponentAttributeEditor(_4)}},isc.A.$215v=function isc_VisualBuilder__editComponent(_1,_2){if(isc.isA.DataSource(_2))return;if(isc.isA.DynamicProperty(_2)){var _3=this.projectComponents.data,_4=_3.getParent(_1);if(_4)_1=_4}
if(_1!=null)this.$132q(_1);if(_1!=null)this.$2162(_1);this.setBasicMode(_1);if(this.showComponentAttributeEditor!=false&&this.$2225&&!this.$2225.basicMode)
{this.toggleBasicMode(_1,this.componentAttributeEditor)}
if(this.showComponentMethodEditor!=false&&this.$2226&&!this.$2226.basicMode)
{this.toggleBasicMode(_1,this.componentMethodEditor)}
if(this.showComponentAttributeEditor!=false){this.componentAttributeEditor.editComponent(_1,_2)}
if(this.showComponentMethodEditor!=false){this.componentMethodEditor.editComponent(_1,_2);var _5=this.editorPane.getSelectedTab();if(_5&&_5.title=="Events"){this.editorPane.getTabPane(_5).showNotifications()}}
if(this.showComponentAttributeEditor!=false||this.showComponentMethodEditor!=false){this.applyBasicModeSettings(_1)}
if(isc.Browser.isIE&&this.editorPane.paneContainer&&this.editorPane.paneContainer.isVisible())
{this.editorPane.paneContainer.hide();this.editorPane.paneContainer.show()}
if(this.leftStack){var _6=_2;if(!_6._constructor)_6=_1;this.updateComponentPropertiesSectionTitle(_6)}
this.setComponentList();if(this.showComponentAttributeEditor!=false&&this.$2225){this.componentAttributeEditor.setViewState(this.$2225)}
if(this.showComponentMethodEditor!=false&&this.$2226){this.componentMethodEditor.setViewState(this.$2226)}
delete this.$2225;delete this.$2226},isc.A.updateComponentPropertiesSectionTitle=function isc_VisualBuilder_updateComponentPropertiesSectionTitle(_1){if(this.leftStack){this.leftStack.setSectionTitle("componentProperties",isc.DS.getAutoId(_1)+" Properties")}},isc.A.setBasicMode=function isc_VisualBuilder_setBasicMode(_1){if(!_1)return;var _2=[this.componentAttributeEditor,this.componentMethodEditor];for(var i=0;i<_2.length;i++){var _4=_2[i];if(!_4)continue;var _5=_4.ID+"BasicMode";if(_1[_5]==null){_1[_5]=_4.basicMode}
_4.$694=_1[_5]}},isc.A.toggleBasicMode=function isc_VisualBuilder_toggleBasicMode(_1,_2){if(!_1)return;_2=_2||this.getCurrentlyVisibleEditor();_2.$694=_2.$694==null?!_2.basicMode:!_2.$694;_1[_2.ID+"BasicMode"]=_2.$694},isc.A.applyBasicModeSettings=function isc_VisualBuilder_applyBasicModeSettings(_1){if(!_1)return;var _2=this.getCurrentlyVisibleEditor();this.setComponentEditorButtonState(_1);this.setClassSwitcherState(_1)},isc.A.setComponentEditorButtonState=function isc_VisualBuilder_setComponentEditorButtonState(_1){if(!_1)return;if(this.showAdvancedButton!=false){var _2=this.getCurrentlyVisibleEditor(),_3=_1[_2.ID+"BasicMode"];if(_3){this.advancedButton.setTitle(_2.moreTitle)}else{this.advancedButton.setTitle(_2.lessTitle)}
if(_2.showMethods){this.advancedButton.setDisabled(!_2.hasMethods)}else{this.advancedButton.setDisabled(false)}}
if(this.applyButton)this.applyButton.setDisabled(false)},isc.A.setClassSwitcherState=function isc_VisualBuilder_setClassSwitcherState(_1){if(this.getCurrentlyVisibleEditor()!=this.componentAttributeEditor)return;if(!this.componentAttributeEditor.canSwitchClass)return;if(!this.componentAttributeEditor.getField("classSwitcher"))return;if(!this.componentAttributeEditor.$694||_1.$711){this.componentAttributeEditor.getField("classSwitcher").setDisabled(true)}else{this.componentAttributeEditor.getField("classSwitcher").setDisabled(false)}},isc.A.getCurrentlyVisibleEditor=function isc_VisualBuilder_getCurrentlyVisibleEditor(){if(this.editorPane.selectedEditorName()==this.editorPane.PROPERTIES){return this.componentAttributeEditor}
return this.componentMethodEditor},isc.A.saveComponentEditors=function isc_VisualBuilder_saveComponentEditors(){if(this.componentMethodEditor)this.componentMethodEditor.save();if(this.componentAttributeEditor)this.componentAttributeEditor.save()},isc.A.getCurrentComponent=function isc_VisualBuilder_getCurrentComponent(){return this.componentAttributeEditor?this.componentAttributeEditor.currentComponent:this.componentMethodEditor?this.componentMethodEditor.currentComponent:null},isc.A.setComponentList=function isc_VisualBuilder_setComponentList(){var _1=this.projectComponents,_2=_1.data.getDescendants(_1.data.getRoot());for(var i=0;i<_2.length;i++){var _4=_2[i];if(_4.type=="DataView"&&!_4.icon)_4.icon="[TOOLSIMG]classes/DataView.png";if(_4.type=="ValuesManager"&&!_4.icon)_4.icon="database.png"}
var _5=_2,_6=isc.Class.getClassActionsComponents();if(_6!=null){_5=_2.duplicate();_5.addList(_6)}
if(this.componentMethodEditor)this.componentMethodEditor.allComponents=_5;if(this.componentAttributeEditor)this.componentAttributeEditor.allComponents=_2},isc.A.getActionTitle=function isc_VisualBuilder_getActionTitle(_1,_2,_3){if(this.componentMethodEditor.allComponents){var _4=this.componentMethodEditor.allComponents,_5=_4.find("ID",_1);if(_5){var _6=isc.jsdoc.getActions(_5.type),_7=(_6?_6.find("name",_2):null);if(_7){var _8=(_7.title?_7.title:isc.DataSource.getAutoTitle(_7.name));return"["+(_3?_1+".":"")+_8+"]"}}}
var _9=_1;if(_9.startsWith(isc.$f))_9=_9.substring(isc.$f.length);var _10=isc.ClassFactory.getClass(_9);if(_10){var _6=_10.getClassActions(),_7=(_6?_6.find("name",_2):null);if(_7){var _8=(_7.title?_7.title:isc.DataSource.getAutoTitle(_7.name));return"["+(_3?_1+".":"")+_8+"]"}}
return null},isc.A.componentAdded=function isc_VisualBuilder_componentAdded(){this.setComponentList();this.markDirty();if(!this.$2000){var _1=this.getScreenMockupMode(this.currentScreen),_2=this.projectComponents.getEditNodeTree(),_3=_2.getLength();if(_3==(_1?0:1)){this.showInstructions()}else{this.hideInstructions()}}},isc.A.componentRemoved=function isc_VisualBuilder_componentRemoved(_1,_2){var _3=this.projectComponents.getSelectedRecord();if(!_3){var _4=this.projectComponents.getEditContext(),_5=this.projectComponents.getRootEditNode();_4.deselectAllComponents();if(_2!=null&&_2!=_5){_4.selectSingleEditNode(_2)}else if(!_2||_2==_5){var _6=this.getBaseComponent();if(_6){_4.selectSingleEditNode(_6.editNode)}}}
this.setComponentList();this.markDirty();if(!this.$2000){var _7=this.getScreenMockupMode(this.currentScreen),_8=this.projectComponents.getEditNodeTree(),_9=_8.getLength();if(_9==(_7?0:1)){this.showInstructions()}}},isc.A.clearComponent=function isc_VisualBuilder_clearComponent(){if(this.$214s)return;if(this.componentAttributeEditor)this.componentAttributeEditor.clearComponent();if(this.componentMethodEditor)this.componentMethodEditor.clearComponent();if(this.leftStack){this.leftStack.setSectionTitle("componentProperties","Component Properties");if(this.applyButton)this.applyButton.setDisabled(true);if(this.advancedButton)this.advancedButton.setDisabled(true)}},isc.A.refreshComponent=function isc_VisualBuilder_refreshComponent(){var _1=this.getCurrentComponent();this.editComponent(_1,_1.liveObject)},isc.A.switchComponentClass=function isc_VisualBuilder_switchComponentClass(_1){var _2=this.getCurrentComponent(),_3=this.projectComponents.data,_4=_3.getParent(_2),_5=_3.getChildren(_4).indexOf(_2);var _6=this.projectComponents.makeEditNode({type:_1,defaults:_2.defaults});this.projectComponents.removeNode(_2);_6=this.projectComponents.addComponent(_6,_4,_5);if(_6&&_6.liveObject){isc.EditContext.selectCanvasOrFormItem(_6.liveObject,true)}},isc.A.createInstructionsPane=function isc_VisualBuilder_createInstructionsPane(){if(!this.instructionsPane){this.instructionsPane=this.createAutoChild("instructionsPane");this.instructionsPane.setEditMode(true,this.projectComponents);var _1=this.projectComponents,_2=_1.getRootEditNode().liveObject;_2.addPeer(this.instructionsPane);this.instructionsPane.$1515()}},isc.A.showInstructions=function isc_VisualBuilder_showInstructions(){if(!this.instructionsPane)this.createInstructionsPane();var _1=this.projectComponents,_2=_1.getRootEditNode().liveObject;if(_2.isVisible()){this.instructionsPane.moveAbove(_2);this.instructionsPane.moveTo(_2.left+_2.getLeftBorderSize()+_2.getLeftMargin(),_2.top+_2.getTopBorderSize()+_2.getTopMargin());this.instructionsPane.show()}else{_2.$203n=true}},isc.A.hideInstructions=function isc_VisualBuilder_hideInstructions(){if(this.instructionsPane){this.instructionsPane.hide();this.instructionsPane.moveTo(null,-9999);var _1=this.projectComponents,_2=_1.getRootEditNode().liveObject;delete _2.$203n}},isc.A.getCustomComponentsURL=function isc_VisualBuilder_getCustomComponentsURL(){return this.customComponentsURL},isc.A.refreshLibraryComponents=function isc_VisualBuilder_refreshLibraryComponents(_1,_2,_3){if(this.$201c){this.delayCall("refreshLibraryComponents",arguments);return}
var _4=this.getScreenMockupMode(this.currentScreen),_5=this.librarySearch.isSearching();if(!_5&&!_2&&this.paletteDS.mockupMode!=null&&_4==this.paletteDS.mockupMode){if(_1)_1();return}
this.paletteDS.mockupMode=_4;var _6=this,_7={};if(_3)_7.title=_3;else if(_5)this.librarySearch.clearSearch(true);this.libraryComponents.invalidateCache();if(!this.libraryComponents.willFetchData(_7)&&_1){_1();return}
this.$201c=true;this.libraryComponents.fetchData(_7,function(){var _8=_6.libraryComponents.getData();_8.openAll();if(isc.isA.emptyObject(_7)){var _9=_8.findAll("isClosed","true");if(_9&&_9.length){var _10=[];for(var i=0;i<_9.length;i++){var _12=_9[i],_13=_8.getParent(_12);if(_13.isHeader==true||_13.isHeader=="true"){_10.add(_12)}}
_9.removeList(_10);_8.closeFolders(_9)}}
delete _6.$201c;if(_1)_1()},{textMatchStyle:"substring"})},isc.A.showCopyExistingDataSourceUI=function isc_VisualBuilder_showCopyExistingDataSourceUI(){var _1=this;this.loadDataSource("Copy DataSource","Copy DataSource",function(_3,_4){_1.project.getUniqueDataSourceCopyName(_3,function(_5){_4=_4.replace("ID=\""+_3+"\"","ID=\""+_5+"\"");_1.dsDataSource.saveFile({fileName:_5,fileType:"ds",fileFormat:"xml"},_4,function(_6,_4,_7){if(_6.status>=0){isc.ClassFactory.$180h(true);isc.DS.get(_5,function(_8){var _2=isc.DS.get(isc.isAn.Array(_8)?_8[0]:_8);_1.project.addDatasource(_5,_2.serverType);isc.ClassFactory.$180h(null)},{loadParents:true})}},{operationId:"allOwners"})})})});isc.evalBoundary;isc.B.push(isc.A.showLoadSharedDataSourceUI=function isc_VisualBuilder_showLoadSharedDataSourceUI(){var _1=this;this.warnOnce(this.$2099,"Since the selected DataSource will be shared, changes made by any user can affect multiple projects.",function(_4){if(_4){_1.loadDataSource("Add Shared DataSource","Add DataSource",function(_5,_6){isc.ClassFactory.$180h(true);isc.DS.get(_5,function(_7){var _2=isc.DS.get(isc.isAn.Array(_7)?_7[0]:_7);_1.project.addDatasource(_5,_2.serverType);isc.ClassFactory.$180h(null);var _3=_2.hasOwnProperty("mockData")?"mock":"fields";_1.$210g("addSharedDS",_2.ID,_3);_1.loadAllRelatedDataSources(_2,function(_8){if(_8&&_8.length>0){isc.Notify.addMessage("The dataSource "+_7+" has been added, together with the following related dataSources to ensure your data is complete: "+_8.join(", "))}})},{loadParents:true})})}},{buttons:[isc.Dialog.CANCEL,{title:"Continue",width:75,overflow:"visible",click:function(){this.topElement.okClick()}}],autoFocusButton:1})},isc.A.loadDataSource=function isc_VisualBuilder_loadDataSource(_1,_2,_3){if(!this.dataSourcePicker)this.dataSourcePicker=this.createAutoChild('dataSourcePicker',{dataSource:this.dsDataSource});if(_1)this.dataSourcePicker.setTitle(_1);if(_2)this.dataSourcePicker.setActionButtonTitle(_2);this.dataSourcePicker.showLoadFileUI(function(_4,_5,_6){_3(_5.fileName,_5.fileContents)})},isc.A.getDataSourceType=function isc_VisualBuilder_getDataSourceType(_1){var _2=_1.serviceNamespace?"webService":(isc.isA.MockDataSource(_1)?"MockDataSource":_1.serverType||_1.dataFormat);return _2},isc.A.addDataSource=function isc_VisualBuilder_addDataSource(_1,_2){var _3,_4;if(this.dsEditorWindow||_2){if(this.dsEditorWindow)this.dsEditorWindow.hide();if(_1.serverType=="sql"||_1.serverType=="hibernate"){if(this.dsWizard!=null&&this.dsWizard.dsTypeRecord!=null){var _5=this.dsWizard.dsTypeRecord,_6=_5.wizardDefaults,_7=_6?_6.existingTable!="true":true;if(_7){var _8=_6?_6.importSilently=="true":false;if(_8)this.dsImportSilently(_1.ID);else this.showDSImporter(_1.ID,_2)}}}
if(!_2){_3=this.dsEditor.getFieldRenames();_4=this.dsEditor.getFieldAdds()}}
var _9=this.getDataSourceType(_1);this.project.addDatasource(_1.ID,_9);if(_3){var _10=_3;_3={};_3[_1.ID]=_10}
if(_4){var _11=_4;_4=[];_4[_1.ID]=_11}
this.project.rebindCurrentScreenDataSources(_3,_4);if(_2&&this.$200d){this.bindDataSourceToNode(_1,this.$200d);delete this.$200d}
if(_2&&!_7){this.dsWizardComplete(_1.ID)}},isc.A.removeDataSource=function isc_VisualBuilder_removeDataSource(_1){this.project.removeDatasource(_1)},isc.A.dsWizardComplete=function isc_VisualBuilder_dsWizardComplete(_1){isc.Notify.addMessage("Success! New DataSource '"+_1+"' added to your project")},isc.A.clearScreenUI=function isc_VisualBuilder_clearScreenUI(_1){if(this.projectComponents){this.projectComponents.destroyAll();if(!this.currentScreen.mockupMode&&this.initialComponent&&!_1){var _2=isc.addProperties({},this.projectComponents.editContext.findPaletteNode("type",this.initialComponent.type),this.initialComponent);if(this.currentScreen&&this.currentScreen.title){var _3=this.libraryComponents.getPrefixAsId(this.currentScreen.title);if(_3){_2.defaults=isc.addProperties({},_2.defaults,{autoID:_3})}}
var _4=this.projectComponents.makeEditNode(_2);delete _4.defaults.autoDraw;_4.showDropIcon=true;_4._canRemove=false;this.projectComponents.addNode(_4)}
this.projectComponents.resetUndoLog()}},isc.A.getUpdatedJSSource=function isc_VisualBuilder_getUpdatedJSSource(_1){isc.xml.toJSCode(this.getUpdatedSource(),_1)},isc.A.getUpdatedSource=function isc_VisualBuilder_getUpdatedSource(){var _1=this.getScreenMockupMode(this.currentScreen),_2={outputComponentsIndividually:!_1,ignoreConstructor:true,separateComponents:_1};var _3;this.withoutDirtyTracking(function(){_3=this.projectComponents.serializeAllEditNodes(_2)});if(_1){var _4="<MockupContainer>\n",_5=_3.components.trim(),_6=_3.dataSources.trim();if(_6)_4+="<dataSources>\n"+_6+"\n</dataSources>\n";if(_5)_4+="<components>\n"+_5+"\n</components>\n";_3=_4+"</MockupContainer>\n"}
return _3},isc.A.downloadDataSource=function isc_VisualBuilder_downloadDataSource(_1){isc.ClassFactory.$180h(false);var _2=isc.DS.get(isc.isAn.Array(_1)?_1[0]:_1);var _3=this;var _4=this.downloadDataSourceDialogTitle.evalDynamicString(this,{dsID:_2.ID}),_5=this.downloadDataSourceDialogPrompt,_6=this.downloadDataSourceDialogButtonTitle;this.downloadDataSourceDialog=isc.TWindow.create({title:_4,width:500,height:140,isModal:true,showModalMask:true,autoCenter:true,padding:8,items:[isc.Label.create({width:"100%",height:60,padding:8,contents:_5}),isc.DynamicForm.create({width:"100%",numCols:3,items:[{name:"formatType",title:"Format",type:"select",width:"*",defaultValue:"XML",valueMap:["XML","JavaScript"]},{name:"downloadButton",title:_6,type:"button",startRow:false,click:function(){_3.continueDSDownload(_2,this.form.getValue("formatType"))}}]})]});this.downloadDataSourceDialog.show()},isc.A.continueDSDownload=function isc_VisualBuilder_continueDSDownload(_1,_2){this.downloadDataSourceDialog.hide();this.downloadDataSourceDialog.markForDestroy();var _3=this,_4=_1.getClassName(),_5;if(isc.DS.isRegistered(_4)){_5=isc.DS.get(_4)}else{_5=isc.DS.get("DataSource");_1._constructor=_4}
var _6=_5.xmlSerialize(_1);if(_2=="XML"){_3.downloadDataSourceReply(_1,_2,_6)}else{isc.XMLTools.toJSCode(_6,function(_7){_3.downloadDataSourceReply(_1,_2,_7.data)})}},isc.A.downloadDataSourceReply=function isc_VisualBuilder_downloadDataSourceReply(_1,_2,_3){var _4=_1.ID+".ds."+(_2=="XML"?"xml":"js"),_5=(_2=="XML"?"text/xml":"application/json");isc.DMI.callBuiltin({methodName:"downloadClientContent",arguments:[_3,_4,_5],requestParams:{showPrompt:false,useXmlHttpRequest:false,timeout:0}})},isc.A.showDSWizard=function isc_VisualBuilder_showDSWizard(_1,_2){if(_2)this.$200d=_2;this.logDebug("Show DS Wizard: "+this.echo(_1),"dsWizard");if(!this.wizardWindow){var _3=this;this.wizardWindow=isc.TWindow.create({autoDraw:false,title:"DataSource Wizard",autoCenter:true,width:"85%",height:"85%",isModal:true,showModalMask:true,canDragResize:true,builder:_3,closeClick:function(){this.Super("closeClick",arguments);_3.dsWizard.resetWizard();delete _3.$200d},items:[_3.dsWizard=isc.DSWizard.create({callingBuilder:_3,dsDataSource:_3.dsDataSource})]})}
if(_1){this.dsWizard.startAt(_1)}else{this.wizardWindow.show()}},isc.A.isEmbeddedMockDataSource=function isc_VisualBuilder_isEmbeddedMockDataSource(_1){var _2=isc.isAn.Array(_1)?_1[0]:_1,_3=false;if(isc.isA.String(_2)||isc.isA.DataSource(_2)){_2=isc.DS.get(_2)}
if(isc.isA.MockDataSource(_2)){var _4=this.dataSourceList.data.find("ID",_1);_3=(_4!=null&&_4.referenceInProject==false)}
return _3},isc.A.showDSEditor=function isc_VisualBuilder_showDSEditor(_1,_2,_3){isc.ClassFactory.$180h(null);isc.showPrompt("Loading all project datasources... ${loadingImage}");var _4=this;this.loadAllProjectDataSources(function(){isc.clearPrompt();_4.$212t(_1,_2,_3)})},isc.A.$212t=function isc_VisualBuilder__showDSEditor(_1,_2,_3){if(this.isEmbeddedMockDataSource(_1)){isc.warn("Edit embedded MockDataSources by editing ListGrids where they are used");return}
var _4=isc.isAn.Array(_1)?_1[0]:_1;if(isc.isA.String(_4)||isc.isA.DataSource(_4)){_4=isc.DS.get(_4)}
if(!_4)return;if(!isc.isA.String(_1))_1=_4.ID;var _5=(_4.wizardDefaults?_4.wizardDefaults.importData:null);var _6=this,_7=function(_4,_20){if(_6.dsEditorWindow)_6.dsEditorWindow.hide();if(_6.project.isReadOnly()){if(_20){_20=isc.DS.get(_20);_6.delayCall("$212t",[_20])}
else isc.warn("Project is read-only so DataSource changes are being ignored.");return}
_6.withoutAutoSaving(function(){if(_1!=_4.ID){_6.removeDataSource(_1);_6.project.addDatasource(_4.ID,_6.getDataSourceType(_4))}else{_6.addDataSource(_4,_2)}
if(_2&&_4){var _8=_4.hasOwnProperty("mockData")?"mock":"fields";_6.$210g("createDataSource",_4.ID,_8)}
if(_5){var _9=_5.fileType,_10=(_9=="XML"?"xml":(_9=="JSON"?"js":"csv")),_11=_5.rawData;if(_9=="JSON"){_11="var "+_4.ID+"TestData = "+isc.JSON.encode(_5.guessedRecords)+";"}
_6.dsDataSource.saveFile({fileName:"test_data/"+_4.ID,fileType:"data",fileFormat:_10},_11,null,{operationId:"allOwners"})}
if(_1&&_1!=_4.ID){var _12=_6.dsEditor.getFieldRenames();_6.project.renameDataSource(_1,_4.ID,_12)}else{_6.project.delayCall("autoSaveSoon")}});if(_20)_6.delayCall("$212t",[_20])};var _13=null;if(_4.wizardDefaults){_13={};for(var i=0;i<this.dsEditorPropertyNames.length;i++){var _15=this.dsEditorPropertyNames[i],_16=_4.wizardDefaults[_15],_17;if(_16!=null&&isc.isA.String(_16)){var _18=_16.toLowerCase();if(_18=="true"||_18=="false"){_16=(_18=="true")}}
if(_16!=_17)_13[_15]=_16}}else if(isc.isA.MockDataSource(_4)){_13={autoAddPK:true,canAddChildSchema:false,showMoreButton:false,showLegalValuesButton:true}}
if(!_2){if(!_13)_13={};_13.ownerId=this.project.getOwnerId()}
if(this.logIsDebugEnabled("dsWizard")){this.logDebug("DS Editor properties: "+this.echoFull(_13),"dsWizard")}
this.makeDSEditor(_13,_5,_2,_4);if(_2)this.dsEditor.editNew(_4,_7,_3);else this.dsEditor.editSaved(_4,_7,_3);this.dsEditor.setKnownDataSources(this.dataSourceList.data);if(this.project.isReadOnly())this.dsEditor.readOnly=true;var _19=(_4.wizardDefaults?_4.wizardDefaults.showDSEditor:null)||true;if(isc.isA.String(_19))_19=(_19.toLowerCase()!="false");if(_19)this.dsEditorWindow.show();else this.dsEditor.save()},isc.A.makeDSEditor=function isc_VisualBuilder_makeDSEditor(_1,_2,_3,_4){if(!_1)_1={};if(this.dsEditor){this.dsEditor.destroy();this.dsEditorWindow.destroy()}
var _5=this;if((_3&&!isc.isA.DataSource(_4)&&_4.defaults&&_4.defaults._constructor=="MockDataSource")||(!_3&&isc.isA.MockDataSource(_4)&&_4.hasExplicitFields()))
{_1.editSampleData=true}
_1.enableRelationEditor=this.enableRelationEditor;if(_2&&_2.guessedRecords){this.$1996(_1,_2)}else{this.$1997(_1)}
this.dsEditorWindow=isc.Window.create({title:"DataSource Editor",autoDraw:false,visibility:"hidden",builder:this,isModal:true,showModalMask:true,autoCenter:true,width:"85%",height:"85%",canDragResize:true,closeClick:function(){this.Super("closeClick",arguments);delete _5.$200d},items:[this.dsEditor]})},isc.A.$1997=function isc_VisualBuilder__makeBasicDSEditor(_1){var _2=this;this.dsEditor=isc.DataSourceEditor.create({dataSource:"DataSource",dsDataSource:this.dsDataSource,width:"100%",height:"80%",autoDraw:false,canAddChildSchema:true,canEditChildSchema:true,builder:_2,mainStackProperties:{_constructor:"TSectionStack"},instructionsProperties:{_constructor:"THTMLFlow"},mainEditorProperties:{_constructor:"TComponentEditor",formConstructor:isc.TComponentEditor},fieldLayoutProperties:{_constructor:"TLayout"},getUniqueDataSourceID:function(_6){var _3="dataSource";var _4={fileName:_3,firstFileName:_3+"1",fileType:"ds",fileFormat:"xml"};_2.dsDataSource.uniqueName(_4,function(_7,_8,_9){if(_8){var _5=_8.fileName;_2.dsDataSource.removeFile(_8,function(){_6(_5)});return}
isc.Notify.addMessage("Unable to obtain a new unique data source name");_6()})}},_1)},isc.A.$1996=function isc_VisualBuilder__makeParsedDSEditor(_1,_2){var _3=isc.addProperties({},{dataSource:"DataSource",dsDataSource:this.dsDataSource,builder:_7,getUniqueDataSourceID:function(_8){var _4="dataSource";var _5={fileName:_4,firstFileName:_4+"1",fileType:"ds",fileFormat:"xml"};_7.dsDataSource.uniqueName(_5,function(_9,_10,_11){if(_10){var _6=_10.fileName;_7.dsDataSource.removeFile(_10,function(){_8(_6)});return}
isc.Notify.addMessage("Unable to obtain a new unique data source name");_8()})}},_1);var _7=this;this.dsEditor=isc.ParsedDataDSEditor.create({width:"100%",height:"80%",autoDraw:false,fileType:_2.fileType,rawData:_2.rawData,dsProperties:_2.dsProperties,dsEditorPaneProperties:_3})},isc.A.showDSImporter=function isc_VisualBuilder_showDSImporter(_1,_2){this.makeDSImporter(_1);this.dsImporterWindow.fromWizard=_2;this.dsImporterWindow.show()},isc.A.dsImportSilently=function isc_VisualBuilder_dsImportSilently(_1,_2){var _3=this,_4=[_1],_5=false;if(_2==null)_2=true;isc.DMI.call({appID:"isc_builtin",className:"com.isomorphic.tools.AdminConsole",methodName:"importDataSources",arguments:[_4,_2,_5],requestParams:{prompt:"Importing Datasource - This may take a few minutes.",showPrompt:true,promptStyle:"dialog"},callback:function(){_3.dsWizardComplete(_1)}})},isc.A.makeDSImporter=function isc_VisualBuilder_makeDSImporter(_1){var _2=this;if(!this.dsImporter){this.dsImporter=isc.DynamicForm.create({autoDraw:false,width:"100%",numCols:1,fields:[{name:"createTable",type:"boolean",title:"Create (or replace) table",showTitle:false,changed:function(_8,_9,_10){_8.getItem("importTestData").setDisabled(!_10)}},{name:"importTestData",type:"boolean",title:"Import test data",showTitle:false}]})}
this.dsImporter.setValues({createTable:true,importTestData:true});if(this.dsImporterWindow){this.dsImporterWindow.dsID=_1;return}
var _3=isc.Label.create({autoDraw:false,width:"100%",height:1,overflow:"visible",contents:"Finalize DataSource creation with what operations?"});var _4=isc.IButton.create({autoDraw:false,title:"Done",autoFit:true,click:function(){var _5=_2.dsImporter.getValues();if(!_5.createTable){_2.dsImporterWindow.closeClick()}else{_2.dsImporterWindow.close();_2.dsImportSilently(_2.dsImporterWindow.dsID,_5.importTestData)}}});var _6=isc.HLayout.create({autoDraw:false,height:30,membersMargin:10});_6.addMembers([isc.LayoutSpacer.create(),_4]);var _7=isc.VLayout.create({width:"100%",padding:5,membersMargin:10,members:[_3,this.dsImporter,_6]});this.dsImporterWindow=isc.Window.create({title:"Import DataSource",autoDraw:true,builder:this,dsID:_1,isModal:true,showModalMask:true,autoCenter:true,width:300,height:165,canDragResize:true,items:[_7],closeClick:function(){this.Super("closeClick",arguments);if(this.fromWizard&&this.dsID){this.builder.dsWizardComplete(this.dsID)}}})},isc.A.showRelationEditor=function isc_VisualBuilder_showRelationEditor(_1){isc.ClassFactory.$180h(null);isc.showPrompt("Loading all project datasources... ${loadingImage}");var _2=this;this.loadAllProjectDataSources(function(){isc.clearPrompt();if(_2.isEmbeddedMockDataSource(_1.ID)){isc.warn("Edit embedded MockDataSources by editing ListGrids where they are used");return}
_2.$2108(_1)})},isc.A.$2108=function isc_VisualBuilder__showRelationEditor(_1){if(isc.isA.String(_1)||isc.isA.DataSource(_1)){_1=isc.DS.get(_1)}
if(!_1)return;var _2=this,_3=function(){if(_2.relationEditorWindow)_2.relationEditorWindow.hide();if(_2.project.isReadOnly()){isc.warn("Project is read-only so DataSource relation changes are being ignored.");return}
_2.relationEditor.save(true,function(_5){for(var i=0;i<_5.length;i++){_2.addDataSource(isc.DS.get(_5[i]))}
_2.relationEditor.showNewRelationNotifications(null,null,function(_7){if(_7)_2.delayCall("$212t",[_7])})})};this.makeRelationEditor(_1);var _5=[];this.dataSourceList.data.map(function(_7){if(!_7)return;var _6=isc.DS.get(_7.ID);_5.add(_6)});this.relationEditor.setKnownDataSources(_5);if(this.project.isReadOnly())this.relationEditor.readOnly=true;this.relationEditor.edit(_1,_3);this.relationEditorWindow.show()},isc.A.makeRelationEditor=function isc_VisualBuilder_makeRelationEditor(_1){if(this.relationEditorWindow){this.relationEditorWindow.setTitle("Relations for DataSource '"+_1.ID+"'");return}
this.relationEditor=isc.RelationEditor.create({autoDraw:false,width:850,dsDataSource:this.dsDataSource,ownerId:this.project.ownerId});this.relationEditorWindow=isc.Window.create({title:"Relations for DataSource '"+_1.ID+"'",autoDraw:false,visibility:"hidden",builder:this,isModal:true,showModalMask:true,autoCenter:true,autoSize:true,canDragResize:true,closeClick:function(){this.Super("closeClick",arguments)},items:[this.relationEditor]})},isc.A.showSimpleTreeRelationEditor=function isc_VisualBuilder_showSimpleTreeRelationEditor(_1,_2){if(isc.isA.String(_1)||isc.isA.DataSource(_1)){_1=isc.DS.get(_1)}
if(!_1)return;var _3=this,_4=function(){if(_3.simpleTreeRelationEditorWindow)_3.simpleTreeRelationEditorWindow.hide();_3.simpleTreeRelationEditor.save(function(_6){for(var i=0;i<_6.length;i++){_3.addDataSource(isc.DS.get(_6[i]))}
_2()})};this.makeSimpleTreeRelationEditor(_1);this.simpleTreeRelationEditor.edit(_1,_4);this.simpleTreeRelationEditorWindow.show()},isc.A.makeSimpleTreeRelationEditor=function isc_VisualBuilder_makeSimpleTreeRelationEditor(_1){if(this.simpleTreeRelationEditorWindow){this.simpleTreeRelationEditorWindow.setTitle("Relations for DataSource '"+_1.ID+"'");return}
this.simpleTreeRelationEditor=isc.SimpleTreeRelationEditor.create({autoDraw:false,width:500,dsDataSource:this.dsDataSource,ownerId:this.project.ownerId});this.simpleTreeRelationEditorWindow=isc.Window.create({title:"Define Tree Relation for DataSource '"+_1.ID+"'",autoDraw:false,visibility:"hidden",builder:this,isModal:true,showModalMask:true,autoCenter:true,autoSize:true,canDragResize:true,closeClick:function(){this.Super("closeClick",arguments)},items:[this.simpleTreeRelationEditor]})},isc.A.saveDSToFile=function isc_VisualBuilder_saveDSToFile(_1,_2){isc.ClassFactory.$180h(null);var _3=isc.isAn.Array(_1)?_1[0]:_1;if(isc.isA.String(_3)||isc.isA.DataSource(_3)){_3=isc.DS.get(_3)}
var _4=this,_5=_3.getClassName(),_6;if(isc.DS.isRegistered(_5)){_6=isc.DS.get(_5)}else{_6=isc.DS.get("DataSource");_3._constructor=_5}
var _7=_6.xmlSerialize(_3);this.dsDataSource.saveFile({fileName:_1,fileType:"ds",fileFormat:"xml"},_7,function(){delete _2.referenceInProject;_4.dataSourceList.removeData(_2);_4.project.addDatasource(_1,_2.dsType);if(isc.isA.MockDataSource(_3)){var _8=_4.projectComponents.editContext.getEditNodeArray(),_9=false;for(var i=0;i<_8.length;i++){var _11=_8[i];if(_11.ID==_1){_11.referenceInProject=true;_9=true}}
if(_9){_4.markDirty()}}
_4.project.autoSaveSoon()},{operationId:"allOwners"})},isc.A.offerBinding=function isc_VisualBuilder_offerBinding(_1){this.makeOfferBindingDialog(_1);this.showOfferBinding(_1.liveObject)},isc.A.showOfferBinding=function isc_VisualBuilder_showOfferBinding(_1){if(!_1.isDrawn()){if(!this.isObserving(_1,"draw")){this.observe(_1,"draw","observer.showOfferBinding(observed)")}
this.offerBindingWindow.hide();return}
if(this.isObserving(_1,"draw")){this.ignore(_1,"draw")}
this.$200e(_1)},isc.A.$200e=function isc_VisualBuilder__showOfferBinding(_1){if(_1.getTop()<0){if(!this.isObserving(_1,"moved")){this.observe(_1,"moved","observer.$200e(observed)")}
return}
if(this.isObserving(_1,"moved")){this.ignore(_1,"moved")}
var _2=this.offerBindingWindow;var _3=_2.getVisibleWidth(),_4=_2.getVisibleHeight(),_5=((_1.getWidth()-_3)/2)+Math.max(0,_1.getScrollLeft()),_6=((_1.getHeight()-_4)/2)+Math.max(0,_1.getScrollTop());_5=Math.round(_5);_6=Math.max(Math.round(_6),0);_2.placeNear(_5+_1.getPageLeft(),_6+_1.getPageTop());_2.show()},isc.A.makeOfferBindingDialog=function isc_VisualBuilder_makeOfferBindingDialog(_1){var _2=_1.liveObject;var _3=this;if(this.offerBindingForm)this.offerBindingForm.markForDestroy();var _4=(isc.isA.ListGrid(_2)?"gridDropBindingDialog":"formDropBindingDialog");var _5=this.project.datasources,_6=[];for(var i=0;i<_5.length;i++){_6.add(_5[i].dsName)}
_6.sort();var _8=this.$200c,_9=[];for(var i=0;i<_8.length;i++){var _10=_8[i];if(_10.canSelect=="false")continue;_9.add(_10.title)}
this.offerBindingForm=this.createAutoChild(_4,{targetDataSources:_6,targetDSWizards:_9});if(this.offerBindingWindow)this.offerBindingWindow.markForDestroy();var _11=isc.IButton.create({title:"Submit",autoFit:true,click:function(){var _12=_3.offerBindingForm;if(!_12.validate())return;_3.offerBindingWindow.hide();var _13=_12.getValues();if(_13.doNothing)return;if(_13.bindToDataSource){var _14=_13.dataSource;var _15=_3.dataSourceList.data.find("ID",_14);if(!_15)return;var _16=_3.dataSourceList.makeEditNode(_15);_16.dropped=true;_16.liveObject=isc.DS.get(_14);var _17=_3.projectComponents,_18=_17.getEditContext();_18.addNode(_16,_1,0)}else if(_13.createDataSource){var _8=_3.$200c,_19=_13.dsWizard,_20;if(_19){_20=_8.find("title",_19);if(!_20){isc.warn("New DataSource wizard '"+_19+"' not found");return}}
_3.showDSWizard(_20,_1)}}});var _21=isc.HLayout.create({height:30,membersMargin:10});_21.addMembers([isc.LayoutSpacer.create(),_11]);var _22=isc.VLayout.create({width:400,padding:5,members:[this.offerBindingForm,_21]});var _23=(isc.isA.ListGrid(_2)?"How do you want to provide data for this grid?":"How do you want to define the fields for this form?");this.offerBindingWindow=isc.Window.create({title:_23,autoDraw:true,top:-500,left:-1000,showCloseButton:false,showMinimizeButton:false,builder:this,isModal:true,showModalMask:true,autoSize:true,items:[_22]})},isc.A.bindDataSourceToNode=function isc_VisualBuilder_bindDataSourceToNode(_1,_2){var _3=this.dataSourceList.data.find("ID",_1.ID);if(!_3)return;var _4=this.dataSourceList.makeEditNode(_3);_4.liveObject=_1;_4.dropped=true;var _5=this.projectComponents,_6=_5.getEditContext();_6.addNode(_4,_2,0);this.lastUsedDataSource=_1.ID},isc.A.hideRightMostResizeBar=function isc_VisualBuilder_hideRightMostResizeBar(){this.workspace.getMember(this.workspace.getMembers().length-1).showResizeBar=false},isc.A.addOperation=function isc_VisualBuilder_addOperation(){if(!this.schemaWindow){this.schemaWindow=isc.TWindow.create({title:this.schemaWindowTitle||"Webservice Operations",autoCenter:true,autoDraw:false,width:Math.round(this.width*.6),height:Math.round(this.height*.9),items:[this.addAutoChild("schemaViewer"),this.addAutoChild("schemaViewerSelectButton")]})}
this.getOperationsTreeData(this.getID()+".addOperationReply(data)")},isc.A.addOperationReply=function isc_VisualBuilder_addOperationReply(_1){this.schemaViewer.setData(isc.Tree.create({modelType:"children",root:_1,nameProperty:"name",childrenProperty:"children"}));this.schemaViewer.getData().openAll();this.schemaWindow.show()},isc.A.operationSelected=function isc_VisualBuilder_operationSelected(){var _1=this.schemaViewer.data,_2=this.schemaViewer.getSelectedRecord();if(_2!=null){if(_2.serviceType=="service")_2=_1.getChildren(_2)[0];if(_2.serviceType=="portType")_2=_1.getChildren(_2)[0];var _3=_1.getParent(_2);var _4=_1.getParent(_3);var _5=_2.location||_3.location||_4.location;var _6=this.projectComponents.data;_5=this.getOperationWSDLLocation(_5);var _7=this;this.loadWebService(_5,_4.name,_3.name,_2.name)}},isc.A.getOperationWSDLLocation=function isc_VisualBuilder_getOperationWSDLLocation(_1){return _1},isc.A.loadWebService=function isc_VisualBuilder_loadWebService(_1,_2,_3,_4){var _5=this;isc.xml.loadWSDL(_1,function(_6){_5.newServiceLoaded(_6,_2,_3,_4,_1)},null,true)},isc.A.newServiceLoaded=function isc_VisualBuilder_newServiceLoaded(_1,_2,_3,_4,_5){var _6={operationName:_4,serviceNamespace:_1.serviceNamespace,serviceName:_1.name,serviceDescription:_2,portTypeName:_3,location:_5};this.addWebService(_1,_6);this.schemaWindow.hide()},isc.A.getOperationsTreeData=function isc_VisualBuilder_getOperationsTreeData(){var _1=this.operationsPalette,_2=_1?_1.data:null,_3=_2?_2.getChildren(_2.getRoot()):null;return _3},isc.A.trimOperationsTreeData=function isc_VisualBuilder_trimOperationsTreeData(_1,_2){if(!_1)return null;var _3=_2?"message_in":"message_out",_4=isc.addProperties({},_1),_5=false;while(!_5){var _6=_4.find("serviceType",_3);if(_6){_4.remove(_6)}else _5=true}
return _4},isc.A.addWebService=function isc_VisualBuilder_addWebService(_1,_2){var _3={};_3.webService=_1;_3.inputSchema=_1.getRequestMessage(_2.operationName);_3.outputSchema=_1.getResponseMessage(_2.operationName);_2.inputSchema=_3.inputSchema;_2.outputSchema=_3.outputSchema;var _4=this.addServiceOperation(_2);var _5=this.getComplexOperationsPaletteTreeData(),_6="|"+_2.serviceDescription+"|"+_2.portTypeName+"|"+_2.operationName,_7;if(this.operationsPalette.getData()){_7=isc.Tree.create({root:this.operationsPalette.getData().getRoot()})}else{_7=isc.Tree.create({})}
_5.pathDelim="|";_7.pathDelim="|";if(_7.find(_6)){this.logWarn("Attempting to add webservice operation that is already in the tree");this.schemaWindow.hide();return}
var _8;if(_4){_8={name:_2.operationName,serviceType:"operation",type:"IButton",defaults:{title:"Invoke "+_2.operationName,autoFit:true,click:{target:_4.liveObject.ID,name:"invoke",title:"Invoke "+_2.operationName}}}}else{_8={name:_2.operationName,serviceType:"operation",canDrag:false}}
_6="|"+_2.serviceDescription+"|"+_2.portTypeName;var _9=_7.find(_6);var _10=false;if(_9){_7.add(_8,_9);_10=true;this.operationsPalette.setData(_7)}else{_6="|"+_2.serviceDescription;var _9=_7.find(_6);var _10=false;if(_9){_7.add({name:_2.portTypeName,serviceType:"portType",canDrag:false,children:[_8]},_9);_10=true}else{var _11={name:_2.serviceDescription,serviceType:"service",canDrag:false,children:[{name:_2.portTypeName,serviceType:"portType",canDrag:false,children:[_8]}]}}
_5.children.add(_11);this.operationsPalette.setData(isc.Tree.create({modelType:"children",root:_5,nameProperty:"name",childrenProperty:"children"}))}
var _6="|"+_2.serviceDescription+"|"+_2.portTypeName+"|"+_2.operationName,_9=_7.find(_6);var _12={palette:this.operationsPalette,isOutput:false,operation:_2.operationName,serviceName:_2.serviceName,serviceNamespace:_2.serviceNamespace};if(_3.inputSchema){this.setSchema(_3.inputSchema,_9,null,"",_12)}
if(_3.outputSchema){_12.isOutput=true;this.setSchema(_3.outputSchema,_9,null,"",_12)}
this.operationsPalette.getData().openAll()},isc.A.addServiceOperation=function isc_VisualBuilder_addServiceOperation(_1){var _2,_3;if(_1.inputSchema){_2={type:"ValuesManager",defaults:{parentProperty:"inputVM",dataSource:_1.inputSchema.ID,serviceName:_1.serviceName,serviceNamespace:_1.serviceNamespace}}}
if(_1.outputSchema){_3={type:"ValuesManager",defaults:{parentProperty:"outputVM",dataSource:_1.outputSchema.ID,serviceName:_1.serviceName,serviceNamespace:_1.serviceNamespace}}}
var _4={type:"ServiceOperation",defaults:{operationName:_1.operationName,serviceNamespace:_1.serviceNamespace,serviceName:_1.serviceName,serviceDescription:_1.serviceDescription,portTypeName:_1.portTypeName,location:_1.location}};var _5=this.projectComponents;var _6=_5.makeEditNode(_4);_5.addNode(_6);if(_2)_5.addNode(_5.makeEditNode(_2),_6,null,"inputVM");if(_3)_5.addNode(_5.makeEditNode(_3),_6,null,"outputVM");return _6},isc.A.shouldShowDataPathFields=function isc_VisualBuilder_shouldShowDataPathFields(){return this.operationsPalette?true:false},isc.A.getComplexOperationsPaletteTreeData=function isc_VisualBuilder_getComplexOperationsPaletteTreeData(){if(!this.operationsPalette||!this.operationsPalette.data)return{children:[]};var _1=this.operationsPalette.data,_2=_1.getChildren(_1.getRoot());return{children:_2}},isc.A.setSchema=function isc_VisualBuilder_setSchema(_1,_2,_3,_4,_5){var _6=_5.populateTarget&&this.targetContext!=null;var _7=_1.getFieldNames();for(var i=0;i<_7.length;i++){var _9=_7[i],_10=_1.getField(_9),_11=_1.fieldIsComplexType(_9),_12;var _13=this.getFieldPaletteNode(_1,_9,_4,_5);var _14=_5.palette.data;_14.add(_13,_2||_14.getRoot());if(_6&&_3&&_3.type==this.complexTypeNodeConstructor){var _15=null;if(_11){var _16={};isc.addProperties(_16,this.canvasItemWrapperDefaults);isc.addProperties(_16,this.canvasItemWrapperProperties);_15=_5.palette.makeEditNode({type:this.canvasItemWrapperConstructor,defaults:_16});this.targetContext.addNode(_15,_3)}
var _17=_5.palette.makeEditNode(_13);this.targetContext.addNode(_17,_15||_3);if(isc.EditContext)isc.EditContext.clearSchemaProperties(_17)}
if(_11){var _18=_1.getSchema(_10.type);this.setSchema(_18,_13,_17,(_4?_4+"/":"")+_9,_5)}}});isc.evalBoundary;isc.B.push(isc.A.getFieldPaletteNode=function isc_VisualBuilder_getFieldPaletteNode(_1,_2,_3,_4){var _5=_1.fieldIsComplexType(_2),_6=_1.getField(_2),_7=_4.isOutput,_8=_4.displayOnly!=null?_4.displayOnly:_7,_9=this.getSchemaDataSourceIDs(_4.operation,_4.serviceName,_4.serviceNamespace),_10={schemaDataSource:_7?_9.output:_9.input,serviceNamespace:_4.serviceNamespace,serviceName:_4.serviceName,isComplexType:_5,type:_5?"complexType":"simpleType"},_11=isc.DataSource.getAutoTitle(_2),_12={name:_2,defaults:_10},_13=(_3?_3+"/":"")+_2;_10.dataPath=_13;if(_8){_10.inputDataPath=_13;_10.inputSchemaDataSource=_10.schemaDataSource;_10.inputServiceNamespace=_10.serviceNamespace;_10.inputServiceName=_10.serviceName}
if(_8)_10.canEdit=false;var _14=_6.xmlMaxOccurs;if(_14=="unbounded")_14=1000;if(!_5){_12=this.getSimpleTypeNode(_12,_8,_11)}else{_10.dataSource=_10.schemaDataSource;delete _10.schemaDataSource;if(_14==null||_14<=1){_12=this.getComplexTypeNode(_12,_8,_11)}else{_12=this.getRepeatingComplexTypeNode(_12,_14,_8,_1,_6.type,_11)}}
_12.title=_10.title;_12.type=_10.type;return _12},isc.A.getSimpleTypeNode=function isc_VisualBuilder_getSimpleTypeNode(_1,_2,_3){_1.type=this.simpleTypeNodeConstructor;_1.defaults.title=_3;isc.addProperties(_1.defaults,this.simpleTypeNodeDefaults);isc.addProperties(_1.defaults,this.simpleTypeNodeProperties);return _1},isc.A.getComplexTypeNode=function isc_VisualBuilder_getComplexTypeNode(_1,_2,_3){_1.type=this.complexTypeNodeConstructor;delete _1.defaults.dataPath;delete _1.defaults.inputDataPath;_1.defaults.groupTitle=_3;isc.addProperties(_1.defaults,this.complexTypeNodeDefaults);isc.addProperties(_1.defaults,this.complexTypeNodeProperties);return _1},isc.A.getRepeatingComplexTypeNode=function isc_VisualBuilder_getRepeatingComplexTypeNode(_1,_2,_3,_4,_5,_6){if(_2<5&&_3){_1.type="DetailViewer"}else{_1.type=(_3?"ListGrid":"LineEditor")}
var _7=_4.getSchema(_5);var _8=_3?"inputDataPath":"dataPath";if(_3){_1.defaults.height=80;_1.defaults.autoFitMaxRecords=10;_1.defaults.canDragSelectText=true}else{_1.defaults.saveLocally=true}
var _9=_7.getFlattenedFields(null,_1.defaults.dataPath,_8);_9=isc.getValues(_9);_9=isc.applyMask(_9,["name","title","dataPath","inputDataPath"]);_1.defaults.defaultFields=_9;isc.addProperties(_1.defaults,this.repeatingComplexTypeNodeDefaults);isc.addProperties(_1.defaults,this.repeatingComplexTypeNodeProperties);return _1},isc.A.getSchemaDataSourceIDs=function isc_VisualBuilder_getSchemaDataSourceIDs(_1,_2,_3){var _4={};var _5=isc.ServiceOperation.getServiceOperation(_1,_2,_3);if(_5){if(_5.inputVM){_4.input=isc.DataSource.get(_5.inputVM.dataSource).ID}
if(_5.outputVM){_4.output=isc.DataSource.get(_5.outputVM.dataSource).ID}}
return _4},isc.A.getBaseComponent=function isc_VisualBuilder_getBaseComponent(){var _1=this.projectComponents.data,_2=_1.getChildren(_1.getRoot());if(_2.length==1)return _2[0].liveObject;var _3=null;for(var i=_2.length-1;i>=0;i--){var _5=_2[i].liveObject;if(!isc.isA.Canvas(_5))continue;if(_5.visibility!=isc.Canvas.HIDDEN&&(!Object.getOwnPropertyNames(_5).contains("autoDraw")||_5.$216x||_5.autoDraw!==false))
{return _5}else if(!_3){_3=_5}}
return _3},isc.A.getBaseOrRootComponent=function isc_VisualBuilder_getBaseOrRootComponent(){var _1=this.getScreenMockupMode(this.currentScreen);return(_1?this.rootLiveObject:this.getBaseComponent())},isc.A.getTargetRuleScope=function isc_VisualBuilder_getTargetRuleScope(){return this.getBaseComponent()},isc.A.$209d=function isc_VisualBuilder__startCapturingErrorReports(){var _1=this.clickStream;var _2=this.errorDataSource=isc.DS.get(this.errorDataSource||"hostedErrorReports");if(_2){_1.setEventErrorListener({target:this,methodName:"$209e"});this.logInfo("JS errors will now log reports with context to hostedErrorReports DS")}else{this.logWarn("No ClickStream available.  Unable to log JavaScript error reports")}},isc.A.$209e=function isc_VisualBuilder__reportEventError(_1){var _2=this.errorDataSource,_3=this.clickStream,_4={sessionStart:_3.getStartTime(),errorTime:new Date(),userId:this.userId};var _5=this.currentScreen;if(_5)isc.addProperties(_4,{currentScreen:_5.fileName,screenLoadVersion:isc.DateUtil.parseSchemaDate(_5.lastLoadVersion),screenSaveVersion:isc.DateUtil.parseSchemaDate(_5.lastSaveVersion)});var _6=this.project;if(_6)isc.addProperties(_4,{currentProject:_6.fileName,projectLoadVersion:isc.DateUtil.parseSchemaDate(_6.lastLoadVersion),projectSaveVersion:isc.DateUtil.parseSchemaDate(_6.lastSaveVersion)});var _7="",_8=this.projectComponents;try{var _9=_8.getSelectedRecord();if(_9)_4.selectedComponent=_9.ID}catch(e){var _10=(e.stack||e).toString();_7="Got exception while getting selectedRecord: "+_10}
try{var _11=_8.getCleanComponentData(),_12=isc.JSON.encode(_11),_13=_2.getField("componentTree").length;if(_13&&_12.length>_13){_12=_12.substring(0,_13)}
_4.componentTree=_12}catch(e){var _10=(e.stack||e).toString();if(_7)_7+="\n";_7+="Got exception while getting componentTree: "+_10}
var _14=_1.events.last();if(_14){var _15=_14.errorTrace,_16=_2.getField("errorTrace").length;if(_15&&_15.length>_16){_15=_15.substring(0,_16)}
_4.errorTrace=_15;_14=isc.addProperties({},_14);_1.events[_1.events.length-1]=_14;delete _14.errorTrace}
var _17,_18=_2.getField("clickStream").length,_19=isc.JSONEncoder.create({dateFormat:"dateConstructor"});for(var _20=_1.events;_20.length>0;_1.events=_20){_17=_19.encode(_1);if(_17.length<=_18)break;_20=_20.slice(-Math.floor(_20.length/2))}
_4.clickStream=_17;_2.addData(_4,null,{showPrompt:false})},isc.A.$210i=function isc_VisualBuilder__startCapturingUsageData(){var _1=this.usageDataSource=isc.DS.get(this.usageDataSource||"hostedUsageData");if(_1){var _2=this;this.observe(isc.RPCManager,"handleLoginSuccess",function(){_2.$210g("relogin",_2.getSessionLengthInSeconds())});this.logInfo("Capturing usage data to DS "+_1.getID())}else this.logWarn("Unable to capture usage data; the DS could not be loaded")},isc.A.$210g=function isc_VisualBuilder__addUsageRecord(_1,_2,_3){var _4=this.usageDataSource;if(!_4)return;if(_2!=null&&!isc.isA.String(_2))_2=_2.toString();if(_3!=null&&!isc.isA.String(_3))_3=_3.toString();_4.addData({timeStamp:new Date(),userId:this.userId,organization:this.organization,action:_1,data:_2,data2:_3},null,{showPrompt:false})},isc.A.getSessionLengthInSeconds=function isc_VisualBuilder_getSessionLengthInSeconds(){var _1=this.clickStream;if(!_1)return null;return Math.floor((new Date()-_1.getStartTime())/1000)},isc.A.startTrackingSessionTimeout=function isc_VisualBuilder_startTrackingSessionTimeout(){var _1=this,_2=this.sessionTimeout;isc.RPCManager.addClassProperties({transformResponse:function(_3,_4,_5){if(_1.$217a)isc.Timer.clear(_1.$217a);_1.$217a=isc.Timer.setTimeout({action:"isc.RPCManager.handleSessionTimeout()",delay:_2+1,units:isc.Timer.SEC},null,null,true);return _3},handleSessionTimeout:function(){this.logInfo("session has expired; forcing re-authenication");if(isc.RPCManager.loginRequired)isc.RPCManager.loginRequired()}})},isc.A.startMonitoringServer=function isc_VisualBuilder_startMonitoringServer(){var _1=this.serverReconnectWindow=this.createAutoChild("serverReconnectWindow");if(this.logIsDebugEnabled("serverCommLoss")){this.logDebug("installing hooks to monitor the server connection","serverCommLoss")}
var _2=this;isc.RPCManager.addClassProperties({handleTransportError:function(_3,_4,_5,_6){if(this.$216y(_5)){if(_2.ignoreServerCommLoss)return;if(_2.logIsDebugEnabled("serverCommLoss")){_2.logDebug("transaction "+_3+" failed with http status: "+_5+(_6?" and text '"+_6+"'":""),"serverCommLoss")}
_1.handleServerCommLoss("transportError")}else{if(_2.ignoreProgramErrors)return;_2.logWarn("Scheduling page reload due to transport error with http response code: "+_5+". response text:\n"+_6);_2.handleProgramError()}
return false},handleError:function(_3,_4){if(_3.status!=isc.RPCResponse.STATUS_SERVER_TIMEOUT||_2.ignoreServerCommLoss)
{return this.runDefaultErrorHandling(_3,_4)}
_1.handleServerCommLoss("timeoutError");_1.serverTimeoutError={response:_3,request:_4}}});_1.observe(isc.Offline,"nativeOffline",function(){_1.handleServerCommLoss("nativeOffline")});_1.observe(isc.RPCManager,"$39b",function(){_1.handleServerCommLoss("txTimeout")})},isc.A.handleProgramError=function isc_VisualBuilder_handleProgramError(_1){if(this.ignoreProgramErrors)return;if(this.$214t){var _2=this.$214t;delete this.$214t;this.removeRecentProject(_2);this.showFailedProjectLoadWindow()}else{this.showPageReloadWindow()}},isc.A.showFailedProjectLoadWindow=function isc_VisualBuilder_showFailedProjectLoadWindow(){var _1=this.failedLoadWindow;if(_1==null||_1.destroyed){_1=this.failedLoadWindow=this.createAutoChild("failedLoadWindow")}
var _2=this.failedLoadView;if(_2==null||_2.destroyed){_2=this.failedLoadView=this.createAutoChild("failedLoadView")}
_1.addItem(_2);_1.show()},isc.A.showPageReloadWindow=function isc_VisualBuilder_showPageReloadWindow(){var _1=this.pageReloadWindow;if(_1==null||_1.destroyed){_1=this.pageReloadWindow=this.createAutoChild("pageReloadWindow")}
var _2=this.pageReloadView;if(_2==null||_2.destroyed){_2=this.pageReloadView=this.createAutoChild("pageReloadView")}
_1.addItem(_2);_1.show()});isc.B._maxIndex=isc.C+252;isc.defineClass("VBFailedLoadView","VStack");isc.A=isc.VBFailedLoadView.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width="100%";isc.A.layoutMargin=5;isc.A.membersMargin=5;isc.A.loadFailureMessageConstructor="Label";isc.A.loadFailureMessageDefaults={overflow:"visible",height:1,width:"100%"};isc.A.loadFailureButtonsConstructor="HLayout";isc.A.loadFailureButtonsDefaults={overflow:"visible",height:1,membersMargin:5,align:"right"};isc.A.openProjectButtonConstructor="Button";isc.A.openProjectButtonDefaults={title:"Open a Project",layoutAlign:"right",click:function(){var _1=this.creator,_2=_1.creator;_2.failedLoadWindow.close();_2.showLoadProjectUI()}};isc.A.createProjectButtonConstructor="Button";isc.A.createProjectButtonDefaults={title:"Create a Project",layoutAlign:"right",click:function(){var _1=this.creator,_2=_1.creator;_2.failedLoadWindow.close();_2.makeNewProject()}};isc.B.push(isc.A.initWidget=function isc_VBFailedLoadView_initWidget(){this.Super("initWidget",arguments);var _1=this.creator;this.addMembers([this.addAutoChild("loadFailureMessage",{contents:_1.hostedMode?_1.failedLoadHostedMessage:_1.failedLoadLocalMessage}),this.addAutoChild("loadFailureButtons",{members:[this.addAutoChild("openProjectButton"),this.addAutoChild("createProjectButton")]})])});isc.B._maxIndex=isc.C+1;isc.defineClass("VBReloadView","VStack");isc.A=isc.VBReloadView.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width="100%";isc.A.layoutMargin=5;isc.A.membersMargin=5;isc.A.reloadMessageConstructor="Label";isc.A.reloadMessageDefaults={overflow:"visible",height:1,width:"100%"};isc.A.reloadButtonConstructor="Button";isc.A.reloadButtonDefaults={title:"Reload Now",layoutAlign:"right",click:function(){this.creator.reload()}};isc.B.push(isc.A.reload=function isc_VBReloadView_reload(){var _1=window.location;if(_1)_1.reload()},isc.A.initWidget=function isc_VBReloadView_initWidget(){this.Super("initWidget",arguments);this.addMembers([this.addAutoChild("reloadMessage"),this.addAutoChild("reloadButton")])},isc.A.visibilityChanged=function isc_VBReloadView_visibilityChanged(){if(this.isVisible()){this.timeout=this.creator.pageReloadTimeoutSeconds;this.tickTock()}else if(this.$214p){isc.Timer.clear(this.$214p);delete this.$214p}},isc.A.tickTock=function isc_VBReloadView_tickTock(){var _1=this.timeout--;this.creator.pageReloadWindow.bringToFront();this.reloadButton.setFocus(true);var _2=this.creator.pageReloadWindowMessage;this.reloadMessage.setContents(_2.evalDynamicString(this,{countdown:_1}));if(_1<=0){this.reload();return}
this.$214p=this.delayCall("tickTock",null,1000)});isc.B._maxIndex=isc.C+4;isc.defineClass("ServerReconnectWindow","Window");isc.A=isc.ServerReconnectWindow.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.top=-10000;isc.A.isModal=true;isc.A.showModalMask=true;isc.A.visibility="hidden";isc.A.serverCommLossCount=0;isc.B.push(isc.A.handleServerCommLoss=function isc_ServerReconnectWindow_handleServerCommLoss(_1){if(this.ignoreServerCommLoss)return;if(this.isVisible())return;else this.show();var _2=this.creator;if(_2.logIsDebugEnabled("serverCommLoss")){_2.logDebug("handling communication loss due to: "+_1,"serverCommLoss")}
this.serverCommLossCount++;this.checkServerStatus(true)},isc.A.showServerCommLossMessage=function isc_ServerReconnectWindow_showServerCommLossMessage(_1,_2){var _3=this.serverCommLossMessage;if(_3){isc.Notify.setMessageContents(_3,_1,_2);return}
this.serverCommLossMessage=isc.Notify.addMessage(_1,_2,null,{messagePriority:isc.Notify.WARN,duration:0})},isc.A.showServerCommWaitMessage=function isc_ServerReconnectWindow_showServerCommWaitMessage(){var _1,_2=this.creator,_3=this.serverCommLossMessage;if(!_3||!isc.Notify.messageHasActions(_3))_1=[{title:_2.serverReconnectNowText,target:this,methodName:"restartServerCheckCountdown"}];this.showServerCommLossMessage(this.getServerCommLossWaitText(),_1)},isc.A.getServerCommLossWaitText=function isc_ServerReconnectWindow_getServerCommLossWaitText(){var _1=this.creator,_2=this.serverCountdown,_3=_2>600?Math.ceil(_2/60)+" minutes":_2+" seconds";return _1.serverCommLossWaitText.evalDynamicString(this,{time:_3})},isc.A.restartServerCheckCountdown=function isc_ServerReconnectWindow_restartServerCheckCountdown(){isc.Timer.clear(this.serverCommLossTimer);this.serverCommLossTick(true)},isc.A.checkServerStatus=function isc_ServerReconnectWindow_checkServerStatus(_1){var _2=this.creator;this.serverCountdown=_1?(this.serverCheckInterval=_2.initialServerCheckInterval):(this.serverCheckInterval*=2);this.showServerCommLossMessage(_2.serverCommLossPingText,null);delete this.serverTimeoutError;if(_2.logIsDebugEnabled("serverCommLoss")){_2.logDebug("sending ping to server to verify connection","serverCommLoss")}
var _3=this,_4=this.serverCommLossCount;isc.DMI.callBuiltin({methodName:"ping",callback:function(_5,_6){if(_4!=_3.serverCommLossCount)return;if(_2.logIsDebugEnabled("serverCommLoss")){_2.logDebug("got ping response; clearing modal mask","serverCommLoss")}
_3.hide()}});this.serverCommLossTimer=this.delayCall("serverCommLossTick",[],_2.showPingDuration)},isc.A.serverCommLossTick=function isc_ServerReconnectWindow_serverCommLossTick(_1){if(--this.serverCountdown>0&&!_1){this.showServerCommWaitMessage();this.serverCommLossTimer=this.delayCall("serverCommLossTick",[],1000)}else{this.checkServerStatus(_1)}},isc.A.clearServerCommLoss=function isc_ServerReconnectWindow_clearServerCommLoss(){var _1=this.serverTimeoutError;if(_1){isc.RPCManager.runDefaultErrorHandling(_1.response,_1.request);delete this.serverTimeoutError}
isc.Timer.clear(this.serverCommLossTimer);delete this.serverCommLossTimer;isc.Notify.dismissMessage(this.serverCommLossMessage);delete this.serverCommLossMessage},isc.A.hide=function isc_ServerReconnectWindow_hide(){this.Super("hide",arguments);this.clearServerCommLoss()});isc.B._maxIndex=isc.C+9;isc.defineClass("MultiActionPanel","VLayout");isc.A=isc.MultiActionPanel.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width=450;isc.A.height=250;isc.A.layoutMargin=10;isc.A.membersMargin=10;isc.A.instructions="Click the <q>Add additional action</q> button to add a new action.&nbsp; Drag and drop to change the order of actions.&nbsp; Click on a row in the grid below to change the action, or click on the remove icon next to an action to remove it.";isc.A.instructionsLabelDefaults={_constructor:"Label",width:"100%",height:1,overflow:"visible"};isc.A.mainLayoutDefaults={_constructor:"HLayout",width:"100%",height:"100%",membersMargin:10};isc.A.actionsGridDefaults={_constructor:"ListGrid",autoParent:"mainLayout",width:"100%",height:"100%",showHeader:false,defaultFields:[{name:"value",escapeHTML:true,formatCellValue:function(_1,_2,_3,_4,_5){var _6=null;if(_5.creator.getActionTitle){_6=_5.creator.getActionTitle(_1.target,_1.name,true)}
_6=_6||("["+_1.target+"."+_1.title+"]");return _6.replace(/^\[/,"").replace(/\]$/,"")}}],emptyMessage:"No Actions",selectionType:"single",autoSelectEditors:false,canRemoveRecords:true,canReorderRecords:true,rowClick:function(_1,_2,_3,_4){var _5=this,_6=_5.creator,_7=_6.getActionMenu();_7.bindingComplete=function(_11){_1.value=_11;var i=_5.getRowNum(_1),_9=_5.data;_9.$ed();_9.removeAt(i);_9.addAt(_1,i);_9.$ee()};_7.show();var _10=this.ns.EH;_7.placeNear(_10.getX(),_10.getY())}};isc.A.sideControlsLayoutDefaults={_constructor:"VLayout",autoParent:"mainLayout",height:"100%",membersMargin:5,align:"center"};isc.A.moveToBeginningButtonDefaults={_constructor:"ImgButton",autoParent:"sideControlsLayout",src:"[SKINIMG]TransferIcons/up_first.png",size:15,showDown:false,prompt:"Move the selected action to the beginning",click:function(){var _1=this.creator,_2=_1.actionsGrid,_3=_2.getSelectedRecord();if(_3!=null){var i=_2.getRowNum(_3);if(i>0){var _5=_2.data;_5.$ed();_5.removeAt(i);_5.addAt(_3,0);_5.$ee()}}}};isc.A.moveUpButtonDefaults={_constructor:"ImgButton",autoParent:"sideControlsLayout",src:"[SKINIMG]TransferIcons/up.png",size:15,showDown:false,prompt:"Move the selected action up one",click:function(){var _1=this.creator,_2=_1.actionsGrid,_3=_2.getSelectedRecord();if(_3!=null){var i=_2.getRowNum(_3);if(i>0){var _5=_2.data;_5.$ed();_5.removeAt(i);_5.addAt(_3,i-1);_5.$ee()}}}};isc.A.moveDownButtonDefaults={_constructor:"ImgButton",autoParent:"sideControlsLayout",src:"[SKINIMG]TransferIcons/down.png",size:15,showDown:false,prompt:"Move the selected action down one",click:function(){var _1=this.creator,_2=_1.actionsGrid,_3=_2.getSelectedRecord();if(_3!=null){var i=_2.getRowNum(_3),_5=_2.data;if(i<_5.getLength()-1){_5.$ed();_5.removeAt(i);_5.addAt(_3,i+1);_5.$ee()}}}};isc.A.moveToEndButtonDefaults={_constructor:"ImgButton",autoParent:"sideControlsLayout",src:"[SKINIMG]TransferIcons/down_last.png",size:15,showDown:false,prompt:"Move the selected action to the end",click:function(){var _1=this.creator,_2=_1.actionsGrid,_3=_2.getSelectedRecord();if(_3!=null){var i=_2.getRowNum(_3),_5=_2.data;if(i<_5.getLength()-1){_5.$ed();_5.removeAt(i);_5.add(_3);_5.$ee()}}}};isc.A.buttonsLayoutDefaults={_constructor:"HLayout",width:"100%",membersMargin:10};isc.A.saveButtonDefaults={_constructor:"IButton",autoParent:"buttonsLayout",title:"Save",click:function(){var _1=this.creator,_2=_1.actionsGrid;_2.endEditing();var _3=_2.data,_4;if(isc.isAn.Array(_3)&&_3.length>0){_4=_3.getProperty("value")}
this.creator.saveClick(_4)}};isc.A.cancelButtonDefaults={_constructor:"IButton",autoParent:"buttonsLayout",title:"Cancel",click:function(){this.creator.cancelClick()}};isc.A.addAdditionalActionButtonTitle="Add additional action";isc.A.addAdditionalActionButtonDefaults={_constructor:"IButton",autoParent:"buttonsLayout",addAsPeer:true,snapTo:"L",autoFit:true,icon:"actions/addAction.png",iconSize:16,showRollOverIcon:false,click:function(){var _1=this.creator,_2=_1.getActionMenu();_2.bindingComplete=function(_4){_1.actionsGrid.data.add({value:_4})};_2.show();var _3=this.getPageRect();_2.placeNear(_3[0],_3[1]+_3[3])}};isc.A.actionMenuDefaults={_constructor:"ActionMenu",isForMultiActionPanel:true};isc.A.autoChildren=["instructionsLabel","mainLayout","actionsGrid","sideControlsLayout","moveToBeginningButton","moveUpButton","moveDownButton","moveToEndButton","buttonsLayout","addAdditionalActionButton","cancelButton","saveButton"];isc.B.push(isc.A.getActionMenu=function isc_MultiActionPanel_getActionMenu(){var _1=this.actionMenu;if(_1)_1.markForDestroy();_1=this.actionMenu=this.createAutoChild("actionMenu",{builder:this.builder,sourceComponent:this.sourceComponent,sourceMethod:this.sourceMethod,components:this.currentComponents});return _1},isc.A.initWidget=function isc_MultiActionPanel_initWidget(){this.Super("initWidget",arguments);this.addAutoChildren(this.autoChildren)},isc.A.getDynamicDefaults=function isc_MultiActionPanel_getDynamicDefaults(_1){if(_1==="instructionsLabel"){return{contents:this.instructions}}else if(_1==="buttonsLayout"){return{align:this.isRTL()?"left":"right"}}else if(_1==="addAdditionalActionButton"){return{title:this.addAdditionalActionButtonTitle}}},isc.A.configureFor=function isc_MultiActionPanel_configureFor(_1){var _2=_1.currentStringMethods;if(_2==null)_2=[];var _3=_2.length;var _4=[];for(var i=0;i<_3;++i){var _6=_2[i].getValue();if(isc.isAn.Array(_6)){for(var j=0;j<_6.length;++j){_4.add({value:_6[j]})}}else{_4.add({value:_6})}}
this.actionsGrid.setData(_4);this.sourceComponent=_1.sourceComponent;this.sourceMethod=_1.sourceMethod;this.currentComponents=_1.components;this.cancelButton.delayCall("focus")});isc.B._maxIndex=isc.C+4;isc.MultiActionPanel.registerStringMethods({"saveClick":"bindings","cancelClick":""});isc.defineClass("DeploymentEditor","VLayout");isc.A=isc.DeploymentEditor.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.deploymentNameTitle="Deployment name";isc.A.deploymentTypeTitle="Deployment type";isc.A.deploymentURLTitle="Deployment URL";isc.A.newDeploymentSuccess="New ${type} deployment '${name}' succeeded";isc.A.redeploymentSuccess="Redeployment of '${name}' (${type}) succeeded";isc.A.idFormDefaults={_constructor:"DynamicForm",dataSource:"hostedDeployments",clipStaticValue:true,validateOnChange:true,wrapItemTitles:false,titleAlign:"left",width:"100%",autoFocus:true,numCols:4,handleAsyncValidationReply:function(){var _1=this.creator;_1.checkErrorStatus()},updateDeploymentURL:function(){var _1=this.getItem("deploymentURL"),_2=this.getValues(),_3=_2.fileName;if(_3)_3=_3.replace(/\s/g,"_").replace(/['"`]/g,"");var _4=isc.DeploymentEditor.getDeploymentURL(_3,_2.fileType);if(_4)_1.setValue(_4);else _1.clearValue()}};isc.A.formManagerDefaults={_constructor:"ValuesManager",dataSource:"hostedDeployments"};isc.A.dsImportSelectTitle="Choose DataSources to import";isc.A.dsImportSelectInfo="Note: all DataSources will exist and have storage.  Above, you are only choosing whether the sample data you have been using should be present in the deployment.";isc.A.dsImportSelectStackDefaults={_constructor:"SectionStack",width:"100%",height:205};isc.A.dsImportSelectGridDefaults={_constructor:"ListGrid",selectionProperty:"$2104",selectionAppearance:"checkbox",border:0,fields:[{name:"dsName",title:"DataSource Name"}],getExcludedDataSources:function(){var _1=[];for(var i=0;i<this.getTotalRows();i++){var _3=this.getRecord(i);if(!_3.$2104)_1.add(_3.dsName)}
return _1},setExcludedDataSources:function(_1){if(!_1)return;var _2={};for(var i=0;i<_1.length;i++){_2[_1[i]]=true}
for(var i=0;i<this.getTotalRows();i++){var _4=this.getRecord(i);if(_2[_4.dsName])this.deselectRecord(_4)}}};isc.A.dsImportSelectInfoDefaults={_constructor:"Label",height:40,valign:"top",overflow:"visible"};isc.A.authenticationTitle="Authentication";isc.A.sampleUsersTitle="Users & roles you used for testing inside the Reify visual environment.  Enter a single password for all test users below:";isc.A.sampleUsersInfo="Note: you will be able to use the Deployment Console to add or remove users after deployment";isc.A.passwordTitle="Password";isc.A.passwordConfirmTitle="Password confirm";isc.A.authShareUsersTitle="Share users with existing deployment?";isc.A.authShareUsersHint="If users are not shared, a copy of the user database is created at deployment";isc.A.authDeploymentTitle="Deployment";isc.A.authDeploymentHint="[pick deployment]";isc.A.authFormDefaults={_constructor:"DynamicForm",dataSource:"hostedDeployments",wrapItemTitles:false,isGroup:true,showGroupLabel:false,width:"100%",numCols:4,validateOnChange:true,wrapHintText:false,titleAlign:"left"};isc.A.buttonLayoutDefaults={_constructor:"HLayout",align:"right",height:"*",defaultLayoutAlign:"center",membersMargin:10};isc.A.applyButtonTitle="Apply";isc.A.applyButtonConstructor="IButton";isc.A.applyButtonDefaults={layoutAlign:"bottom",width:80,canHover:true,click:"this.creator.saveData()",getHoverHTML:function(){if(!this.disabled)return;var _1=this.creator.formManager;if(_1.hasErrors())return"Fix validation errors";var _2=this.creator.idForm;if(!_2.getValue("fileName"))return"Type a deployment name";var _3=this.creator.authForm;return _3.getValue("sampleUsersPassword")?"Enter password confirmation":"Enter a password for sample users"}};isc.A.cancelButtonTitle="Cancel";isc.A.cancelButtonConstructor="IButton";isc.A.cancelButtonDefaults={layoutAlign:"bottom",click:"this.creator.close()",width:80};isc.B.push(isc.A.initWidget=function isc_DeploymentEditor_initWidget(){this.Super("initWidget",arguments);var _1=this.creator;this.idForm=this.createAutoChild("idForm",{items:[{name:"fileName",type:"text",title:this.deploymentNameTitle,changed:function(_6){_6.updateDeploymentURL()}},{name:"fileType",type:"enum",title:this.deploymentTypeTitle,changed:function(_6){_6.updateDeploymentURL()}},{name:"deploymentURL",editorType:"StaticTextItem",cellHeight:32,shouldSaveValue:false,colSpan:3,title:this.deploymentURLTitle}]});this.dsImportSelectGrid=this.createAutoChild("dsImportSelectGrid");this.dsImportSelectInfo=this.createAutoChild("dsImportSelectInfo",{contents:this.dsImportSelectInfo});this.dsImportSelectStack=this.createAutoChild("dsImportSelectStack",{sections:[{title:this.dsImportSelectTitle,canCollapse:false,items:[this.dsImportSelectGrid]}]});var _2={_constructor:"AdvancedCriteria",operator:"and",criteria:[{fieldName:"authentication",operator:"equals",value:"sampleUsers"}]};this.authForm=this.createAutoChild("authForm",{items:[{name:"authentication",type:"enum",title:this.authenticationTitle},{shouldSaveValue:false,editorType:"StaticTextItem",showTitle:false,colSpan:4,height:24,defaultValue:this.sampleUsersTitle,showIf:"values.authentication=='sampleUsers'"},{name:"sampleUsersPassword",type:"password",title:this.passwordTitle,changed:"form.creator.checkErrorStatus()",visibleWhen:_2,validators:[{type:"custom",dependentFields:["sampleUsersPassword2"],condition:function(_6,_7,_8,_5){var _3=_6.form.getItem("sampleUsersPassword2"),_4=_3.getValueForMatch(_5);return!_4||_8==_4},errorMessage:"Passwords do not match"}]},{name:"sampleUsersPassword2",type:"password",title:this.passwordConfirmTitle,shouldSaveValue:false,changed:"form.creator.checkErrorStatus()",visibleWhen:_2,getValueForMatch:function(_5){return _5.hasOwnProperty(this.name)?_5[this.name]:this.getValue()}},{shouldSaveValue:false,editorType:"StaticTextItem",showTitle:false,colSpan:4,height:24,showIf:"values.authentication=='sampleUsers'",defaultValue:this.sampleUsersInfo},{name:"authDeployment",editorType:"SelectItem",optionDataSource:_1.existingDeployments,defaultToFirstOption:true,startRow:true,showIf:"values.authentication!='sampleUsers'",pickListFields:[{name:"fileName"},{name:"fileType"}],title:this.authDeploymentTitle,valueField:"id",displayField:"id",hint:this.authDeploymentHint,formatValue:function(_6){var _5=this.optionDataSource.getRecord(_6);if(_5)return isc.DeploymentEditor.getDeploymentTitle(_5)}},{name:"authShareUsers",startRow:true,showIf:"values.authentication!='sampleUsers'",showTitle:false,colSpan:4,title:this.authShareUsersTitle,hint:this.authShareUsersHint}]});this.buttonLayout=this.createAutoChild("buttonLayout");this.applyButton=this.createAutoChild("applyButton",{title:this.applyButtonTitle});this.cancelButton=this.createAutoChild("cancelButton",{title:this.cancelButtonTitle});this.buttonLayout.addMembers([this.cancelButton,this.applyButton]);this.addMembers([this.idForm,this.dsImportSelectStack,this.dsImportSelectInfo,this.authForm,this.buttonLayout]);this.formManager=this.createAutoChild("formManager",{members:[this.idForm,this.authForm]})},isc.A.checkErrorStatus=function isc_DeploymentEditor_checkErrorStatus(){var _1=this.formManager,_2=this.idForm.getItem("fileName");this.applyButton.setDisabled(_1.hasErrors()||!_2.getValue()||(!this.authForm.isDisabled()&&(!this.authForm.getValue("sampleUsersPassword")||!this.authForm.getValue("sampleUsersPassword2"))))},isc.A.updateData=function isc_DeploymentEditor_updateData(){this.formManager.clearErrors();var _1=this.creator;this.dsImportSelectGrid.setData(_1.project.datasources);this.dsImportSelectGrid.selectAllRecords()},isc.A.editNewRecord=function isc_DeploymentEditor_editNewRecord(){this.formManager.editNewRecord();this.applyButton.setDisabled(true);this.idForm.setDisabled(false);this.authForm.setDisabled(false)},isc.A.editRecord=function isc_DeploymentEditor_editRecord(_1){this.formManager.editRecord(_1);this.idForm.updateDeploymentURL();this.applyButton.setDisabled(false);this.idForm.setDisabled(true);this.authForm.setDisabled(true);this.dsImportSelectGrid.setExcludedDataSources(_1.excludedImports)},isc.A.saveData=function isc_DeploymentEditor_saveData(){var _1=this.creator,_2=_1.project,_3=this.formManager;_3.setValue("fileFormat","xml");_3.setValue("fileLastModified",new Date());_3.setValue("sourceProjectId",_2.projectId||_2.$2103);_3.setValue("sourceProjectName",_1.getProjectFileName());_3.setValue("fileContents",_2.xmlSerialize());_3.setValue("excludedImports",this.dsImportSelectGrid.getExcludedDataSources());var _4=[];var _5=this.dsImportSelectGrid.getData();for(var i=0;i<_5.getLength();i++){var _7=_5.get(i),_8=_7.dsName,_9=_7.dsType||_1.getDataSourceType(_8);if(_9=="MockDataSource")_4.add(_8)}
var _10=this,_11=_3.saveOperationType=="add";var _12=function(){_10.formManager.saveData(function(_18,_19,_20){if(_19!=null){delete _19.fileContents;var _13=_1.existingDeployments;_13.updateCacheFromServer(_18,_19);var _14=_11?_10.newDeploymentSuccess:_10.redeploymentSuccess;isc.Notify.addMessage(_14.evalDynamicString(_10,{name:_3.getValue("fileName"),type:_3.getValue("fileType")}))}
_10.formManager.clearValue("isc_mockDSConfig")},{promptStyle:"dialog",prompt:"Deploying project... ${loadingImage}"});_10.close()};if(_4.length!=0){var _15={};for(var i=0;i<_4.length;i++){var _8=_4[i];var _13=isc.DataSource.get(_8);if(_13==null){this.logWarn("MockDataSource "+_8+" was not found");continue}
if(_13.hasExplicitFields())continue;var _16=isc.clone(_13.$211c),_17=_13.testData||[];_15[_8]={ID:_8,fields:_16,testData:_17}}
this.formManager.setValue("isc_mockDSConfig",_15)}
_12()},isc.A.close=function isc_DeploymentEditor_close(){var _1=this.creator;_1.deploymentWindow.close()});isc.B._maxIndex=isc.C+7;isc.A=isc.DeploymentEditor;isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.getDeploymentURL=function isc_c_DeploymentEditor_getDeploymentURL(_1,_2){if(!_1||!_2)return null;var _3=(location.origin+"").replace("create",_2=="production"?"app":_2)+"/";return _3+window.user.orgUrlFragment+"/"+_1+"/"},isc.A.getDeploymentTitle=function isc_c_DeploymentEditor_getDeploymentTitle(_1){return _1.fileName+" <I>("+_1.fileType+")</i>"});isc.B._maxIndex=isc.C+2;isc.defineClass("DeploymentManagerLauncher","VLayout");isc.A=isc.DeploymentManagerLauncher.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.deploymentGridConstructor="ListGrid";isc.A.deploymentGridDefaults={autoFetchData:true,selectionType:"single",leaveScrollbarGap:false,sortField:"fileLastModified",sortDirection:"descending",defaultFields:[{name:"fileName"},{name:"fileType",width:70},{name:"fileLastModified",hidden:true}],redeployFieldDefaults:{name:"redeploy",type:"icon",width:40,showHover:true,cellIcon:"actions/deploy.png",cellPrompt:"Redeploy",recordClick:function(_1,_2){var _3=_1.creator.creator;_3.showDeploymentWindow(_2)}},visitFieldDefaults:{name:"visit",type:"icon",width:40,showHover:true,cellIcon:"actions/exportProject.png",cellPrompt:"Visit deployment",recordClick:function(_1,_2){window.open(isc.DeploymentEditor.getDeploymentURL(_2.fileName,_2.fileType))}},initWidget:function(_1,_2,_3){if(!this.fields)this.fields=isc.shallowClone(this.defaultFields);if(this.showRedeployField!=false){this.fields.add(isc.addProperties({},this.redeployFieldDefaults,this.redeployFieldProperties))}
if(this.showVisitField!=false){this.fields.add(isc.addProperties({},this.visitFieldDefaults,this.visitFieldProperties))}
this.invokeSuper(null,"initWidget",_1,_2,_3)},recordDoubleClick:function(_1,_2){this.creator.manage()},selectionUpdated:function(_1){this.creator.manageButton.setDisabled(!_1)}};isc.A.buttonLayoutDefaults={_constructor:"HLayout",defaultLayoutAlign:"center",membersMargin:10,height:1,overflow:"visible",align:"right"};isc.A.manageButtonTitle="Manage";isc.A.manageButtonConstructor="IButton";isc.A.manageButtonDefaults={click:"this.creator.manage()",width:80};isc.A.cancelButtonTitle="Cancel";isc.A.cancelButtonConstructor="IButton";isc.A.cancelButtonDefaults={layoutAlign:"bottom",click:"this.creator.close()",width:80};isc.B.push(isc.A.initWidget=function isc_DeploymentManagerLauncher_initWidget(){this.Super("initWidget",arguments);var _1=this.creator;this.deploymentGrid=this.createAutoChild("deploymentGrid",{dataSource:_1.existingDeployments});this.buttonLayout=this.createAutoChild("buttonLayout");this.manageButton=this.createAutoChild("manageButton",{title:this.manageButtonTitle});this.cancelButton=this.createAutoChild("cancelButton",{title:this.cancelButtonTitle});this.buttonLayout.addMembers([this.cancelButton,this.manageButton]);this.addMembers([this.deploymentGrid,this.buttonLayout])},isc.A.updateData=function isc_DeploymentManagerLauncher_updateData(){this.deploymentGrid.deselectAllRecords()},isc.A.manage=function isc_DeploymentManagerLauncher_manage(_1){if(!_1)_1=this.deploymentGrid.getSelectedRecord();if(!_1)return;this.creator.manageDeployment(_1);this.close()},isc.A.close=function isc_DeploymentManagerLauncher_close(){var _1=this.creator;_1.deploymentsWindow.close()});isc.B._maxIndex=isc.C+4;isc.defineClass("UpdateAccountEditor","DynamicForm");isc.A=isc.UpdateAccountEditor.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.numCols=4;isc.A.autoFocus=true;isc.A.saveOnEnter=true;isc.A.colWidths=[80,"*",170,"*"];isc.A.fetchOperation="authedUserOnly";isc.A.updateOperation="authedUserOnly";isc.A.dataSource="registeredDevelopers";isc.A.formTitle="To update your profile, simply change any applicable fields and click 'Save Changes'.  (To update your username, please contact Isomorphic support.)";isc.A.readOnlyOrgText="Only the owner can rename your organization";isc.A.defaultItems=[{name:"help",colSpan:4,showTitle:false,vAlign:"top",editorType:"StaticTextItem",canSave:false,height:20,getDefaultValue:function(){return this.form.formTitle}},{name:"email",width:"*",endRow:true,canEdit:true},{name:"firstname",width:"*"},{name:"lastname",width:"*"},{name:"phone",width:"*"},{name:"organization",width:"*",canEdit:true,itemHoverHTML:function(_1,_2){if(_1.disabled)return _2.readOnlyOrgText}},{name:"title",width:"*"},{name:"url",width:"*"},{name:"password",title:"Password",type:"password",width:"*",startRow:true,validators:[{type:"matchesField",otherField:"password2",errorMessage:"Passwords don't match"},{type:"lengthRange",max:32}]},{name:"password2",title:"Password again",type:"password",width:"*",validators:[{type:"matchesField",otherField:"password",errorMessage:"Passwords don't match"},{type:"lengthRange",max:32}]},{editorType:"SpacerItem"},{editorType:"SpacerItem"},{editorType:"SpacerItem"},{name:"save",title:"Save Changes",editorType:"ButtonItem",startRow:false,align:"right",click:function(_1,_2){var _3=_1.creator.updateAccountWindow;_1.saveData(function(){isc.notify("Account details updated");_3.hide()})}}];isc.B.push(isc.A.refreshData=function isc_UpdateAccountEditor_refreshData(){this.fetchData(null,"this.updateState()")},isc.A.updateState=function isc_UpdateAccountEditor_updateState(){var _1=this.getValue("userid"),_2=this.getValue("ownerId"),_3=this.getItem("organization");_3.setDisabled(_2!=null&&_2!=_1)});isc.B._maxIndex=isc.C+2;isc.defineClass("ManageUsersPanel","VLayout");isc.A=isc.ManageUsersPanel.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.membersMargin=5;isc.A.layoutMargin=5;isc.A.inviteTitle="Send an Invitation";isc.A.inviteMessage="Enter an email to invite";isc.A.reinviteMessage="Click to re-send invitation";isc.A.invitedMessage="Successfully sent an invite to ${email}";isc.A.emailYourselfMessage="${email} is your own email!";isc.A.alreadyMemberMessage="${email} is already a member of Isomorphic Software";isc.A.usersGridDefaults={_constructor:"ListGrid",canRemoveRecords:true,dataSource:"managedUsers",showClippedValuesOnHover:true,dataFetchMode:"local",emptyMessage:"Click \"Invite\" to add people to your organization",initialSort:[{property:"lastname",direction:"ascending"},{property:"firstname",direction:"ascending"},{property:"email",direction:"ascending"}],defaultFields:[{name:"firstname",hidden:true,sortNormalizer:function(_1){return!_1.firstname?"\uFFFF":_1.firstname}},{name:"lastname",hidden:true,sortNormalizer:function(_1){return!_1.lastname?"\uFFFF":_1.lastname}},{name:"person",title:"Person",sortNormalizer:function(_1){return _1.username?_1.firstname+" "+_1.lastname+" ("+_1.email+")":_1.email},formatCellValue:function(_1,_2){return _2.username?_2.firstname+" "+_2.lastname+" ("+_2.email+")":_2.email}},{name:"orgRole",title:"Status",width:80,showHover:true,hoverHTML:function(_1,_2,_3,_4,_5){return _2=="Invited"?_5.creator.reinviteMessage:null},recordClick:function(_1,_2,_3,_4,_5,_6){if(_6=="Invited")_1.sendInvite(_2.email)}},{name:"_canRemove",hidden:true,canHide:false,userFormula:{text:"record.orgRole != 'Inactive'"}}],sendInvite:function(_1){if(!_1)return;var _2=this.creator,_3=_2.creator;if(_1==_3.email){isc.notify(_2.emailYourselfMessage.evalDynamicString(this,{email:_1}),null,null,{messagePriority:isc.Notify.WARN});return}
var _4=this.find({email:_1}),_5=_3.organization;if(_4&&_4.orgRole=="Member"){isc.notify(_2.alreadyMemberMessage.evalDynamicString(this,{email:_1,organization:_5}),null,null,{messagePriority:isc.Notify.WARN});return}
var _6=this,_7=function(_9,_10,_11){if(_9.status<0){_3.logWarn("failed to invite "+_1+" to "+_5);var _8=isc.DS.getSimpleErrors(_9)||{};if(_8.email){isc.notify(_8.email,null,null,{messagePriority:isc.Notify.WARN,autoFitMaxWidth:400,canDismiss:true,duration:0})}else isc.RPCManager.runDefaultErrorHandling(_9,_11);return}
isc.notify(_2.invitedMessage.evalDynamicString(_6,{email:_1}))};if(_4){this.updateData({userid:_4.userid,orgRole:"Invited"},_7,{oldValues:_4,willHandleError:true})}else{this.addData({orgRole:"Invited",email:_1},_7,{willHandleError:true})}},removeRecord:function(_1,_2){var _3=_2.userid;switch(_2.orgRole){case"Invited":if(_3<0){this.Super("removeRecord",arguments);return}
case"Member":this.updateData({userid:_3,orgRole:"Inactive"},null,{oldValues:_2});break}},initWidget:function(){this.Super("initWidget",arguments);this.$221s=this.getViewState()},refresh:function(){this.invalidateCache();this.setViewState(this.$221s)}};isc.A.emailFormDefaults={_constructor:"DynamicForm",numCols:1,padding:3,saveOnEnter:true,items:[{name:"message",type:"blurb"},{name:"value",showTitle:false,width:"*",validators:[{type:"regexp",errorMessage:"Please enter a valid email address",expression:"^([a-zA-Z0-9_.\\-+])+@(([a-zA-Z0-9\\-])+\\.)+[a-zA-Z0-9]{2,4}$"}]}],submit:function(){this.creator.emailDialog.okClick()},clearEmail:function(){this.clearErrors();this.clearValue("value");this.focusInItem("value")},initWidget:function(){this.Super("initWidget",arguments);this.setValues({message:this.creator.inviteMessage})}};isc.A.emailDialogDefaults={_constructor:"Dialog",width:300,isModal:true,canDragReposition:true,placement:"none",overflow:"visible",ariaRole:"alertdialog",bodyProperties:{overflow:"visible"},buttons:[isc.Dialog.OK,isc.Dialog.CANCEL],okClick:function(){if(!this.askForm.validate())return;var _1=this.askForm.getValue("value");if(_1)this.returnValue(_1);else this.close()},show:function(){this.askForm.clearEmail();this.Super("show",arguments)}};isc.A.inviteButtonDefaults={_constructor:"Button",layoutAlign:"right",title:"Invite...",click:function(){var _1=this.creator;_1.emailDialog.show()}};isc.B.push(isc.A.initWidget=function isc_ManageUsersPanel_initWidget(){this.Super("initWidget",arguments);this.addAutoChild("usersGrid");this.addAutoChild("inviteButton");var _1=this.createAutoChild("emailForm");this.emailDialog=this.createAutoChild("emailDialog",{items:[_1],askForm:_1,title:this.inviteTitle,callback:{target:this.usersGrid,methodName:"sendInvite"}});this.usersGrid.fetchData()});isc.B._maxIndex=isc.C+1;isc.defineClass("ActionMenu","Menu");isc.A=isc.ActionMenu.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.isForMultiActionPanel=false;isc.A.titleFieldProperties={showHover:true,hoverHTML:"return record.prompt",hoverWrap:false,hoverAutoFitWidth:false,hoverStyle:"darkHover"};isc.A.$50a=["string","number","boolean","object","array"];isc.B.push(isc.A.initWidget=function isc_ActionMenu_initWidget(){this.setComponents(this.components);this.Super("initWidget",arguments)},isc.A.draw=function isc_ActionMenu_draw(){if(!this.$1755){this.$1755=isc.SelectionOutline.getSelectedState();isc.SelectionOutline.deselect()}
return this.Super("draw",arguments)},isc.A.hide=function isc_ActionMenu_hide(){if(this.$1755){isc.SelectionOutline.setSelectedState(this.$1755);delete this.$1755}
return this.Super("hide",arguments)},isc.A.setComponents=function isc_ActionMenu_setComponents(_1){var _2=[];if(!_1)_1=[];for(var i=0;i<_1.length;i++){var _4=_1[i];if(!_4.ID)continue;var _5={component:_4,icon:_4.icon,title:_4.liveObject.getActionTargetTitle?_4.liveObject.getActionTargetTitle():_4.ID+" ("+_4.type+")"};var _6;if(isc.isA.ClassObject(_4.liveObject)){_6=_4.liveObject.getClassActions(this.sourceComponent.liveObject)}else{_6=isc.jsdoc.getActions(_4.type)}
if(_6){_5.submenu=this.getActionsMenu(_4,_6);_2.add(_5)}}
if(!this.isForMultiActionPanel){_2.add({title:"[None]",icon:"[SKINIMG]/actions/close.png",click:function(_9,_5,_10){_10.clearAction()}});_2.add({isSeparator:true});_2.add({title:"Multiple Actions&hellip;",icon:"actions/addMultipleActions.png",click:function(_9,_5,_10){var _7=function(){_10.builder.showMultiActionWindow(_10)};var _8=function(){};_10.confirmOverwriteWorkflow(_7,_8)}})}
this.setData(_2)},isc.A.rowOver=function isc_ActionMenu_rowOver(_1){this.Super("rowOver",arguments);var _2=_1.component;if(_2&&_2.liveObject)isc.SelectionOutline.select(_2.liveObject);else isc.SelectionOutline.deselect();this.bringToFront()},isc.A.getActionsMenu=function isc_ActionMenu_getActionsMenu(_1,_2){var _3=this,_4=[];for(var i=0;i<_2.length;i++){var _6=_2[i],_7={title:_6.title?_6.title:isc.DataSource.getAutoTitle(_6.name),icon:_6.icon,component:_1,targetAction:_6,click:function(_10,_7,_11){var _8=function(){_3.bindAction(_7.component,_7.targetAction)};var _9=function(){};_3.confirmOverwriteWorkflow(_8,_9)}};_4.add(_7)}
return _4},isc.A.getInheritedMethod=function isc_ActionMenu_getInheritedMethod(_1,_2){while(_1){var _3=isc.jsdoc.getDocItem("method:"+_1+"."+_2);if(_3!=null)return _3;var _4=isc.DS.get(_1);if(_4&&_4.methods){var _5=_4.methods.find("name",_2);if(_5)return _5}
var _6=isc.ClassFactory.getClass(_1);if(_6==null)return null;_6=_6.getSuperClass();if(_6==null)return null;_1=_6.getClassName()}},isc.A.bindAction=function isc_ActionMenu_bindAction(_1,_2){var _3=this.sourceComponent,_4=this.getInheritedMethod(_3.type,this.sourceMethod),_5=isc.isAn.XMLNode(_4)?isc.jsdoc.toJS(_4):_4;if(this.logIsDebugEnabled("actionBinding")){this.logDebug("bindAction: component "+_1.ID+", sourceMethod: "+this.echoFull(_5)+", action method: "+this.echoFull(_2),"actionBinding")}
var _6={target:_1.ID,name:_2.name};if(isc.isA.ClassObject(_1.liveObject)){_6.type="static"}
var _7;if(_2.params){var _8=[],_9=false;_7=_5.params;if(!_7)_7=[];else if(!isc.isAn.Array(_7))_7=[_7];else _7=_7.duplicate();_7.add({name:"this",type:this.sourceComponent.type,pseudo:true});for(var i=0;i<_2.params.length;i++){var _11=_2.params[i];this.logInfo("considering actionMethod "+_2.name+" param: "+_11.name+" of type "+_11.type,"actionBinding");var _12=_11.optional!=null&&_11.optional.toString()!="false";if(!_12||_11.type!=null&&!this.$50a.contains(_11.type.toLowerCase()))
{var _13=this.getMatchingSourceParam(_11,_7);if(_13!=null){if(!_12||!_13.pseudo){_8[i]=_13.name;_13.$480=true;_9=true;continue}}else if(!_12){this.logInfo("action binding failed, actionMethod param "+_11.name+" of type "+_11.type+" couldn't be fulfilled","actionBinding");isc.say("An automatic binding could not be found from event "+_5.name+" to action "+(_2.title||_2.name));return null}}
_8[i]="null"}
if(_9)_6.mapping=_8}
if(this.logIsInfoEnabled("actionBinding")){this.logWarn("generated binding: "+this.echoFull(_6),"actionBinding")}
if(_7)_7.setProperty("$480",null);this.bindingComplete(_6)},isc.A.bindingComplete=function isc_ActionMenu_bindingComplete(_1){},isc.A.clearAction=function isc_ActionMenu_clearAction(){var _1=null;this.bindingComplete(_1)},isc.A.getMatchingSourceParam=function isc_ActionMenu_getMatchingSourceParam(_1,_2){var _3=this.getActionTypes(_1.type);for(var j=0;j<_3.length;j++){var _5=_3[j],_6=isc.DS.get(_5);this.logInfo("selected type "+_5+" has schema: "+_6,"actionBinding");for(var i=0;i<_2.length;i++){var _8=_2[i];if(_8.$480)continue;this.logDebug("considering source param: "+_8.name+" of type "+_8.type,"actionBinding");var _9=this.getActionTypes(_8.type)[0];var _10=isc.DS.get(_9);if(!_10){if(_5==_9)return _8;continue}
if(_10.inheritsSchema(_6)){return _8}}}},isc.A.getActionTypes=function isc_ActionMenu_getActionTypes(_1){var _2=_1.split(/[ \t]*[|]+[ \t]*/);for(var i=0;i<_2.length;i++){var _1=_2[i];_1=_1.split(/[ \t]+/)[0];_1=_1.substring(0,1).toUpperCase()+_1.substring(1);_2[i]=_1}
return _2},isc.A.isWorkflowAction=function isc_ActionMenu_isWorkflowAction(){var _1=this.currentStringMethods;if(_1==null)_1=[];var _2=_1.length;if(_2>0){for(var i=0;i<_2;++i){var _4=_1[i].getValue();if(isc.isAn.Object(_4)&&_4._constructor=="Process"){return true}}}
return false},isc.A.confirmOverwriteWorkflow=function isc_ActionMenu_confirmOverwriteWorkflow(_1,_2){if(!this.isWorkflowAction()){_1();return}
var _3=this;isc.warn("This will delete an existing workflow.",function(){},{buttons:[isc.Button.create({title:"Delete Workflow",click:function(){this.topElement.hide();_3.currentStringMethods=null;_1()}}),isc.Button.create({title:"Edit Workflow",click:function(){this.topElement.hide();_2()}}),isc.Button.create({title:"Cancel",click:function(){this.topElement.hide()}})]})});isc.B._maxIndex=isc.C+14;isc.defineClass("GridSearch","DynamicForm");isc.A=isc.GridSearch.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.browserSpellCheck=false;isc.A.height=20;isc.A.numCols=2;isc.A.cellPadding=0;isc.A.colWidths=[46,200];isc.A.titleSuffix=":&nbsp;";isc.A.showSearchTitle=false;isc.A.wrapItemTitles=false;isc.A.selectOnFocus=true;isc.A.hint="Find...";isc.A.searchTitle="<span style='color:#FFFFFF'>Search</span>";isc.B.push(isc.A.initWidget=function isc_GridSearch_initWidget(){this.items=[isc.addProperties({name:"search",width:"*",colSpan:"*",showTitle:this.showSearchTitle,editorType:"TTextItem",selectOnFocus:true,title:this.searchTitle,showHintInField:true,hint:this.hint,changed:"form.findNode()",keyPress:function(_1,_2,_3){if(_3=="Enter"){_2.findNode();return false}
if(_3=="Escape"){_2.revertState();return false}}},this.searchItemProperties)];this.Super("initWidget",arguments);if(this.grid)this.setGrid(this.grid)},isc.A.setGrid=function isc_GridSearch_setGrid(_1){this.grid=_1;this.defaultSearchProperty();var _2=_1.getField(this.searchProperty);if(_2&&_2.formatCellValue){if(_2.$84x)_2.formatCellValue=_2.$84x;_2.$84x=_2.formatCellValue;_2.formatCellValue=function(_5,_6,_7,_8,_1){if(_2.$84x){_5=_2.$84x(_5,_6,_7,_8,_1)}
if(_5!=null&&_6.$826){var _3,_4;if(_5.match(/<.*>/)){_4=new RegExp("(^|>)([^<]*?)("+_6.$826+")","ig");_3=_5.replace(_4,"$1$2<span style='background-color:#FF0000;'>$3</span>")}else{_4=new RegExp("("+_6.$826+")","ig");_3=_5.replace(_4,"<span style='background-color:#FF0000;'>$1</span>")}
_5=_3}
return _5}}else{if(isc.isA.TreeGrid(_1)){if(_1.$84w)_1.getNodeTitle=_1.$84w;_1.$84w=_1.getNodeTitle;_1.getNodeTitle=function(_6,_7,_8){var _5=_1.$84w(_6,_7,_8);if(_6.$826){var _3,_4;if(_5.match(/<.*>/)){_4=new RegExp("(^|>)([^<]*?)("+_6.$826+")","ig");_3=_5.replace(_4,"$1$2<span style='background-color:#FF0000;'>$3</span>")}else{_4=new RegExp("("+_6.$826+")","ig");_3=_5.replace(_4,"<span style='background-color:#FF0000;'>$1</span>")}
_5=_3}
return _5}}else{if(_1.$84x)_1.formatCellValue=_1.$84x;_1.$84x=_1.formatCellValue;_1.formatCellValue=function(_5,_6,_7,_8){if(_1.$84x){_5=_1.$84x(_5,_6,_7,_8)}
if(_5!=null&&_6.$826){var _3,_4;if(_5.match(/<.*>/)){_4=new RegExp("(^|>)([^<]*?)("+_6.$826+")","ig");_3=_5.replace(_4,"$1$2<span style='background-color:#FF0000;'>$3</span>")}else{_4=new RegExp("("+_6.$826+")","ig");_3=_5.replace(_4,"<span style='background-color:#FF0000;'>$1</span>")}
_5=_3}
return _5}}}},isc.A.defaultSearchProperty=function isc_GridSearch_defaultSearchProperty(){if(!this.searchProperty&&this.grid){if(isc.isA.TreeGrid(this.grid)){this.searchProperty=this.grid.getTitleField()}else{this.searchProperty=this.grid.getFieldName(0)}}},isc.A.revertState=function isc_GridSearch_revertState(){var _1=this.grid;if(this.$49d){delete this.$49d.$826;_1.refreshRow(_1.getRecordIndex(this.$49d))}
this.$49c=this.$49d=null;if(this.$827){for(var i=0;i<this.$827.length;i++)_1.data.closeFolder(this.$827[i])}
this.$827=null;this.clearValue("search")},isc.A.findNode=function isc_GridSearch_findNode(){if(!this.grid||!this.grid.getData())return;var _1=this.getValue("search");if(_1==null){this.revertState();return}
_1=_1.toLowerCase();var _2=this.$49c==_1&&this.$49d;this.$49c=_1;var _3=this.grid;var _4=isc.isA.TreeGrid(_3)?_3.data.getAllNodes():_3.getData();var _5=this.$49d?_4.indexOf(this.$49d):0;if(_2)_5++;if(this.$49d){delete this.$49d.$826;_3.refreshRow(_3.getRecordIndex(this.$49d));this.$49d=null}
var _6=this.findNext(_4,_5,_1);if(!_6)_6=this.findNext(_4,0,_1);if(_6){this.$49d=_6;_6.$826=_1;if(this.$827){for(var i=0;i<this.$827.length;i++)_3.data.closeFolder(this.$827[i])}
this.$827=null;if(isc.isA.TreeGrid(_3)){var _8=_3.data.getParents(_6);this.$827=[];for(var i=0;i<_8.length;i++){var _9=_8[i];if(!_3.data.isOpen(_9)){this.$827.add(_9);_3.data.openFolder(_9)}}
if(_3.data.isFolder(_6)&&!_3.data.isOpen(_6)){_3.data.openFolder(_6);this.$827.add(_6)}}
var _10=_3.getRecordIndex(_6);_3.refreshRow(_10);_3.scrollRecordIntoView(_10)}},isc.A.findNext=function isc_GridSearch_findNext(_1,_2,_3){for(var i=_2;i<_1.getLength();i++){var _5=_1.get(i);if(_5[this.searchProperty]&&_5[this.searchProperty].toLowerCase().contains(_3)){return _5}}});isc.B._maxIndex=isc.C+6;isc.ClassFactory.defineClass("ConfirmDeleteProjectDialog",isc.Dialog);isc.A=isc.ConfirmDeleteProjectDialog.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.canDeleteDataSources=true;isc.A.width=360;isc.A.height=138;isc.A.isModal=true;isc.A.canDragReposition=true;isc.A.keepInParentRect=true;isc.A.placement="none";isc.A.autoDraw=false;isc.A.autoSize=true;isc.A.autoCenter=true;isc.A.title=isc.Dialog.CONFIRM_TITLE;isc.A.autoFocusButton=1;isc.A.warningMessage="Delete project '\${projectName}' from server? This operation cannot be undone.";isc.A.confirmationFormDefaults={_constructor:"DynamicForm",autoDraw:false,width:"100%",numCols:2};isc.B.push(isc.A.initWidget=function isc_ConfirmDeleteProjectDialog_initWidget(){this.icon=this.confirmIcon;this.message=this.warningMessage.evalDynamicString(this,{projectName:this.projectName});this.Super("initWidget",arguments)},isc.A.createChildren=function isc_ConfirmDeleteProjectDialog_createChildren(){this.Super("createChildren",arguments);var _1=(this.canDeleteDataSources?" and DataSources":"");var _2=[{name:"deleteAllResources",type:"boolean",title:"Also remove all Screens"+_1+" that are part of the project",changed:function(_4,_5,_6){if(_6){var _3="Permanently remove all Screens"+_1+" for this project? This operation cannot be undone. Other projects that use the same Screens "+_1+" will also lose access to them.";isc.confirm(_3,function(_7){if(!_7)_5.delayCall("setValue",[false])},{buttons:[isc.Dialog.CANCEL,isc.Dialog.OK],autoFocusButton:1})}}}];this.confirmationForm=this.createAutoChild("confirmationForm",{fields:_2});this.addItem(this.confirmationForm,1)},isc.A.saveData=function isc_ConfirmDeleteProjectDialog_saveData(){this.deleteAllResources=this.confirmationForm.getValue("deleteAllResources")});isc.B._maxIndex=isc.C+3;isc.ClassFactory.defineClass("ConfirmOnceDialog",isc.Dialog);isc.A=isc.ConfirmOnceDialog.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width=360;isc.A.height=138;isc.A.isModal=true;isc.A.canDragReposition=true;isc.A.keepInParentRect=true;isc.A.placement="none";isc.A.autoDraw=false;isc.A.autoSize=true;isc.A.autoCenter=true;isc.A.title=isc.Dialog.CONFIRM_TITLE;isc.A.autoFocusButton=1;isc.A.confirmationFormDefaults={_constructor:"DynamicForm",autoDraw:false,width:"100%",numCols:1,colWidths:["*"],cellPadding:0};isc.B.push(isc.A.initWidget=function isc_ConfirmOnceDialog_initWidget(){if(this.icon)this.icon=this.warnIcon;this.Super("initWidget",arguments)},isc.A.show=function isc_ConfirmOnceDialog_show(){this.Super("show",arguments);if(this.toolbar!=null&&this.autoFocus){var _1=this.$203g();if(_1)_1.focus()}},isc.A.createChildren=function isc_ConfirmOnceDialog_createChildren(){this.Super("createChildren",arguments);var _1=this.builder,_2=this.dialogId;var _3=[{name:"dontShowAgain",type:"boolean",title:"Don't show this message again",showTitle:false,changed:function(_5,_6,_7){_1.setHelpDialogEnabled(_2,!_7)},showIf:function(){return!_1.hostedmode||!_1.userIsGuest()}}];this.confirmationForm=this.createAutoChild("confirmationForm",{fields:_3});this.confirmationStack=this.createAutoChild("messageStack",null,isc.HLayout);var _4=this.iconWidth||this.messageIconDefaults.width;this.confirmationStack.addMembers([isc.LayoutSpacer.create({width:_4}),this.confirmationForm]);this.addItem(this.confirmationStack,1)});isc.B._maxIndex=isc.C+3;isc.Notify.configureDefaultSettings({position:"T",duration:3000,autoFitMaxWidth:340,actionSeparator:"<br> ",styleName:"vbNotification",repositionMethod:"instant",messageControlPadding:30,messageIcon:null});isc.Notify.configureMessages("warn",{styleName:"vbWarn",messageControlPadding:35});isc.Notify.configureMessages("error",{styleName:"vbError",messageControlPadding:35});if(isc.ExpressionItem){isc.A=isc.ExpressionItem.getPrototype();isc.A.actionIconSrc="actions/addAction.png"}
isc.DataSource.create({componentSchema:true,allowAdvancedCriteria:true,operationBindings:[{operationId:"checkUploadFeature",operationType:"custom"}],isServerDS:true,addGlobalId:false,ID:"SCUploadSaveFile",fields:[{name:"path",hidden:true,validators:[],primaryKey:true},{name:"file",type:"binary",validators:[]},{hidden:true,name:"file_dir",validators:[]}]})
isc.defineClass("MockupImporter");isc.A=isc.MockupImporter;isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.$970=function isc_c_MockupImporter__isValidID(_1){return(_1.match(isc.MockupImporter.$971)!=null)},isc.A.$972=function isc_c_MockupImporter__createStrRegexp(_1){return _1+"(?:[^\\"+_1+"]|\\.)*?"+_1},isc.A.$973=function isc_c_MockupImporter__createKeyValueRegexp(_1,_2,_3){return"\\s*"+_1+"\\s*"+_2+"\\s*"+_3+"\\s*"},isc.A.$974=function isc_c_MockupImporter__createEntryRegexp(_1){var _2="("+isc.MockupImporter.$972("'")+")",_3="("+isc.MockupImporter.$972("\"")+")",_4="([^;\\s"+_1+"](?:[^;"+_1+"]*[^;\\s"+_1+"])?)",_5="(?:"+_2+"|"+_3+"|"+_4+")",_6=isc.MockupImporter.$973(_5,_1,_5),_7="^(?:(?:"+_6+")|([^;]*))";return _7},isc.A.$975=function isc_c_MockupImporter__parseCustomProperties(_1){var _2=function(_1,_15){var _3=[],_4=[],_5=[];for(var j=0,_7=_1.length;j<_7;++j){var s=_1.substring(j);var _9=s.match(_15);if(_9[7]!=null){var _10=_9[7].toString().trim();if(_10!=""){_5.push(_10)}}else{var _11,_12;if(_9[1]!=null)_11=eval(_9[1].toString());else if(_9[2]!=null)_11=eval(_9[2].toString());else _11=_9[3].toString();if(_9[4]!=null)_12=eval(_9[4].toString());else if(_9[5]!=null)_12=eval(_9[5].toString());else _12=_9[6].toString();_3.push(_11);_4.push(_12)}
j+=_9[0].toString().length}
return{keys:_3,values:_4,errors:_5}};var _13=_2(_1,isc.MockupImporter.$976),_14=_2(_1,isc.MockupImporter.$977);return(_13.errors.length<=_14.errors.length?_13:_14)},isc.A.getDataViewXml=function isc_c_MockupImporter_getDataViewXml(_1,_2,_3){var _4=(_3?"autoID":"ID"),_5=(_2?" "+_4+"=\""+_2+"\"":"");var _6='<DataView width="100%" height="100%"\n          overflow="hidden" autoDraw="true"'+_5+'>\n    <minMemberLength>18</minMemberLength>\n    <members>\n        <Canvas '+_4+'="MockupCanvas">\n            <children>\n';for(var i=0;i<_1.length;i++){_6+='                <Canvas ref="'+_1[i]+'"/>\n'}
_6+='            </children>\n        </Canvas>\n    </members>\n</DataView>\n';return _6});isc.B._maxIndex=isc.C+6;isc.A=isc.MockupImporter;isc.A.$971=new RegExp("^[a-zA-Z_$][a-zA-Z0-9_$]*$");isc.A.$976=new RegExp(isc.MockupImporter.$974(":"));isc.A.$977=new RegExp(isc.MockupImporter.$974("="));isc.A=isc.MockupImporter.getPrototype();isc.A.transformRules=isc.Page.getToolsDir()+"visualBuilder/balsamiqTransformRules.js";isc.A.useLayoutHeuristics=true;isc.A.sloppyEdgeControlOverflow=10;isc.A.maxControlOverlap=20;isc.A.stackContainerFillInset=20;isc.A.labelMaxOffset=10;isc.A.dropExtraProperties=true;isc.A.tallFormItems=["TextAreaItem","RadioGroupItem","SpacerItem","ButtonItem"];isc.A.ignoreWidthFormItems=["DateItem","StaticTextItem"];isc.A.dropMarkup=true;isc.A.trimSpace=true;isc.A.fillSpace=true;isc.A.trimWhitespace=true;isc.A.formsGridCellWidth=5;isc.A.formsGridCellHeight=22;isc.A.maxOuterControlsDistance=50;isc.A.stackFlexMaxSizeMatch=10;isc.A.formExtraSpaceThreshold=15;isc.A.formExtraWidthThreshold=30;isc.A.defaultButtonSize=27;isc.A.buttonMinimumChangeSize=3;isc.A.$87q=["HStack","HLayout","VStack","VLayout"];isc.A.$87t=["ButtonItem","CheckboxItem","RadioItem"];isc.A.fieldNamingConvention="camelCaps";isc.A.warnings="";isc.A=isc.MockupImporter.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.$85p=[];isc.A.$z=false;isc.B.push(isc.A.init=function isc_MockupImporter_init(){this.globalIDs=[];this.allowedExtraProperties=[];this.$878={};this.$90r=[];var _1=this;isc.FL.loadJSFiles(this.transformRules,function(){_1.$z=true;var _2=window.transformRules;if(_2==null){isc.logWarn("The MockupImporter could not find window.transformRules.");_2={classTranslations:{},propertyTranslations:{},formItems:[],markupItems:[],widgetPropertyTranslations:{}}}
_1.$98p=_2;_2.mockupImporter=_1;for(var i=0;i<_1.$85p.length;i++){var _4=_1.$85p[i];try{_1.fireCallback(_4.callback,_4.argNames,_4.args)}catch(e){_1.logError("MockupImporter.init(): "+e+". Stack: "+e.stack)}};_1.$85p.clear();delete _1.$85p})},isc.A.bmmlToXml=function isc_MockupImporter_bmmlToXml(_1,_2){if(!this.$z){this.$85p.add({callback:"bmmlToXml",argNames:["bmmlXmlString","callback"],args:[_1,_2]})}else{this.warnings="";this.$98y(_1,_2)}},isc.A.$98y=function isc_MockupImporter__bmmlToXml(_1,_2,_3){var _4=isc.XMLTools.toJS(isc.XMLTools.parseXML(_1));this.$199f(_4,_2,_3)},isc.A.bmmlJsToXml=function isc_MockupImporter_bmmlJsToXml(_1,_2,_3,_4){if(!this.$z){this.$85p.add({callback:"bmmlJsToXml",argNames:["bmmlJsString","callback","symbolLibraries","assets"],args:[_1,_2,_3,_4]})}else{this.warnings="";var _5=(isc.isA.String(_1)?isc.JSON.decode(_1):_1);if(_3){for(var i=0;i<_3.length;i++){var _7=_3[i],_1=_7.data;_7.data=(isc.isA.String(_1)?isc.JSON.decode(_1):_1)}}
this.assets=_4;this.$199f(_5,_2,null,_3)}},isc.A.$199f=function isc_MockupImporter__bmmlJsToXml(_1,_2,_3,_4){var _5=_3;if(_5==null){_5=this.mockupPath}else{this.dropMarkup=true}
if(this.$878[_5]==null){this.$878[_5]={widgets:[]}}
if(_1.mockup)_1=_1.mockup;var _6=this.$873(_1,_5);if(_5==this.mockupPath&&!this.dropMarkup){this.$978=[]}
for(var i=0;i<_6.length;i++){if(_6[i]._constructor=="MockupElement"&&_6[i].controlName!="com.balsamiq.mockups::HSplitter"&&_6[i].controlName!="com.balsamiq.mockups::VSplitter"){if(_5==this.mockupPath&&!this.dropMarkup){this.$978.add(isc.clone(_6[i]))}
_6.removeAt(i);i--}else if(this.dropMarkup&&_6[i].specialProperties&&_6[i].specialProperties.markup)
{_6.removeAt(i);i--}}
var _8=this;var _9=function(_12){var _10=_8.$98p;if(_12==null){_2(null);return}
_8.adjustLayoutPosition(_12);if(_5==_8.mockupPath&&_8.$978){var _11=_8.$979(_12);if(_11.length==0){_12.addList(_8.$978);delete _8.$978}}
if(_8.useLayoutHeuristics){_12=_8.processHeuristics(_12)}
_8.postProcessLayout(_12);_8.$878[_5].layout=_12;_8.$879(_12,_3,_2)};if(_4){this.$199g(_4);this.$199h(_6,_4,_9)}else{this.$874(_6,_9)}},isc.A.reifyComponentXml=function isc_MockupImporter_reifyComponentXml(_1,_2){if(!this.$z){this.$85p.add({callback:"reifyComponentXml",argNames:["componentXmlString","callback"],args:[_1,_2]})}else{this.warnings="";var _3=this;isc.DMI.callBuiltin({methodName:"xmlToJS",arguments:[_1],callback:function(_4,_5){_3.$150t(_5,_2)}})}},isc.A.$150t=function isc_MockupImporter__reifyComponentXml(_1,_2){var _3=this,_4=isc.EditContext.create();_4.getPaletteNodesFromJS(_1,function(_17){var _5=_17,_6=_3.$98p,_7=_6.classTranslations;if(_17.length==1&&_17[0].defaults.components){var _8=_17[0].defaults;_5=[];_5.addList(_8.dataSources);_5.addList(_8.components)}
for(var i=0;i<_5.length;i++){var _10=_5[i];var _11=isc.DS.getAutoIdField(_10),_12=isc.DS.getToolAutoIdField(_10);if(_11&&_12&&!_10[_11]&&_10[_12]){_10[_11]=_10[_12]}
delete _10[_12];if(_10._constructor=="DynamicForm"&&_10.fields.length==1){var _13=_10.fields[0],_14=_3.getBalsamiqControlNameForSCControl(_13._constructor);if(!_10.specialProperties)_10.specialProperties={};_10.specialProperties.controlName=_14;_10.specialProperties.markup=false;_10.fields[0].specialProperties=isc.shallowClone(_10.specialProperties)}
if(!_10.specialProperties||!_10.specialProperties.controlName){var _14=_3.getBalsamiqControlNameForSCControl(_10._constructor);if(_14){if(!_10.specialProperties)_10.specialProperties={};_10.specialProperties.controlName=_14}}
if(_10.zIndex==null)_10.zIndex=100000}
var _15=_5;_3.adjustLayoutPosition(_15);if(_3.useLayoutHeuristics){_15=_3.processHeuristics(_15)}
_3.postProcessLayout(_15);_3.$209f(_15);if(_2){var _16=isc.EditContext.serializeDefaults(_3.$98a(_15));_2(_16.replace(/\r/g,"\n"),_15,_3.$134x(_15))}},[isc.RPC.ALL_GLOBALS])},isc.A.$209f=function isc_MockupImporter__setAutoIds(_1,_2){for(var _3=0;_3<_1.length;_3++){var _4=_1[_3];var _5=(_2?_2.getAutoIdField(_4):isc.DS.getAutoIdField(_4)),_6=(_2?_2.getToolAutoIdField(_4):isc.DS.getToolAutoIdField(_4));if(_5&&_6&&_4[_5]&&!_4[_6]){_4[_6]=_4[_5]}
if(_5&&_6&&_4[_5]&&_4[_6]){delete _4[_5]}
var _7=(_4.items?"items":(_4.fields?"fields":null)),_8=_4[_7],_9=null;if(_8){var _2=isc.DataSource.getNearestSchema(_4),_10=_2.getField(_7);if(_10)_9=isc.DataSource.getNearestSchema(_10.type)}
if(_8)this.$209f(_8,_9)}},isc.A.adjustLayoutPosition=function isc_MockupImporter_adjustLayoutPosition(_1){if(this.trimSpace){var _2=10000;var _3=10000;for(var i=0;i<_1.length;i++){if(_1[i].left!=null&&_1[i].top!=null){_2=Math.min(_2,_1[i].left);_3=Math.min(_3,_1[i].top)}}
for(var i=0;i<_1.length;i++){if(_1[i].left!=null&&_1[i].top!=null){_1[i].left-=_2;_1[i].top-=_3}}}},isc.A.postProcessLayout=function isc_MockupImporter_postProcessLayout(_1){var _2=this.$98p;for(var i=0;i<_1.length;i++){var _4=_1[i];var _5=_4.specialProperties;if(_5!=null&&(_5.overrideWidth||_5.overrideHeight))
{if(_5.overrideWidth){if(_4._constructor=="DynamicForm"){_4.width="100%"}else{_4.width="*"}}
if(_5.overrideHeight){if(_4._constructor=="DynamicForm"){_4.height="100%"}else{_4.height="*"}}}
if(_5!=null&&(_5.fullWidth||_5.fullHeight)&&_4._constructor!="FacetChart")
{if(_5.containerName=="TabSet"||_5.containerName=="Window"||_5.containerName=="SectionStack"||_5.containerName=="HStack"||_5.containerName=="HLayout"||_5.containerName=="VLayout")
{if(_5.fullWidth){delete _4.width}
if(_5.fullHeight){delete _4.height}}else if(_5.containerName=="VStack"||_5.controlName=="com.balsamiq.mockups::FieldSet"||_5.controlName=="com.balsamiq.mockups::Canvas"||_5.controlName=="com.balsamiq.mockups::TabBar")
{if(_5.fullWidth){_4.width="100%"}
if(_5.fullHeight){_4.height="100%"}}}
delete _4.absX;delete _4.absY;if(_4._constructor=="DynamicForm"&&_4.isGroup!=true&&_4.height!="*")
{if(_4.specialProperties.calculatedHeight!=null){_4.height=_4.specialProperties.calculatedHeight;if(_4.padding!=null){_4.height+=(2*_4.padding);_4.specialProperties.calculatedHeight+=(2*_4.padding)}}}
if(_4.specialProperties){var _6=_4.specialProperties.controlName;var _7=_2.widgetPropertyTranslations[_6];if(_7&&_7.onProcessFinished){_7.onProcessFinished(_4)}}
if(_4._constructor=="DynamicForm"){var _8=_4.items||_4.fields;if(_8){for(var j=0;j<_8.length;j++){var _10=_8[j].specialProperties;if(_10){var _6=_10.controlName;var _7=_2.widgetPropertyTranslations[_6];if(_7&&_7.onProcessFinished){_7.onProcessFinished(_8[j])}}}}}}},isc.A.getBalsamiqControlNameForSCControl=function isc_MockupImporter_getBalsamiqControlNameForSCControl(_1){var _2=this.$98p,_3=_2.classTranslations,_4;for(var _5 in _3){if(_3[_5]==_1){_4=_5;break}}
return _4},isc.A.$879=function isc_MockupImporter__processLinks(_1,_2,_3){if(this.$88a==null){this.$88a=0}
var _4=this;var _5=0;for(var i=0;i<_1.length;i++){var _7=[_1[i]];if(_1[i]._constructor=="DynamicForm"&&_1[i].items){_7=_1[i].items}
if(_1[i]._constructor=="SectionStack"&&_1[i].specialProperties.widgets){_7=_1[i].specialProperties.widgets;_7.add(_1[i])}
for(var _8=0;_8<_7.length;_8++){var _9=_7[_8];if(_9.specialProperties==null||(_9.specialProperties.hrefs==null&&_9.specialProperties.href==null))continue;var _10=null;if(_9.specialProperties.hrefs){if(isc.isA.String(_9.specialProperties.hrefs)){_10=_9.specialProperties.hrefs.split(",")}else{}}else if(_9.specialProperties.href){_10=[_9.specialProperties.href]}
if(_10==null)continue;var _11=this.mockupPath.substring(0,this.mockupPath.lastIndexOf("/"));_9.specialProperties.links=[];for(var j=0;j<_10.length;j++){var _13=_10[j].split("&bm;");var _14=_13[1];if(_14==null){_9.specialProperties.links.add(null);continue}
_14=_11+"/"+_14;_9.specialProperties.links.add({fileName:_14,name:_13[0]});if(this.$878[_14]){this.$878[_14].widgets.add(_9)}else{this.$878[_14]={widgets:[_9],fileName:_14,layoutName:_13[0]};_5++;var _15=function(_17){_5--;if(_5==0){if(_17==null){_3(null)}else if(_2){_3(_4.$360(_1))}else{_1=_4.$88b(_1);if(_4.$978){_1.addList(_4.$978)}
var _16=isc.EditContext.serializeDefaults(_4.$98a(_1));_3(_16.replace(/\r/g,"\n"),[],_4.$134x(_1));if(_4.$90r.length>0){_4.logWarn("During import these custom components were not found: "+_4.$90r)}}}};this.$1335(_14,_15)}}}}
if(_5==0){if(_2){_3(this.$360(_1))}else if(this.$88a==0){if(this.$978){_1.addList(this.$978)}
var _16=isc.EditContext.serializeDefaults(this.$98a(_1));_3(_16.replace(/\r/g,"\n"),_1,this.$134x(_1));if(this.$90r.length>0){this.logWarn("During import these custom components were not found: "+this.$90r)}}}},isc.A.$134x=function isc_MockupImporter__getLayoutIds(_1){var _2=[];for(var i=0;i<_1.length;i++){if(_1[i].ID)_2.add(_1[i].ID)}
return _2},isc.A.$1335=function isc_MockupImporter__loadLinkedLayout(_1,_2,_3){var _4=this;isc.DMI.callBuiltin({methodName:"loadFile",arguments:[_1],callback:function(_12){var _5=_3||_1;if(_12.status==isc.RPCResponse.STATUS_FAILURE){var _6=_1.lastIndexOf("/");var _7=_1.substring(0,_6);var _8=_1.substring(_6+1);if(!_7.endsWith("/assets")){var _9=_7+"/assets/"+_8;_4.$1335(_9,_2,_5);return}
if(_4.$90q==null){_4.$90q=[]}
_4.$90q.add(_5);var _10="<ul><li>"+_4.$90q.join("<li>")+"</ul>";isc.warn("This mockup may not render correctly in Reify as the following resource"+(_4.$90q.length>1?"s are":" is")+" missing:"+_10+"<P>If you choose to continue Reify will add placeholders.",function(){},{buttons:[isc.Button.create({title:"Abort",click:function(){this.topElement.hide();_2(null)}}),isc.Button.create({title:"Continue",click:function(){this.topElement.hide();for(var i=0;i<_4.$90q.length;i++){_4.$878[_4.$90q[i]].layout=[];_2(_5)}}})]});return}
_4.$98y(_12.data,_2,_5)},requestParams:{willHandleError:true}})},isc.A.$98a=function isc_MockupImporter__cleanLayout(_1){for(var _2=0;_2<_1.length;_2++){var _3=_1[_2];delete _3.specialProperties;if(_3._constructor=="DynamicForm"){var _4=_3.items||_3.fields;if(_4){for(var i=0;i<_4.length;i++){var _6=_4[i];if(this.ignoreWidthFormItems.contains(_6._constructor)){delete _6.width}else if(isc.isA.Number(_6.width)){var _7=isc[_6._constructor].getInstanceProperty("width");if(Math.abs(_6.width-_7)<this.formExtraWidthThreshold){delete _6.width}}
_6.$97p=_6._constructor;delete _6._constructor;if(_6.showTitle==true)delete _6.showTitle}}}
if(_3._constructor=="TabSet"&&_3.selectedTab==0){delete _3.selectedTab}
var _8=_3.items||_3.fields||_3.members;if(_8)this.$98a(_8)}
return _1},isc.A.$979=function isc_MockupImporter__getLinks(_1){var _2=[];for(var i=0;i<_1.length;i++){var _4=[_1[i]];if(_1[i]._constructor=="DynamicForm"&&(_1[i].items||_1[i].fields)){_4=_1[i].items||_1[i].fields}
if(_1[i]._constructor=="SectionStack"&&_1[i].specialProperties.widgets){_4=_1[i].specialProperties.widgets;_4.add(_1[i])}
for(var _5=0;_5<_4.length;_5++){var _6=_4[_5];if(_6.specialProperties==null||(_6.specialProperties.hrefs==null&&_6.specialProperties.href==null))continue;if(_6.specialProperties.hrefs){if(isc.isA.String(_6.specialProperties.hrefs)){_2.addAll(_6.specialProperties.hrefs.split(","))}else{}}else if(_6.specialProperties.href){_2.add(_6.specialProperties.href)}}}
return _2},isc.A.$88b=function isc_MockupImporter__mergeLinksLayout(_1){for(var _2 in this.$878){var _3=this.$878[_2];if(_2==this.mockupPath){_3.prefix="";_3.processed=true}else{_3.prefix=_3.layoutName.replace(/[^a-zA-Z0-9_]/g,"_")+"_"}
_3.topLevelElements=this.$88q(_3.layout)}
var _4=this.mockupPath.substring(0,this.mockupPath.lastIndexOf("/"));var _2=this.mockupPath;var _5=[];do{var _3=this.$878[_2];if(_3.layout.length>0){if(_3.prefix!=""){this.$88s(_3.layout,_3.prefix)}
this.$88r(_3);if(_3.prefix!=""){this.$88s(_3.layout,_3.prefix);for(var i=0;i<_3.topLevelElements.length;i++){_3.topLevelElements[i].autoDraw=false}}
_5.addList(_3.layout)}
_2=null;for(var _7 in this.$878){var _3=this.$878[_7];if(_3.processed!=true){_2=_7;_3.processed=true;break}}}while(_2);for(var _7 in this.$878){var _3=this.$878[_7];if(_3.activateCode==null){_3.activateCode=this.$88t(_3.layout)}
_3.showCode=this.$88u(_3);_3.hideCode=this.$88v(_3)}
for(var _2 in this.$878){if(this.$878[_2].mergedWith)continue;_1=this.$878[_2].layout
for(var i=0;i<_1.length;i++){var _8=_1[i];if(_8.specialProperties&&_8.specialProperties.links&&(_8._constructor!="TabSet"&&_8._constructor!="SectionStack"))
{var _9=_8.specialProperties.links;for(var j=0;j<_9.length;j++){if(_9[j]==null)continue;var _11=_9[j].fileName;var _12=this.$90s(_11,_2,_8.customData,_5);if(_8._constructor=="TreeGrid"||_8._constructor=="ListGrid")
{if(_8.selectionChanged==null){_8.selectionChanged=""}
_8.selectionChanged+="if (this.getRecordIndex(record) == "+(j-1)+") {"+_12+"}"}else{_8.click=_12}}}else if(_8._constructor=="DynamicForm"){var _13=_8.items||_8.fields;for(var j=0;j<_13.length;j++){if(_13[j].specialProperties&&_13[j].specialProperties.links)
{var _9=_13[j].specialProperties.links;for(var k=0;k<_9.length;k++){if(_9[k]==null)continue;var _11=_9[k].fileName;_8.items[j].click=this.$90s(_11,_2,_13[j].customData,_5)}}}}else if(_8._constructor=="SectionStack"&&_8.specialProperties.widgets){var _13=_8.specialProperties.widgets;for(var j=0;j<_13.length;j++){if(_8!=_13[j]&&_13[j].specialProperties&&_13[j].specialProperties.links)
{var _9=_13[j].specialProperties.links;for(var k=0;k<_9.length;k++){if(_9[k]==null)continue;var _11=_9[k].fileName;_13[j].click=this.$90s(_11,_2,_13[j].customData,_5)}}}}else if(_8._constructor=="TabSet"&&_8.specialProperties.links){var _15=_8.tabs;for(var j=0;j<_15.length;j++){var _16=_8.specialProperties.links[j];if(_16){var _11=_16.fileName;_15[j].click=this.$90s(_11,_2,_15[j].customData,_5)}}}}}
return _5},isc.A.$90s=function isc_MockupImporter__constructActivateCode(_1,_2,_3,_4){var _5=this.$878[_1];var _6="";if(_3){var _3=decodeURIComponent(_3);var _7=_3.indexOf("linkTarget=");if(_7>=0){var _8=_3.substring(_7+"linkTarget=".length).trim();if(_8.contains("\n")){_8=_8.substring(0,_8.indexOf("\n")).trim()}
_8=_8.replace(/['"]/g,"");var _9=null;for(var k=0;k<_4.length;k++){if(_4[k].customID==_8){_9=_4[k];break}}
if(_9==null){this.$90r.add(_8);return _6+_5.activateCode}
if(_9._constructor=="Window"){_6="for (var i = 0; i < "+_9.ID+".items.length; i++) { "+_9.ID+".items[i].hide()}\n";for(var k=0;k<_5.topLevelElements.length;k++){if(_9.ID==_5.topLevelElements[k].ID){for(var l=0;l<_9.items.length;l++){_6+=_9.ID+".addItem("+_9.items[l].ref+");";_6+=_9.items[l].ref+".show();"}}else{_6+=_9.ID+".addItem("+_5.topLevelElements[k].ID+");";_6+=_5.topLevelElements[k].ID+".show();"}}}else if(_9._constructor=="TabSet"){var _12=_9.selectedTab==null?0:_9.selectedTab;if(_12>=_9.tabs.length)_12=_9.tabs.length-1;var _13=_9.ID+".tabs["+_12+"].pane";_6="for (var i = 0; i < "+_13+".members.length; i++) { "+_13+".members[i].hide()}\n";for(var k=0;k<_5.topLevelElements.length;k++){if(_9.ID==_5.topLevelElements[k].ID){var _14=_9.specialProperties.innerItems;for(var l=0;l<_14.length;l++){_6+=_13+".addMember("+_14[l].ID+");";_6+=_14[l].ID+".show();"}}else{_6+=_13+".addMember("+_5.topLevelElements[k].ID+");";_6+=_5.topLevelElements[k].ID+".show();"}}}else if(_9._constructor=="SectionStack"){var _15=_9.ID+".sections["+_9.$88w+"]";_6="for (var i = "+_15+".items.length - 1; i >= 0; i--) { "+_15+".items[i].hide();\n"+_9.ID+".removeItem("+_9.$88w+","+_15+".items[i])}\n";for(var k=0;k<_5.topLevelElements.length;k++){if(_9.ID==_5.topLevelElements[k].ID){var _14=_9.specialProperties.innerItems;for(var l=0;l<_14.length;l++){_6+=_9.ID+".addItem("+_9.$88w+","+_14[l].ID+", "+k+");";_6+=_14[l].ID+".show();\n"}}else{_6+=_9.ID+".addItem("+_9.$88w+","+_5.topLevelElements[k].ID+", "+k+");";_6+=_5.topLevelElements[k].ID+".show();\n"}}}else{_6="for (var i = 0; i < "+_9.ID+".members.length; i++) { "+_9.ID+".members[i].hide()}\n";for(var k=0;k<_5.topLevelElements.length;k++){if(_9.ID==_5.topLevelElements[k].ID){var _14=_9.specialProperties.innerItems;for(var l=0;l<_14.length;l++){_6+=_9.ID+".addMember("+_14[l].ID+");";_6+=_14[l].ID+".show();"}}else{_6+=_9.ID+".addMember("+_5.topLevelElements[k].ID+");";_6+=_5.topLevelElements[k].ID+".show();"}}}}
return _6+_5.activateCode}else{if(_5.prefix!=this.$878[_2].prefix){var _16=this.$878[_2];if(_16.mergedWith!=null){if(_16.mergedWith==""){_16=this.$878[this.mockupPath]}else{_16=this.$878[_16.mergedWith]}}
_6+=_16.hideCode;_6+=_5.showCode}
_6+=_5.activateCode;return _6}},isc.A.$88r=function isc_MockupImporter__mergeLinksLayoutProcessTabsAndStacks(_1){var _2=_1.layout;do{var _3=false;for(var i=0;i<_2.length;i++){var _5=_2[i];if(_5.specialProperties&&_5.specialProperties.links&&(_5._constructor=="TabSet"||_5._constructor=="SectionStack")){var _6=_5.specialProperties.links;for(var j=0;j<_6.length;j++){if(_6[j]==null)continue;var _8=this.$878[_6[j].fileName];if(!_8.processed&&_8.layout.length>0&&this.$88c(_2,_8,_5))
{var _9=null;if(_5._constructor=="TabSet"){_9=this.$88d(j,_5,_8,_8.prefix)}else{_9=this.$88e(j,_5,_8,_8.prefix)}
var _10=_9.layout;if(_10){_2.addListAt(_10,_2.indexOf(_5)-1);_3=true;_8.processed=true;_8.mergedWith=_1.prefix;_8.topLevelElements=_1.topLevelElements;_9.widget.ID=_5.ID;_8.activateCode=_5.ID+".showRecursively();\n"+this.$88t([_9.widget])+this.$88t(_10)}}}}}}while(_3)},isc.A.$88t=function isc_MockupImporter__getActivateLayoutCode(_1){var _2="";for(var i=0;i<_1.length;i++){if(_1[i]._constructor=="TabSet"){_2=_1[i].ID+".selectTab("+_1[i].selectedTab+");\n"+_2}else if(_1[i]._constructor=="SectionStack"){for(var j=0;j<_1[i].sections.length;j++){if(_1[i].sections[j].expanded){_2=_1[i].ID+".expandSection("+j+");\n"+_2}else if(_1[i].sections[j].items){_2=_1[i].ID+".collapseSection("+j+");\n"+_2}}}};return _2},isc.A.$88u=function isc_MockupImporter__getShowLayoutCode(_1){var _2="";for(var k=0;k<_1.topLevelElements.length;k++){_2+=_1.topLevelElements[k].ID+".show();\n"};return _2},isc.A.$88v=function isc_MockupImporter__getHideLayoutCode(_1){var _2="";for(var k=0;k<_1.topLevelElements.length;k++){_2+=_1.topLevelElements[k].ID+".hide();\n"};return _2},isc.A.$88q=function isc_MockupImporter__getLayoutTopLevelElements(_1){var _2=[];for(var i=0;i<_1.length;i++){if(_1[i]._constructor!="MockDataSource"&&_1[i]._constructor!="ValuesManager"&&this.$88g(_1,_1[i])==null)
{_2.add(_1[i])}};return _2},isc.A.$88d=function isc_MockupImporter__mergeTabLayout(_1,_2,_3,_4){if(_2.tabs[_1].pane)return null;var _5=this.$88f(_3,_2);if(_5==null)return null;var _6=_5.layout;this.$88s(_6,_4);_2.specialProperties.innerItems.addList(_6);for(var i=0;i<_5.widget.tabs.length;i++){var _8=_5.widget.tabs[i].pane;if(_8==null)continue;if(isc.isA.String(_8)){_2.tabs[i].pane=_4+_8}else{for(var j=0;j<_8.VStack.members.length;j++){_8.VStack.members[j]=_4+_8.VStack.members[j]};_2.tabs[i].pane=_8}
break};return _5},isc.A.$88e=function isc_MockupImporter__mergeSectionStackLayout(_1,_2,_3,_4){for(var _5=0;_5<_2.sections.length;_5++){if(_2.sections[_5].$76w!=_1)continue;var _6=this.$88f(_3,_2);if(_6==null)return;var _7=_6.layout;this.$88s(_7,_4);_2.specialProperties.innerItems.addList(_7);_2.sections[_5].items=_6.widget.sections[_5].items;return _6}},isc.A.$88s=function isc_MockupImporter__addPrefixToIds(_1,_2){for(var i=0;i<_1.length;i++){var _4=_1[i];if(_4.ID&&!_4.ID.startsWith(_2)){_4.ID=_2+_4.ID}
if(_4.dataSource&&!_4.dataSource.startsWith(_2)){_4.dataSource=_2+_4.dataSource}
if(_4.valuesManager&&!_4.valuesManager.startsWith(_2)){_4.valuesManager=_2+_4.valuesManager}
if(_4.specialProperties){var _5=_4.specialProperties.refs;if(_5){for(var j=0;j<_5.length;j++){_5[j].ref=_4.ID}}}
if(_4._constructor=="TabSet"){for(var j=0;j<_4.tabs.length;j++){if(_4.tabs[j].pane==null)continue;if(isc.isA.String(_4.tabs[j].pane)&&!_4.tabs[j].pane.startsWith(_2))
{_4.tabs[j].pane=_2+_4.tabs[j].pane}else{var _7=_4.tabs[j].pane;if(_7.VStack){for(var k=0;k<_7.VStack.members.length;k++){if(!_7.VStack.members[k].startsWith(_2)){_7.VStack.members[k]=_2+_7.VStack.members[k]}}}else if(_7.children){for(var k=0;k<_7.children.length;k++){if(!_7.children[k].ref.startsWith(_2)){_7.children[k].ref=_2+_7.children.members[k].ref}}}}}}}});isc.evalBoundary;isc.B.push(isc.A.$88c=function isc_MockupImporter__compareParentLayout(_1,_2,_3){var _4=this.$360(_1);var _5=this.$360(_2.layout);var _6=this.$88f({layout:_1},_3);var _7=this.$88f(_2,_3);if(_7==null)return false;for(var i=0;i<_6.layout.length;i++){for(var j=0;j<_4.length;j++){if(_6.layout[i].ID==_4[j].ID){_4.removeAt(j);break}}};for(var i=0;i<_7.layout.length;i++){for(var j=0;j<_5.length;j++){if(_7.layout[i].ID==_5[j].ID){_5.removeAt(j);break}}};var _10=_6.widget;var _11=_7.widget;do{_10=this.$88g(_4,_10);_11=this.$88g(_5,_11);if(_10==null||_11==null)break;if(_10._constructor=="TabSet"&&_11._constructor=="TabSet"){delete _11.layoutLeftMargin;delete _11.layoutTopMargin;delete _11.layoutRightMargin;delete _11.layoutBottomMargin;delete _10.layoutLeftMargin;delete _10.layoutTopMargin;delete _10.layoutRightMargin;delete _10.layoutBottomMargin;var _12=_10.specialProperties.innerItems;for(var i=0;i<_11.tabs.length;i++){if(_11.tabs[i].pane!=null||_10.tabs[i].pane==null){continue}
var _13=_10.tabs[i].pane;if(isc.isA.String(_13)){for(var k=0;k<_12.length;k++){var _15=_12[k]
if(_15.ID!=_13)continue;this.$88h(_4,_15)}}else{for(var j=0;j<_13.VStack.members.length;j++){for(var k=0;k<_12.length;k++)
{var _15=_12[k]
if(_15.ID!=_13.VStack.members[j])continue;this.$88h(_4,_15)}}}}}else if(_10._constructor=="SectionStack"&&_11._constructor=="SectionStack")
{var _12=_10.specialProperties.innerItems;for(var i=0;i<_11.sections.length;i++){if(_11.sections[i].items!=null||_10.sections[i].items==null)
{continue}
_10.sections[i].expanded=_11.sections[i].expanded;for(var j=0;j<_10.sections[i].items.length;j++){for(var k=0;k<_12.length;k++)
{var _15=_12[k]
if(_15.ID!=_10.sections[i].items[j].ref)continue;this.$88h(_4,_15)}};delete _10.sections[i].items}}}while(true);for(var j=0;j<_4.length;j++){if(_6.widget.ID==_4[j].ID){_4.removeAt(j);break}}
for(var j=0;j<_5.length;j++){if(_7.widget.ID==_5[j].ID){_5.removeAt(j);break}}
this.$88i(_4);this.$88i(_5);var _16=function(_19,_20){return isc.echoAll(_19)<isc.echoAll(_20)};_4.sort(_16);_5.sort(_16);var _17=isc.JSON.encode(_4);var _18=isc.JSON.encode(_5);return _17===_18},isc.A.$88h=function isc_MockupImporter__removeItemWithChildItemsFromLayout(_1,_2){for(var l=0;l<_1.length;l++){if(_1[l].ID==_2.ID){_1.removeAt(l);break}};var _4=this.$88j(_2);for(var m=0;m<_4.length;m++){for(var l=0;l<_1.length;l++){if(_1[l].ID==_4[m].ID){_1.removeAt(l);break}}};var _6=_2.specialProperties.additionalElements;if(_6){for(var m=0;m<_6.length;m++){for(var l=0;l<_1.length;l++){if(_1[l].ID==_6[m].ID){_1.removeAt(l);break}}}}},isc.A.$88g=function isc_MockupImporter__findParentWidget(_1,_2){for(var i=0;i<_1.length;i++){if(_1[i].specialProperties&&_1[i].specialProperties.innerItems){for(var j=0;j<_1[i].specialProperties.innerItems.length;j++){if(_1[i].specialProperties.innerItems[j].ID==_2.ID){return _1[i]}}}}},isc.A.$88i=function isc_MockupImporter__cleanObjects(_1){if(this.$88k(_1)){}else if(isc.isA.Array(_1)){for(var i=0;i<_1.length;i++){if(!this.$88k(_1[i])){this.$88i(_1[i])}}}else{for(var _3 in _1){if(_3=="ID"||_3=="ref"||_3=="specialProperties"||_3=="pane"||_3=="selectedTab"||_3=="zIndex"||_3=="expanded"||_3=="$88w"){delete _1[_3]}else if(!this.$88k(_1[_3])){this.$88i(_1[_3])}}}},isc.A.$360=function isc_MockupImporter__clone(_1,_2){if(_2==null)_2=10;var _3=null;if(this.$88k(_1)){_3=this.$88l(_1)}else if(isc.isA.Array(_1)){_3=[];for(var i=0;i<_1.length;i++){var _5=_1[i];if(this.$88k(_5)){_3.add(this.$88l(_5))}else if(_2==0){_3.add(isc.isA.Array(_5)?[]:{})}else{_3.add(this.$360(_5,_2-1))}}}else{_3={};for(var _6 in _1){var _5=_1[_6];if(this.$88k(_5)){_3[_6]=this.$88l(_5)}else if(_2==0){_3[_6]=(isc.isA.Array(_5)?[]:{})}else{_3[_6]=this.$360(_5,_2-1)}}}
return _3},isc.A.$88k=function isc_MockupImporter__isPlainObject(_1){var _2;return(_1===_2)||(_1==null)||isc.isA.String(_1)||isc.isA.Boolean(_1)||isc.isA.Number(_1)||isc.isA.Function(_1)||isc.isA.Date(_1)},isc.A.$88l=function isc_MockupImporter__clonePlainObject(_1){var _2;if(_1===_2)return _2;if(_1==null)return null;if(isc.isA.String(_1)||isc.isA.Boolean(_1)||isc.isA.Number(_1)||isc.isA.Function(_1))return _1;if(isc.isA.Date(_1))return _1.duplicate();return null},isc.A.$88f=function isc_MockupImporter__getWidgetContentLayout(_1,_2){if(_2._constructor=="TabSet"){var _3=this.$88m(_1.layout,_2.tabs);if(_3){return{layout:this.$88j(_3),widget:_3}}}else if(_2._constructor=="SectionStack"){var _4=this.$88n(_1.layout,_2.sections);if(_4){return{layout:this.$88j(_4),widget:_4}}}},isc.A.$88m=function isc_MockupImporter__findSameTabSet(_1,_2){for(var i=0;i<_1.length;i++){var _4=_1[i];if(_4._constructor=="TabSet"&&_4.tabs.length==_2.length){var _5=_4;var _6=true;for(var j=0;j<_2.length;j++){if(_2[j].title!=_4.tabs[j].title){_6=false;break}};if(_6){return _5}}};return null},isc.A.$88n=function isc_MockupImporter__findSameSectionStack(_1,_2){for(var i=0;i<_1.length;i++){var _4=_1[i];if(_4._constructor=="SectionStack"&&_4.sections.length==_2.length)
{var _5=_4;var _6=true;for(var j=0;j<_2.length;j++){if(_2[j].title!=_4.sections[j].title){_6=false;break}};if(_6){return _5}}};return null},isc.A.$88j=function isc_MockupImporter__getInnerComponents(_1){var _2=this.$88o(_1);for(var i=_2.length-1;i>=1;i--){for(var j=i-1;j>=0;j--){if(_2[i].ID==_2[j].ID){_2.removeAt(i);i--;break}}};return _2},isc.A.$88o=function isc_MockupImporter__getInnerComponentsRecursive(_1){var _2=[];if(_1.specialProperties.innerItems==null)return[];for(var i=0;i<_1.specialProperties.innerItems.length;i++){var _4=_1.specialProperties.innerItems[i];if(_4.specialProperties&&_4.specialProperties.innerItems){_2.addList(this.$88o(_4))}
if(_4.specialProperties&&_4.specialProperties.additionalElements){_2.addList(_4.specialProperties.additionalElements)}
_2.add(_4)};return _2},isc.A.$873=function isc_MockupImporter__convertBMMLWidgetsToISCWidgets(_1,_2){for(var p=0;p<this.globalIDs.length;p++){if(!isc.isA.String(this.globalIDs[p])){if(!(this.globalIDs[p]&&window[this.globalIDs[p].ID])){this.logWarn("Error - null entry or not a real global ID at index: "+p+" of: "+isc.echoFull(this.globalIDs))}
window[this.globalIDs[p].ID].destroy()}else if(isc.DataSource.getDataSource(this.globalIDs[p])){isc.DataSource.getDataSource(this.globalIDs[p]).destroy()}}
var _4=[];var _5;if(_1&&_1.controls){_5=_1.controls.control}else{this.logWarn("The data is not in BMML format"+(_2!=null?":  "+_2:"."));isc.warn("The file is not in BMML format.",{target:this,methodName:"bmmlImportFailed"});_5=[]}
if(!isc.isAn.Array(_5)){_5=[_5]}
for(var i=0;i<_5.length;i++){var _7=_5[i];this.$199i(_7);if("__group__"==_7.controlTypeID){_4.addList(this.convertGroup(_7))}else{_4.addList(this.convertControl(_7))}};this.globalIDs.length=0;for(var p in _4){if(_4[p].ID)this.globalIDs.push(_4[p].ID)}
return _4},isc.A.$199i=function isc_MockupImporter__downgradeControl(_1){if(_1.ID!=null&&_1.controlID==null){_1.controlID=_1.ID;delete _1.ID}
if(_1.typeID!=null&&_1.controlTypeID==null){_1.controlTypeID=(_1.typeID!="__group__"?"com.balsamiq.mockups::":"")+_1.typeID;delete _1.typeID}
if(_1.properties!=null&&_1.controlProperties==null){_1.controlProperties=_1.properties;delete _1.properties}
if(_1.children!=null&&_1.groupChildrenDescriptors==null){_1.groupChildrenDescriptors=_1.children;delete _1.children}
if(_1.groupChildrenDescriptors){var _2=_1.groupChildrenDescriptors;var _3=_2.control||_2.controls.control;for(var i=0;i<_3.length;i++){this.$199i(_3[i])}}
return _1},isc.A.$199g=function isc_MockupImporter__downgradeSymbolAssets(_1){for(var i=0;i<_1.length;i++){var _3=_1[i],_4=_3.data.mockup.controls.control;for(var k=0;k<_4.length;k++){var _6=_4[k];this.$199i(_6)}}},isc.A.$199h=function isc_MockupImporter__processSymbolsAssets(_1,_2,_3){if(!this.mockupPath){_3(_1);return}
var _4=[];for(var i=0;i<_1.length;i++){if(_1[i]._constructor=="Symbol"){var _6=_1[i];var _7=_6.symbolPath,_8=_7.ID,_9=_7.Anchor;var _10=null;for(var j=0;j<_2.length;j++){var _12=_2[j];if(_8!=_12.ID)continue;_10=_12.data.mockup;var _13;var _14=_10.controls?_10.controls.control:[];if(_9==null){_13={groupChildrenDescriptors:{control:_14},zOrder:0,width:_6.width,height:_6.height,controlTypeID:"__group__",measuredW:_6.width,measuredH:_6.height}}else{for(var k=0;k<_14.length;k++){var _16=_14[k].controlID;if(_16==_9){_13=_14[k];break}}}
_13.x=0;_13.y=0;_13=this.$875(_13,_6);this.$132v(_13);var _17=this.$873({controls:{control:[_13]}});_1.addListAt(_17,_1.indexOf(_6));_1.remove(_6)}}};_3(_1)},isc.A.$874=function isc_MockupImporter__loadSymbolsAssets(_1,_2){if(!this.mockupPath){_2(_1);return}
var _3=this.assetPath||this.mockupPath.substring(0,this.mockupPath.lastIndexOf("/"));var _4=[];var _5=[];for(var i=0;i<_1.length;i++){if(_1[i]._constructor=="Symbol"){var _7=_1[i].symbolPath;if(_7.startsWith("./")){_7=_7.substring(2)}
_7=_3+"/"+_7;var _8=_7.indexOf("#");var _9=null;if(_8>0){_9=_7.substring(_7.indexOf("#")+1);_7=_7.substring(0,_7.indexOf("#"))}
_4.add({symbol:_1[i],path:_7,symbolName:_9})
if(!_5.contains(_7)){_5.add(_7)}}};if(_5.length==0){_2(_1);return}
var _10=this,_11={},_12=0;var _13=function(){for(var j=0;j<_4.length;j++){var _15=_4[j],_16=_11[_15.path];if(_16.failed){var _17=_15.symbol;var _18={_constructor:"Label",ID:"symbol_"+j,contents:_15.symbolName,left:_17.left,top:_17.top,width:_17.width,height:_17.height,border:"1px solid black",align:"center",zIndex:_17.zIndex,specialProperties:{controlName:"com.balsamiq.mockups::Label"}};_1.addAt(_18,_1.indexOf(_17));_1.remove(_17)}else{var _19=isc.XMLTools.toJS(isc.XMLTools.parseXML(_16.data)),_18,_20=_19.controls?_19.controls.control:[];if(!isc.isAn.Array(_20))_20=[_20];if(!_15.symbolName){_18={groupChildrenDescriptors:{control:_20},zOrder:0,width:_15.symbol.width,height:_15.symbol.height,controlTypeID:"__group__",measuredW:_15.symbol.width,measuredH:_15.symbol.height}}else{for(var k=0;k<_20.length;k++){var _22=_20[k].controlProperties.controlName;if(unescape(_22)==_15.symbolName){_18=_20[k];break}}}
_18.x=0;_18.y=0;_18=_10.$875(_18,_15.symbol);_10.$132v(_18);var _23=_10.$873({controls:{control:[_18]}});_1.addListAt(_23,_1.indexOf(_15.symbol));_1.remove(_15.symbol)}}
_2(_1)};var _24=function(){var _25=[];for(var _7 in _11){if(_11[_7].failed){var _26=_7.lastIndexOf("/");_25.add(_7.substring(_26+1))}}
if(_25.length>0){var _27="<ul><li>"+_25.join("<li>")+"</ul>";isc.ask("This mockup may not render correctly in Reify as the following asset"+(_25.length>1?"s are":" is")+" missing:"+_27+"<P>If you choose to continue Reify will add placeholders.",function(){},{buttons:[isc.Button.create({title:"Abort",click:function(){this.topElement.hide();_2(null)}}),isc.Button.create({title:"Continue",click:function(){this.topElement.hide();_13()}})]})}else{_13()}};for(var i=0;i<_5.length;i++){var _28=_5[i];_11[_28]={path:_28};isc.DMI.callBuiltin({methodName:"loadFile",arguments:[_28],callback:function(_30){var _29=_30.context.data.arguments[0];if(_30.status==isc.RPCResponse.STATUS_FAILURE){_11[_29].failed=true}else{_11[_29].data=_30.data}
_12++;if(_12==_5.length){_24()}},requestParams:{willHandleError:true}})}},isc.A.$875=function isc_MockupImporter__handleSymbolOverride(_1,_2){if(_1.controlID){_1.controlID=_2.ID+"$876"+_1.controlID}else{_1.controlID=_2.ID}
_1.x+=_2.left;_1.y+=_2.top;_1.zOrder=parseInt(_1.zOrder)+_2.zIndex-1000000;var _3=(_2.override?[_2.override]:_2.overrides);if(_3){for(var o=0;o<_3.length;o++){var _5=_3[o];var _6=_5.ID||_5.controlID;var _7=_6.split(":");var _8=_1;for(var i=0;i<_7.length;i++){var _10=_8.groupChildrenDescriptors||_8.children;var _11=_10.control||_10.controls.control;for(var j=0;j<_11.length;j++){if(_11[j].controlID==_7[i]){_8=_11[j];break}}};for(var _13 in _5){if(_13!="ID"&&_13!="controlID"){for(var _14 in _8){if(_13==_14){_8[_14]=_5[_13]}}}
for(var _14 in _8.controlProperties){if(_13==_14){_8.controlProperties[_14]=_5[_13]}}}}}
return _1},isc.A.$132v=function isc_MockupImporter__realignControlsOfSymbol(_1){var _2=_1.groupChildrenDescriptors||_1.children;var _3=_2.control||_2.controls.control;if(!isc.isAn.Array(_3))_3=[_3];var _4=_3[0].x;var _5=_3[0].y;for(var i=1;i<_3.length;i++){if(_3[i].x<_4)_4=_3[i].x;if(_3[i].y<_5)_5=_3[i].y}
for(var i=0;i<_3.length;i++){_3[i].x-=_4;_3[i].y-=_5}},isc.A.convertGroup=function isc_MockupImporter_convertGroup(_1){var _2=this.$98p;var _3=[];var _4=_1.groupChildrenDescriptors||_1.children;var _5=_4.control||_4.controls.control;if(!isc.isA.Array(_5)){_5=[_5]}
for(var i=0;i<_5.length;i++){var _7=_5[i];var _8;if("__group__"==_7.controlTypeID){_8=this.convertGroup(_7)}else{_8=this.convertControl(_7)}
for(var j=0;j<_8.length;j++){var _10=_2.propertyTranslations;if(_8[j][_10.x]!=null){_8[j][_10.x]=parseInt(_8[j][_10.x])+parseInt(_1.x)}
if(_8[j][_10.y]!=null){_8[j][_10.y]=parseInt(_8[j][_10.y])+parseInt(_1.y)}
if(_8[j][_10.zOrder]!=null){_8[j][_10.zOrder]=parseInt(_8[j][_10.zOrder])+parseInt(_1.zOrder)}
if(_1.isInGroup<0||_5.length>1){_8[j].ID="group"+_1.controlID+"_"+_8[j].ID;if(_8[j].dataSource!=null){_8[j].dataSource="group"+_1.controlID+"_"+_8[j].dataSource}}}
_3.addList(_8)}
return _3},isc.A.convertControl=function isc_MockupImporter_convertControl(_1){var _2;var _3=this.$98p;var _4=this.getSCClass(_1.controlTypeID);var _5=_1.controlTypeID.substring(_1.controlTypeID.indexOf("::")+2);var _6={ID:_5+_1.controlID,_constructor:_4,specialProperties:{controlName:_1.controlTypeID}};if(_4==null){_4="MockupElement";_6._constructor=_4;_6.controlName=_1.controlTypeID}
for(var _7 in _1){if(_7!="controlProperties"&&_7!="controlTypeID"){var _8=_1[_7];var _9=this.getSCPropertyName(_1.controlTypeID,_7,_8);if(_9!=null){_6[_9]=_8}else{if(!this.dropExtraProperties||this.allowedExtraProperties.contains(_7))
{_6[_7]=_8}else{_6.specialProperties[_7]=_8}}}}
var _10;if(_1.controlProperties!=null){for(var _7 in _1.controlProperties){var _8=_1.controlProperties[_7];if(typeof _8=="string")_8=unescape(_8);if(_10===_2&&_7=="markup"){_10=(_8=="true")}
if(_7=="customID"){var _11=decodeURIComponent(_8);if(isc.MockupImporter.$970(_11)){_6.ID=_11}else{this.logWarn("Ignoring invalid customID \""+_11+"\".")}}else if(_7=="customData"){var _12=decodeURIComponent(_8),_13=isc.MockupImporter.$975(_12),_14=_13.keys,_15=_13.values,_16=_13.errors,i,_18;if(!_16.isEmpty()){var _19=isc.StringBuffer.create();_19.append("Ignoring invalid customData configurations:  ");for(i=0,_18=_16.length;i<_18;++i){if(i>0)_19.append(", ");_19.append("\"",_16[i],"\"")}
this.logWarn(_19.release(false))}
var _20=isc.MockupImporter.$970;for(i=0,_18=_14.length;i<_18;++i){var _21=_14[i],_8=_15[i];if(_20(_21)){if(_21=="schemaName"){_6.$97p=_8;delete _6._constructor;_4=null}else if(_21=="constructor"){_4=_6._constructor=_8}else{_6[_21]=_8}}else{this.logWarn("Ignoring customData for invalid property name \""+_21+"\".")}}}else{var _9=this.getSCPropertyName(_1.controlTypeID,_7,_8);_8=this.getSCPropertyValue(_1.controlTypeID,_7,_8);if(_9!=null){_6[_9]=_8}else{if(!this.dropExtraProperties||this.allowedExtraProperties.contains(_7))
{_6[_7]=_8}else{_6.specialProperties[_7]=_8}}}}}
var _22=_6.specialProperties.controlName,_23=_3.markupItems.contains(_22);_6.specialProperties.markup=_10||(_10===_2&&_23);_6=this.afterConvert(_1.controlTypeID,_4,_6);var _13=[_6];var _24=this.getAdditionalElements(_1.controlTypeID,_4,_6);if(_24!=null){if(_6.specialProperties==null){_6.specialProperties={}}
_6.specialProperties.additionalElements=[];_6.specialProperties.additionalElements.addAll(_24);_24.add(_6);_13=_24}
return _13},isc.A.getSCClass=function isc_MockupImporter_getSCClass(_1){return this.$98p.classTranslations[_1]},isc.A.getSCPropertyName=function isc_MockupImporter_getSCPropertyName(_1,_2,_3){var _4=this.$98p;var _5=_4.widgetPropertyTranslations[_1];if(_5!=null){var _6=_5[_2];if(_6!=null){return _6}}
return _4.propertyTranslations[_2]},isc.A.getSCPropertyValue=function isc_MockupImporter_getSCPropertyValue(_1,_2,_3){var _4=this.$98p.widgetPropertyTranslations[_1];if(_4!=null&&_4.controlPropertiesParser!=null){var _5=_4.controlPropertiesParser(_2,_3);if(_5!=null){if(this.trimWhitespace&&_5.MockDataSource&&_5.MockDataSource.mockDataType!="tree"){var _6=_5.MockDataSource.mockData;var _7=isc.SB.create();var _8=_6.split("\n");for(var i=0;i<_8.length;i++){var _10="";var d=_8[i].split(",");for(var j=0;j<d.length;j++){_7.append(d[j].trim());if(j+1<d.length){_7.append(",")}else if(i+1<_8.length){_7.append("\n")}}}
_5.MockDataSource.mockData=_7.release(false)}
return _5}}
return _3},isc.A.afterConvert=function isc_MockupImporter_afterConvert(_1,_2,_3){var _4=this.$98p;if(_3.zIndex!=null){_3.zIndex=1000000+parseInt(_3.zIndex)}
if(_3.width==null||_3.width=='-1'){if(_3.measuredW&&_3.measuredW!="0"){_3.width=_3.measuredW}else{if(_3.specialProperties.measuredW!="0"){_3.width=_3.specialProperties.measuredW}}}
if(_3.height==null||_3.height=='-1'){if(_3.measuredH&&_3.measuredH!="0"){_3.height=_3.measuredH}else{if(_3.specialProperties.measuredH!="0"){_3.height=_3.specialProperties.measuredH}}}
var _5=_4.widgetPropertyTranslations[_1];if(_5&&_5.afterInit){_5.afterInit(_2,_3)}
if(_5&&_5.mapAsset&&this.assets){var _6=_5.mapAsset(_2,_3,this.assets)}
if(_3.height)_3.height=parseInt(_3.height);if(_3.top)_3.top=parseInt(_3.top);if(_3.left)_3.left=parseInt(_3.left);if(_3.width)_3.width=parseInt(_3.width);if(_4.formItems.contains(_2)){_3.showTitle=false;var _7={_constructor:'DynamicForm',ID:_3.ID,height:_3.height,top:_3.top,left:_3.left,width:_3.width,zIndex:_3.zIndex,title:_3.title,items:[_3],specialProperties:_3.specialProperties};if(_3.title==null){delete _7.title;_7.numCols=1}
if(_7.height<_3.height){_3.height=_7.height}
delete _3.ID;delete _3.zIndex;delete _3.left;delete _3.top;_3=_7}
return _3},isc.A.getAdditionalElements=function isc_MockupImporter_getAdditionalElements(_1,_2,_3){var _4=this.$98p.widgetPropertyTranslations[_1];if(_4&&_4.getAdditionalElements){return _4.getAdditionalElements(_2,_3)}
return null},isc.A.processHeuristics=function isc_MockupImporter_processHeuristics(_1){var _2=[],_3=this.$98p;for(var i=0;i<_1.length;i++){if(_1[i].specialProperties){var _5=_1[i].specialProperties.controlName;var _6=_3.widgetPropertyTranslations[_5];if(_6&&_6.addChild){_2.add(_1[i]);_1[i].contained=[];_1[i].headerContained=[];_1[i].markupContained=[]}
if(_1[i].members){_1[i].contained=[]}}}
_1=this.processContainersHeuristic(_1,_2);_1=this.processStackHeuristic(_1,_2);_1=this.processFormsHeuristic(_1,_2);_1=this.removeExtraContainers(_1,_2);_1=this.processValuesManagers(_1,_2);_1=this.processVLayoutForms(_1,_2);_1=this.processAddingToContainersHeuristic(_1,_2);if(this.fillSpace){_1=this.processFluidLayoutHeuristic(_1,_2)}
_1=this.processTabVStackHeuristic(_1,_2);return _1},isc.A.processVLayoutForms=function isc_MockupImporter_processVLayoutForms(_1,_2){for(var i=0;i<_2.length;i++){var _4=_2[i];if(_4._constructor=="VLayout"||_4._constructor=="VStack"){for(var j=0;j<_4.contained.length;j++){var _6=_4.contained[j];if(_6._constructor=="DynamicForm"&&(_6.items||_6.fields)){var _7=_6.items||_6.fields;for(var k=0;k<_7.length;k++){var _9=_7[k];if(_9._constructor=="TextAreaItem"){_9.height="*"}}}}}
var _10=_4._constructor=="HStack"||_4._constructor=="HLayout";var _11=_4._constructor=="VStack"||_4._constructor=="VLayout";if(_10||_11){if((_10&&(_4.specialProperties.overrideHeight||_4.specialProperties.fullHeight))||(_11&&(_4.specialProperties.overrideWidth||_4.specialProperties.fullWidth))){for(var j=0;j<_4.contained.length;j++){var _6=_4.contained[j];if(_6.showResizeBar)_6.resizeBarTarget="next"}}}}
return _1},isc.A.processContainersHeuristic=function isc_MockupImporter_processContainersHeuristic(_1,_2){var _3=this.$98p;var _4=[];var _5=[];for(var i=0;i<_1.length;i++){if(_1[i].left!=null){_1[i].absX=_1[i].left}
if(_1[i].top!=null){_1[i].absY=_1[i].top}}
for(var i=0;i<_1.length;i++){var _7=_1[i];if(_7._constructor=="MockDataSource"){_5.addAt(_7,0)}else{var _8=this.findBestContainer(_2,_7);if(_8!=null){var _9=_8.specialProperties.controlName;var _10=_7.specialProperties.controlName;var _11=_7.specialProperties.markup;var _12=_3.widgetPropertyTranslations[_9];_7.top-=_8.absY;_7.left-=_8.absX;_7.autoDraw=false;if(_11){_8.markupContained.add(_7);_7.top-=_12.getTopMargin(_8);_7.left-=_12.getLeftMargin(_8)}else{var _13=null;if(_12.getControlAreaName){_13=_12.getControlAreaName(_8,_7)}
if(_13){_8.headerContained.add({controlAreaName:_13,control:_7})}else{_8.contained.add(_7);_7.top-=_12.getTopMargin(_8);_7.left-=_12.getLeftMargin(_8);var _14=_3.widgetPropertyTranslations[_10];if(_14&&_14.sloppyEdgeControl){if((_7.left+_7.width)>_8.width){_7.width=_8.width-_7.left}
if((_7.top+_7.height)>_8.height){_7.height=_8.height-_7.top}}}}
_7.top=Math.max(0,_7.top);_7.left=Math.max(0,_7.left)}
_4.add(_7)}}
var _15=[];for(var i=0;i<_4.length;i++){var _7=_4[i];var _16=this.getAllChildItems(_7);if(_16.length==0){_15.add(_7,0)}else{var _17=-1;for(var j=0;j<_16.length;j++){var _19=_15.indexOf(_16[j]);if(_19>=0&&_17<_19){_17=_19}}
if(_17>=0){_15.add(_7,_17+1)}else{_15.add(_7,0)}}}
var _20=[];for(var i=0;i<_15.length;i++){var _7=_15[i];if(_2.contains(_7))continue;var _21=false;for(var j=0;j<_2.length;j++){var _8=_2[j];if((_8.contained&&_8.contained.contains(_7))||(_8.markupContained&&_8.markupContained.contains(_7)))
{_21=true;break}
if(_8.headerContained){for(var k=0;k<_8.headerContained.length;k++){if(_8.headerContained[k].control==_7){_21=true;break}}
if(_21){break}}}
if(!_21){_20.add(_7)}}
if(_20.length>0){for(var j=0;j<_20.length-1;j++){_20[j].autoDraw=false;var _23={ID:"outer_"+j,_constructor:"VStack",fake:true,contained:[_20[j]],markupContained:[],specialProperties:{controlName:"Stack"},top:_20[j].top,left:_20[j].left,width:_20[j].width,height:_20[j].height};var _24;do{_24=false;for(var k=j+1;k<_20.length;k++){var _25=_20[k];var _26=_25.left;var _27=_25.left+_25.width;var _28=_25.top;var _29=_25.top+_25.height;var _30=_23.left;var _31=_23.left+_23.width;var _32=_23.top;var _33=_23.top+_23.height;var _34=_30-this.maxOuterControlsDistance;var _35=_31+this.maxOuterControlsDistance;var _36=_32-this.maxOuterControlsDistance;var _37=_33+this.maxOuterControlsDistance;var _38=_26<_35&&_27>_34&&_28<_37&&_29>_36;if(_38){_23.contained.add(_25);_25.autoDraw=false;var _39=Math.max(_33,_29);var _40=Math.max(_31,_27);_23.top=Math.min(_32,_28);_23.left=Math.min(_30,_26);_23.height=_39-_23.top;_23.width=_40-_23.left;_20.removeAt(k);k--;_24=true}}}while(_24);for(var k=0;k<_23.contained.length;k++){_23.contained[k].left-=_23.left;_23.contained[k].top-=_23.top;var _41=_23.contained[k].specialProperties;if(_41&&_41.markup){_23.markupContained.add(_23.contained[k]);_23.contained.removeAt(k);k--}}
_23.absX=_23.left;_23.absY=_23.top;_2.add(_23);_15.add(_23)}}
_15.addListAt(_5,0);return _15});isc.evalBoundary;isc.B.push(isc.A.getAllChildItems=function isc_MockupImporter_getAllChildItems(_1,_2){if(_1.contained==null){return[]}
var _3=[];_3.addList(_1.contained);if(_2!=true){if(_1.markupContained){_3.addList(_1.markupContained)}
if(_1.headerContained){for(var i=0;i<_1.headerContained.length;i++){_3.add(_1.headerContained[i].control)}}}
for(var i=0;i<_1.contained.length;i++){if(_1.contained[i].contained&&_1.contained[i].contained.length>0){_3.addList(this.getAllChildItems(_1.contained[i]))}}
return _3},isc.A.findBestContainer=function isc_MockupImporter_findBestContainer(_1,_2){var _3=this.$98p;var _4=_2.absX+(_2.width==null?0:_2.width);var _5=_2.absY+(_2.height==null?0:_2.height);var _6=[];for(var i=0;i<_1.length;i++){var _8=_1[i];if(_8==_2){continue}
var _9=_8.specialProperties;if(_9&&_9.markup){continue}
var _10=_8.absX-2;var _11=_8.absX+_8.width+2;var _12=_8.absY-2;var _13=_8.absY+_8.height+2;if(_10<=_2.absX&&_12<=_2.absY&&_2.zIndex>=_8.zIndex)
{var _14;if(_2.specialProperties){var _15=_2.specialProperties.controlName;_14=_3.widgetPropertyTranslations[_15]}
if(_14!=null&&_14.sloppyEdgeControl){if((_11+this.sloppyEdgeControlOverflow)>=_4&&(_13+this.sloppyEdgeControlOverflow)>=_5)
{_6.add(_8)}}else{if(_11>=_4&&_13>=_5){_6.add(_8)}}}}
if(_6.length>0){var _8=_6[0];for(var i=1;i<_6.length;i++){if(_8.width>_6[i].width||_8.height>_6[i].height){_8=_6[i]}}
return _8}else{return null}},isc.A.processStackHeuristic=function isc_MockupImporter_processStackHeuristic(_1,_2){var _3=this.$98p;for(var i=0;i<_2.length;i++){var _5=_2[i];var _6=_5._constructor=="HStack"||_5._constructor=="HLayout";for(var _7=0;_7<_5.contained.length;_7++){var _8=_5.contained[_7];if(_8._constructor=="Scrollbar"){var _9=_8.specialProperties.controlName;var _10=_5.specialProperties.controlName;var _11=_3.widgetPropertyTranslations[_10];var _12=false;if(_9=="com.balsamiq.mockups::VerticalScrollBar"){var _13=_8.left+_8.width;var _14=_5.width-_11.getRightMargin(_5);_12=Math.abs(_14-_13)<10}else{var _15=_8.top+_8.height;var _16=_5.height-_11.getBottomMargin(_5);_12=Math.abs(_16-_15)<10}
if(_12){_5.overflow="auto";_1.remove(_8);_5.contained.removeAt(_7);_7--}}}
_5.contained.sort(function(_35,_36){if(_35.top==_36.top){return _35.left-_36.left}
return _35.top-_36.top});this.handleElementsOverlap(_5.contained);this.addLabelsToFormItems(_1,_5);var _17=this.splitElementsByContainers(_5.contained,"top","height");var _18=this.splitElementsByContainers(_5.contained,"left","width");var _19;if(_18.size()>1&&_18.size()<5&&(_17.size()<2||_18.size()<_17.size())&&_5._constructor!="HStack"&&_5._constructor!="HLayout")
{_19=this.processStacksRecursively(_5,"root_horizontal");var _20={_constructor:"HStack",ID:_5.ID+"$16ai",contained:_5.contained,specialProperties:{controlName:"Stack",containerName:"HStack",fullWidth:true,fullHeight:true}};var _21=1000000;var _22=0;for(var j=0;j<_20.contained.length;j++){if(_20.contained[j].zIndex){_21=Math.max(_21,_20.contained[j].zIndex)}
if(_20.contained[j].height){_22=Math.max(_22,_20.contained[j].height)}};_20.zIndex=_21;_20.height=_22;_5.contained=[_20];_19.add(_20)}else{_19=this.processStacksRecursively(_5,"root_vertical")}
_2.addListAt(_19,i);var _24=_1.indexOf(_5);_1.addListAt(_19,_24);i+=_19.length}
for(var i=0;i<_2.length;i++){var _5=_2[i];var _6=_5._constructor=="HStack"||_5._constructor=="HLayout";var _25=0;for(var j=1;j<_5.contained.length;j++){var _26=_5.contained[j];var _27=_5.contained[j-1];var _28=_5.contained[j+1];var _29=_26.specialProperties;var _9=_29&&_29.controlName;if(_9=="com.balsamiq.mockups::HSplitter"||_9=="com.balsamiq.mockups::HRule"||_9=="com.balsamiq.mockups::VSplitter"||_9=="com.balsamiq.mockups::VRule")
{_27.showResizeBar=true;_5.overflow="auto";_1.remove(_5.contained[j]);_5.contained.removeAt(j);j--;continue}
if((_6&&_9=="com.balsamiq.mockups::VerticalScrollBar")||(!_6&&_9=="com.balsamiq.mockups::HorizontalScrollBar"))
{_5.overflow="auto";if(_6){_27.width+=_26.width}else{_27.height+=_26.height}
_1.remove(_26);_5.contained.removeAt(j);j--;continue}
var _30;if(_6){_30=_26.left-_27.left-_27.width}else{_30=_26.top-_27.top-_27.height}
if(_25==0){_25=_30}else if(Math.abs(_25-_30)>5){_25=0;break}}
var _10=_5.specialProperties.controlName;var _31=_3.widgetPropertyTranslations[_10];if(_31.canUseMargin==null||_31.canUseMargin)
{if(_25>0){for(var j=0;j<_5.contained.length-1;j++){if(_5.contained[j].showResizeBar!=true){_5.membersMargin=_25;break}}}}else{_25=0}
for(var j=1;j<_5.contained.length;j++){var _26=_5.contained[j];var _27=_5.contained[j-1];var _32=0;if(_6){if(_26.absX!=null&&_27.absX!=null){_32=_26.absX-_25-
(_27.absX+_27.width)}else{_32=_26.left-_25-
(_27.left+_27.width)}}else{if(_26.absY!=null&&_27.absY!=null){_32=_26.absY-_25-
(_27.absY+_27.height)}else{_32=_26.top-_25-
(_27.top+_27.height)}}
if(_27.showResizeBar){var _33=Math.round((_32+_25-4)/2);if(_6){_27.width+=_33;_26.width+=_33;_26.left-=_33;if(_26.contained){for(var k=0;k<_26.contained.length;k++){_26.contained[k].specialProperties.left=_26.contained[k].left;_26.contained[k].left+=_33}}}else{_27.height+=_33;_26.height+=_33;_26.top-=_33;if(_26.contained){for(var k=0;k<_26.contained.length;k++){_26.contained[k].specialProperties.top=_26.contained[k].top;_26.contained[k].top+=_33}}}}else if(_32>0){_27.extraSpace=_32}}}
return _1},isc.A.addLabelsToFormItems=function isc_MockupImporter_addLabelsToFormItems(_1,_2){for(var i=0;i<_2.contained.length;i++){var _4=_2.contained[i];if(_4._constructor!="Label")continue;if(_4.specialProperties.controlName=="com.balsamiq.mockups::Icon")continue;for(var j=0;j<_2.contained.length;j++){var _6=_2.contained[j],_7=_6.items||_6.fields;if(_6._constructor!="DynamicForm"||_7==null){continue}
var _8=(_6.top>_4.top)&&(_6.top-(_4.top+_4.height)<this.labelMaxOffset)&&((Math.abs(_6.left-_4.left)<this.labelMaxOffset)||(_4.left<=_6.left&&(_4.left+_4.width)>=(_6.left+_6.width)));var _9=(_6.left>_4.left)&&(_6.left-(_4.left+_4.width)<2*this.labelMaxOffset)&&(_4.top+this.labelMaxOffset>_6.top)&&(_4.top+_4.height-this.labelMaxOffset<
_6.top+_6.height);if(_8||_9){if(_7[0].title){if(_8){var _10=false;for(var l=0;l<_2.contained.length;l++){var _12=_2.contained[l];if(i!=l&&_12._constructor=="Label"){var _13=(_4.top>_12.top&&(_4.top-(_12.top+_12.height))<
this.labelMaxOffset)&&(Math.abs(_4.left-_12.left)<
this.labelMaxOffset);if(_13){_10=true;break}}}
if(_10){continue}}}else{if(_4.contents==null)continue;_7[0].showTitle=true;_4.contents=String(_4.contents);if(_4.contents.endsWith(":")){_4.contents=_4.contents.substring(0,_4.contents.length-1)}
_7[0].title=_4.contents;if(_8){_6.numCols=1;_7[0].titleOrientation="top";var _14=17;_6.height+=_14;_6.top=Math.max(0,_6.top-_14);_6.absY-=_14}else{var _15=_6.width;_6.numCols=2;_6.width=_6.left+_6.width-_4.left;_6.left=_4.left;_6.absX=_4.absX;if(_6.height>_4.height*2){var _16=Math.abs(_4.top-_6.top);var _17=Math.abs(_6.top+_6.height/2-_4.top-_4.height/2);var _18=Math.abs(_6.height-_4.top-_4.height);if(_16<_17&&_16<_18){_7[0].titleVAlign="top"}else if(_18<_17&&_18<_16){_7[0].titleVAlign="bottom"}}
if(isc.isA.String(_7[0].width)){_6.titleWidth=_6.width-_15+1}else{_6.titleWidth=_6.width-_7[0].width+1}}
_2.contained.removeAt(i);_1.remove(_4);i--;break}}}}},isc.A.processStacksRecursively=function isc_MockupImporter_processStacksRecursively(_1,_2){_1.contained.sort(function(_17,_18){if(_17.top==_18.top){return _17.left-_18.left}
return _17.top-_18.top});var _3=_1.contained;if(_2=="vertical"||_2=="root_vertical"){var _4=this.splitElementsByContainers(_3,"top","height");if(_2=="vertical"&&_4.length==1){return[]}
_4.sort(function(_17,_18){return _17.top-_18.top});_1.contained=[];var _5=[];for(var i=0;i<_4.length;i++){var _7=_4[i];if(_7.children.length==1){_1.contained.add(_7.children[0])}else{var _8={_constructor:"HStack",ID:_1.ID+"$16ai"+i,contained:_7.children,top:_7.top,height:_7.height,absY:_7.children[0].absY,absX:_7.children[0].absX,specialProperties:{controlName:"Stack"}};var _9=1000000;var _10=1000000;var _11=0;for(var j=0;j<_7.children.length;j++){var _13=_7.children[j];_13.top-=_8.top;if(_13.top<0)_13.top=0;if(_13.zIndex){_9=Math.max(_9,_13.zIndex)}
_10=Math.min(_10,_13.left);_11=Math.max(_11,_13.left+_13.width)}
_8.zIndex=_9;_8.width=_11-_10;_8.left=_10;for(var j=0;j<_7.children.length;j++){_7.children[j].left-=_8.left}
var _14=this.processStacksRecursively(_8,"horizontal");_1.contained.add(_8);if(_14.length!=0){_5.addList(_14)}
_5.add(_8)}}
return _5}else{var _4=this.splitElementsByContainers(_3,"left","width");if(_2=="horizontal"&&_4.length==1){return[]}
_4.sort(function(_17,_18){return _17.left-_18.left});_1.contained=[];var _5=[];for(var i=0;i<_4.length;i++){var _7=_4[i];if(_7.children.length==1){_1.contained.add(_7.children[0])}else{var _8={_constructor:"VStack",ID:_1.ID+"$1587"+i,contained:_7.children,left:_7.left,width:_7.width,absX:_7.children[0].absX,absY:_7.children[0].absY,autoDraw:false,specialProperties:{controlName:"Stack"}};var _9=1000000;var _15=1000000;var _16=0;for(var j=0;j<_7.children.length;j++){var _13=_7.children[j];_13.left-=_8.left;if(_13.left<0){_13.left=0}
if(_13.zIndex){_9=Math.max(_9,_13.zIndex)}
_15=Math.min(_15,_13.top);_16=Math.max(_16,_13.top+_13.height)}
_8.zIndex=_9;_8.height=_16-_15;_8.top=_15;for(var j=0;j<_7.children.length;j++){_7.children[j].top-=_8.top}
var _14=this.processStacksRecursively(_8,"vertical");_1.contained.add(_8);if(_14.length!=0){_5.addList(_14)}
_5.add(_8)}}
return _5}},isc.A.splitElementsByContainers=function isc_MockupImporter_splitElementsByContainers(_1,_2,_3){var _4=[],_5=this.$98p;for(var i=0;i<_1.length;i++){var _7=_1[i],_8=_7[_3],_9=_7.specialProperties;if(_9){var _10=_9.controlName;var _11=_5.widgetPropertyTranslations[_10];if(_11&&_11.sloppyEdgeControl&&_11.estimateControlSize)
{_8=_11.estimateControlSize(_7)[_3];_7[_3]=_8}}
var _12=null;for(var j=0;j<_4.length;j++){var _14=_4[j];var _15=_8/4;var _16=_14[_3];_16/=4;var _17=Math.min(_15,_16);if((_7[_2]+_17>=_14[_2])&&(_7[_2]+_17<_14[_2]+_14[_3]))
{_12=_14;break}}
if(_12!=null){_12.children.add(_7);if(_7[_2]<_12[_2]||(_7[_2]+_8>
_12[_2]+_12[_3]))
{var _18=_12[_2]+_12[_3];var _19=_7[_2]+_7[_3];_12[_2]=Math.min(_7[_2],_12[_2]);_12[_3]=Math.max(_18,_19)-_12[_2];for(var j=0;j<_4.length;j++){var _14=_4[j];var _15=_8/4;var _16=_14[_3];_16/=4;var _17=Math.min(_15,_16);if(_14!=_12&&(_12[_2]+_17)<
(_14[_2]+_14[_3])&&(_12[_2]+_12[_3])>
(_14[_2]+_17))
{_12.children.addList(_14.children);if(_12[_2]>_14[_2]){_12[_2]=_14[_2]}
if(_12[_2]+_12[_3]<
_14[_2]+_14[_3])
{_12[_3]=_14[_2]+_14[_3]-_12[_2]}
_4.removeAt(j);j--}}}}else{var _20={children:[_7]};_20[_2]=_7[_2];_20[_3]=_8;_4.add(_20)}}
return _4},isc.A.handleElementsOverlap=function isc_MockupImporter_handleElementsOverlap(_1){for(var i=0;i<_1.length-1;i++){for(var j=i+1;j<_1.length;j++){var _4=_1[i];var _5=_1[j];var _6=_4.left+_4.width;var _7=_4.top+_4.height;var _8=_5.left+_5.width;var _9=_5.top+_5.height;if(_4.left<_8&&_6>_5.left&&_4.top<_9&&_7>_5.top)
{var _10=Math.abs(_7-_5.top);var _11=Math.abs(_6-_5.left);if(_10>0&&_10<this.maxControlOverlap){_4.height-=_10+1;if(_4._constructor=="DynamicForm"&&(_4.items||_4.fields)){var _12=_4.items||_4.fields;for(var k=0;k<_12.length;k++){_12[k].height=Math.min(_12[k].height,_4.height-2)}}}
if(_11>0&&_11<this.maxControlOverlap){_4.width-=_11+1;if(_4._constructor=="DynamicForm"&&(_4.items||_4.fields)){var _12=_4.items||_4.fields;for(var k=0;k<_12.length;k++){_12[k].width=Math.min(_12[k].width,_4.width-2)}}}}}}},isc.A.processFormsHeuristic=function isc_MockupImporter_processFormsHeuristic(_1,_2){var _3=this.$98p;var _4=[];for(var i=0;i<_2.length;i++){var _6=_2[i];if(this.isFormsOnlyContainer(_6)){_4.add(_6)}}
var _7=[];for(var i=0;i<_2.length;i++){var _6=_2[i];if(_4.contains(_6))continue;var _8=-1;var _9=-1;for(var j=0;j<_6.contained.length;j++){var _11=_6.contained[j];var _12=(j==(_6.contained.length-1));if((_11._constructor=="DynamicForm"&&(_11.items!=null||_11.fields!=null))||(_11._constructor!="DynamicForm"&&_4.contains(_11)&&this.$87q.contains(_11._constructor)))
{if(_8<0)_8=j;_9=j}else{_12=true}
if(_12&&_8>=0){if(_8!=_9){_7.add({container:_6,startInd:_8,endInd:_9});for(var k=_8;k<=_9;k++){_4.remove(_6.contained[k]);var _14=this.getAllChildItems(_6.contained[k],true);for(var _15=0;_15<_14.length;_15++){if(_14[_15].contained)_4.remove(_14[_15])}}}
_8=-1;_9=-1}}}
for(var i=0;i<_4.length;i++){for(var j=0;j<_4.length;j++){if(_4[j].contained.contains(_4[i])){_4.removeAt(i);i--;break}}}
var _16=1;for(var i=0;i<_4.length;i++){var _17=_4[i];var _18=this.getAllChildItems(_17,true)
if(_18.length<=1)continue;var _19=this.combineItemsIntoAForm(_18);var _20=_17.specialProperties.controlName;var _21=_3.widgetPropertyTranslations[_20];_19.left=Math.max(0,_19.absX-_17.absX-
_21.getLeftMargin(_17));_19.top=Math.max(0,_19.absY-_17.absY-
_21.getTopMargin(_17));_19.specialProperties={};_19.specialProperties.calculatedHeight=_19.calculatedHeight;delete _19.calculatedHeight;_19.ID="form"+_16++;_17.contained=[_19];delete _19.additionalExtraSpace;if(isc.isA.Number(_17.height)&&isc.isA.Number(_19.height)){_17.height=Math.max(_17.height,_19.height)}
_1.addAt(_19,_1.indexOf(_17));for(var j=0;j<_18.length;j++){_1.remove(_18[j]);_2.remove(_18[j])}}
for(var i=0;i<_7.length;i++){var _22=_7[i];var _23=_22.container;var _18=[];for(var j=_22.startInd;j<=_22.endInd;j++){var _24=_23.contained[j];if(_24.contained){_18.addList(this.getAllChildItems(_24,true))}else{_18.add(_24)}}
if(_18.length<=1)continue;var _19=this.combineItemsIntoAForm(_18);_19.left=_23.contained[_22.startInd].left;_19.top=_23.contained[_22.startInd].top;_19.specialProperties={};_19.specialProperties.calculatedHeight=_19.calculatedHeight;delete _19.calculatedHeight;_19.ID="form"+_16++;var _25=_23.contained[_22.endInd]
if(_25.extraSpace){_19.extraSpace=_25.extraSpace}
for(var j=_22.endInd;j>=_22.startInd;j--){_1.remove(_23.contained[j]);_2.remove(_23.contained[j]);_23.contained.removeAt(j)};_23.contained.addAt(_19,_22.startInd);_1.addAt(_19,_1.indexOf(_23));for(var j=0;j<_18.length;j++){_1.remove(_18[j]);_2.remove(_18[j])}}
for(var i=0;i<_1.length;i++){var _11=_1[i],_26=_11.items||_11.fields;if(_11._constructor=="DynamicForm"&&_26&&_26.length==1&&_26[0]._constructor=="ButtonItem")
{var _27=_11.extraSpace;var _28=_26[0];if(_11.extraSpace)_28.extraSpace=_11.extraSpace;_28.left=_11.left;_28.top=_11.top;_28._constructor="Button";delete _28.startRow;delete _28.endRow;for(var _29 in _11){if(_29!="ID"&&_29!="specialProperties"){delete _11[_29]}}
for(var _29 in _28){_11[_29]=_28[_29]}}else if(_11._constructor=="DynamicForm"&&_26){var _19=_11;var _30=_26;var _31=_19.numCols||2;var _32=0;var _33=[];for(var j=0;j<_30.length;j++){var _11=_30[j];var _34=null;var _35=_11.colSpan||(_11.showTitle?2:1);var _36=[_11];var _37=[_11.title];var _38=[];var _39=null;if(_11.value==true){_39=_11.title}
var _40=_31>_35&&_11.endRow!=true;if(_11.rowSpan!=null){for(var s=0;s<(_32+_35-1);s++){_33[s]=_11.rowSpan}}else{for(var s=_32-1;s<(_32+_35-1);s++){if(_33[s]==null)break;_32++;if(--_33[s]==0){_33[s]=null}}}
_32+=_35;if(_11._constructor=="RadioItem"){for(var k=j+1;k<_30.length;k++){_34=_30[k];if(_34._constructor!="RadioItem")break;if(_34.value==true){if(_39!=null)break;_39=_34.title}
_36.add(_34);_37.add(_34.title);if(_34.disabled){_38.add(_34.title)}
var _42=_34.colSpan||(_34.showTitle?2:1);_32+=_42;if(_34.endRow||_32==_31){if(_40)break;_32=0}}}
if(_36.length>1){_30.removeList(_36);var _43={_constructor:"RadioGroupItem",type:"radioGroup",showTitle:false,valueMap:_37,value:_11.title};if(_36[0].cellHeight){_43.cellHeight=_36[0].cellHeight}
if(_38.length>0){_43.disabledValues=_38}
if(_40){_43.vertical=false;_43.colSpan=_32;if(_34.endRow){_43.endRow=true}}
_30.addAt(_43,j);if(j>0&&_30[j-1]._constructor=="StaticTextItem"&&!_30[j-1].endRow){_30[j].showTitle=true;_30[j].title=_30[j-1].value;_30.remove(_30[j-1])}}
if(_11.endRow||_32==_31||(_34&&_34.endRow)){_32=0}}
var _25=_30[_30.length-1];var _27=0;if(_19.extraSpace){_27=_19.extraSpace}
if(_25.extraSpace){_27+=_25.extraSpace}
if(_19.additionalExtraSpace){_27+=_19.additionalExtraSpace;_19.height-=_19.additionalExtraSpace;delete _19.additionalExtraSpace}
if(_27>0){_19.extraSpace=_27}}}
return _1},isc.A.isFormsOnlyContainer=function isc_MockupImporter_isFormsOnlyContainer(_1){var _2=this.getAllChildItems(_1,true)
if(_2.length==0)return false;var _3=true;for(var j=0;j<_2.length;j++){var _5=_2[j]._constructor=="DynamicForm";var _6=_2[j]._constructor=="Label"&&_2[j].icon==null;var _7=this.$87q.contains(_2[j]._constructor);if(!_5&&!_6&&!_7)return false;if(_5&&_2[j].items==null&&_2[j].fields==null)return false;_3=_3&&(_6||_7)}
return!_3},isc.A.combineItemsIntoAForm=function isc_MockupImporter_combineItemsIntoAForm(_1){var _2=[];for(var i=0;i<_1.length;i++){if(_1[i]._constructor=="Label"){var _4=_1[i];_4._constructor="DynamicForm";_4.items=[{_constructor:"StaticTextItem",showTitle:false,width:_4.width,value:_4.contents}]}}
for(var j=0;j<_1.length;j++){if(_1[j]._constructor!="DynamicForm"||(_1[j].items==null&&_1[j].fields==null))continue;var x=_1[j].absX;var y=_1[j].absY;var _8=_1[j].orientation=="horizontal";var _9=_1[j].items||_1[j].fields;for(var k=0;k<_9.length;k++){var _11=_9[k];_11.$86q={x:x,y:y,width:_11.width?_11.width:_1[j].width,height:_11.height?_11.height:this.formsGridCellHeight};if(_11.title&&!this.$87t.contains(_11._constructor)){if(_11.titleOrientation=="top"){_11.$86q.height+=17}else if(_1[j].titleWidth){_11.$86q.x+=_1[j].titleWidth;_11.titleWidth=_1[j].titleWidth}}
if(_8){x+=_11.$86q.width}else{y+=_11.$86q.height}
_2.add(_11)}}
var _12={_constructor:"DynamicForm",items:[]}
var _13=10000;var _14=10000;for(var j=0;j<_2.length;j++){_13=Math.min(_13,_2[j].$86q.x);_14=Math.min(_14,_2[j].$86q.y)}
_12.absX=_13;_12.absY=_14;var _15=0;var _16=0;var _17=[];var _18=[];for(var j=0;j<_2.length;j++){_2[j].$86q.x-=_13;_2[j].$86q.y-=_14;_15=Math.max(_15,_2[j].$86q.x+_2[j].$86q.width);_16=Math.max(_16,_2[j].$86q.y+_2[j].$86q.height);if(!_17.contains(_2[j].$86q.x)){_17.add(_2[j].$86q.x)}
if(!_18.contains(_2[j].$86q.y)){_18.add(_2[j].$86q.y)}}
_17.sort(function(_71,_72){return _71-_72});_18.sort(function(_71,_72){return _71-_72});for(var i=0;i<_17.length-1;i++){if(_17[i+1]-_17[i]<this.formsGridCellWidth){for(var j=0;j<_2.length;j++){if(_2[j].$86q.x==_17[i+1]){_2[j].$86q.width+=(_17[i+1]-_17[i]);_2[j].$86q.x=_17[i]}}
_17.removeAt(i+1);i--}}
for(var i=0;i<_18.length-1;i++){if(_18[i+1]-_18[i]<this.formsGridCellHeight*2/3){for(var j=0;j<_2.length;j++){if(_2[j].$86q.y==_18[i+1]){_2[j].$86q.height+=(_18[i+1]-_18[i]);_2[j].$86q.y=_18[i]}}
_18.removeAt(i+1);i--}}
var _19=[];for(var _20=0;_20<_18.length;_20++){var _21=[];_19.add(_21);for(var _22=0;_22<_17.length;_22++){_21.add(null)}}
for(var j=0;j<_2.length;j++){var _11=_2[j];var _23=0;var _24=0;for(var _20=0;_20<_18.length;_20++){if(_11.$86q.y>=_18[_20]){_23=_20;_24=_20}
if((_11.$86q.y+_11.$86q.height)<=_18[_20]){break}
_24=_20}
var _25=0;var _26=0;for(var _22=0;_22<_17.length;_22++){if(_11.$86q.x>=_17[_22]){_25=_22;_26=_22}
if((_11.$86q.x+_11.$86q.width)<=_17[_22]){break}
_26=_22}
if(_26-_25>=1){_11.colSpan=_26-_25+1}
if(_24-_23>=1){_11.rowSpan=_24-_23+1}
delete _11.$86q;for(var _22=_25;_22<=_26;_22++){for(var _20=_23;_20<=_24;_20++){var _27=_19[_20][_22];if(_27){if(_22>0&&_27==_19[_20][_22-1]){var _28=function(_33){if(_29>1&&_33<(_32+_29)){_27.titleColSpan--;if(_27.titleColSpan==1)delete _27.titleColSpan;_29--}else if(_27.colSpan){_27.colSpan--;if(_27.colSpan==1)delete _27.colSpan;_30--}
_19[_20][_33]=null}
var _29=(_27.titleColSpan?_27.titleColSpan:(_27.showTitle?1:0));var _30=(_27.colSpan?_27.colSpan:1);var _31=_29+_30;var _32=0;for(var _33=_25;_33<=_26;_33++){if(_27==_19[_20][_33]){_32=_33;break}}
_28(_22);if(_22<_19[_20].length&&_27==_19[_20][_22+1]){_28(_22-1)}}else if(_20>0&&_27==_19[_20-1][_22]){_27.rowSpan--;for(var i=_22+1;i<_19[_20].length;i++){if(_19[_20][i]==_27){_19[_20][i]=null}}
if(_27.rowSpan==1)delete _27.rowSpan}}
_19[_20][_22]=_11;if(_11.titleWidth!=null){var _34=_22-1;var _35=0;while(_34>=0&&_19[_20][_34]==null){_19[_20][_34]=_11;_35++;_34--}
if(_35>1)_11.titleColSpan=_35;if(_35>0)delete _11.titleWidth}}}}
for(var _36=0;_36<_19.length;_36++){for(var _33=0;_33<_19[_36].length-1;_33++){if(_19[_36][_33]&&_19[_36][_33+1]&&_19[_36][_33]._constructor=="StaticTextItem"&&_19[_36][_33+1]._constructor!="StaticTextItem"&&_19[_36][_33+1]._constructor!="SpacerItem"&&!this.$87t.contains(_19[_36][_33+1]._constructor)&&_19[_36][_33+1].showTitle==false)
{if(_19[_36][_33+1].rowSpan){var c=false;for(var _20=0;_20<_19.length;_20++){if(_19[_20][_33+1]==_19[_36][_33+1]){if(_19[_20][_33]!=_19[_36][_33]&&_19[_20][_33]!=null){c=true;break}
if(_19[_20][_33]==null){_19[_20][_33]=_19[_36][_33+1]}}}
if(c){continue}}
var _38=_19[_36][_33];_19[_36][_33+1].title=_19[_36][_33].value;_19[_36][_33+1].width+=_19[_36][_33].width;_19[_36][_33+1].showTitle=true;_19[_36][_33]=_19[_36][_33+1];var _39=_33-1;if(_39>=0&&_19[_36][_39]==_38){while(_39>=0&&_19[_36][_39]==_38){_19[_36][_39]=_19[_36][_33+1];if(_19[_36][_33+1].titleColSpan){_19[_36][_33+1].titleColSpan++}else{_19[_36][_33+1].titleColSpan=1}
_39--}}else{_19[_36][_33+1].width-=_38.width}}}}
for(var _20=0;_20<_18.length;_20++){for(var _22=0;_22<_17.length;_22++){var _40=_19[_20][_22];if(_40==null){if(_22>0&&_19[_20][_22-1]._constructor=="SpacerItem"){_19[_20][_22]=_19[_20][_22-1];if(_19[_20][_22].colSpan==null){_19[_20][_22].colSpan=2}else{_19[_20][_22].colSpan++}}else{_19[_20][_22]={_constructor:"SpacerItem"};_12.items.add(_19[_20][_22])}}else if(!_12.items.contains(_40)){_12.items.add(_40)}
_40=_19[_20][_22];if(_40.rowSpan==null&&_20<(_18.length-1)){var _41=isc.ListGrid.getInstanceProperty("cellPadding");_40.cellHeight=_18[_20+1]-_18[_20]-
(2*_41);var _42=isc.TextItem.getInstanceProperty("height");_42+=2*_41;if(Math.abs(_42-_40.cellHeight)<=this.formExtraSpaceThreshold){delete _40.cellHeight}
if(_40.cellHeight>=3*_42){_40.vAlign="top";_40.titleVAlign="top"}
if(_40._constructor=="ButtonItem"){delete _40.cellHeight}}}
for(var i=_12.items.length-1;i>=0;i--){if(_12.items[i]._constructor=="SpacerItem"){_12.items.removeAt(i);if(_20!=(_18.length-1)){_12.items[_12.items.length-1].endRow=true}}else{break}}}
var _43=[],_44=0;for(var _20=0;_20<_18.length;_20++){_43[_44]=[];var _41=isc.ListGrid.getInstanceProperty("cellPadding"),_45=null;for(var _22=0;_22<_17.length;_22++){var _40=_19[_20][_22];if(_40._constructor!="SpacerItem"){var _46=_40.height,_47=_40.cellHeight;if(_40.showTitle&&_40.titleOrientation=="top"){_46+=17}
if(_47-_46-(2*_41)>0){_45=_47-_46-(2*_41)}}
_43[_44][_22]=_40}
var _48=null;if(_45!=null){for(var _22=0;_22<_17.length;_22++){var _40=_43[_44][_22];if(_40&&_40._constructor!="SpacerItem"){if(_40.cellHeight>_45){delete _40.cellHeight}
_48=_40}}}
_44++;if(_45!=null){var _49={_constructor:"RowSpacerItem",height:_45};_43[_44]=[];var _50=_43[_44-1],_51=false;for(var _52=0;_52<_50.length;_52++){if(_50[_52].rowSpan>0){_43[_44][_52]=_50[_52];if(_52==0||_50[_52-1]!=_50[_52]){_50[_52].rowSpan=_50[_52].rowSpan+1}}else if(!_51){_43[_44][_52]=_49;_51=true}else{_43[_44][_52]={_constructor:"SpacerItem"}}}
var _53=_12.items.indexOf(_48);_12.items.addAt(_49,_53+1);_44++}}
_19=_43;var _54=0;var _55=false;var _41=isc.ListGrid.getInstanceProperty("cellPadding");var _42=isc.TextItem.getInstanceProperty("height");for(var i=0;i<_19.length;i++){var _11=_19[i][0];if(_11==null)continue;if(i>0&&_11==_19[i-1][0])continue;var _56=0;var _47;if(_11._constructor=="TextAreaItem"){_55=true;_56=_11.height}else if(_11._constructor=="SpacerItem"){for(var j=0;j<_19[i].length;j++){if(_19[i][j]._constructor!="SpacerItem"){_11=_19[i][j];if(_11._constructor=="TextAreaItem"){_55=true;_56=_11.height}else{if(isc[_11._constructor])_56=isc[_11._constructor].getInstanceProperty("height");_47=_11.cellHeight}
break}}}else{if(isc[_11._constructor])_56=isc[_11._constructor].getInstanceProperty("height");_47=_11.cellHeight}
if(_56==null||_56==0)_56=_42;_54+=(2*_41)+(_47!=null?Math.max(_56,_47):_56);if(_11.showTitle&&_11.titleOrientation=="top"){_54+=17}}
if(_55){_12.calculatedHeight=_54}
if(_19.length>0)_16+=_41;var _57=[];for(var _22=0;_22<_17.length;_22++){var _58=0;for(var _20=0;_20<_19.length;_20++){if(_19[_20][_22].titleWidth!=null){if(_22==0){_58=Math.max(_58,_19[_20][_22].titleWidth)}else{var _59=_17[_22]-_17[_22-1]-
_19[_20][_22-1].width;if(_58==0){_58=_59}else{_58=Math.min(_58,_59)}}}}
if(_58>0){if(_22!=0){_57[_57.length-1]-=_58}else{_12.absX-=_58}
for(var _20=0;_20<_19.length;_20++){if(_19[_20][_22].titleWidth==null){if(_19[_20][_22]._constructor=="ButtonItem"){var _33=_12.items.indexOf(_19[_20][_22]);var _60=_12.items[_33-1];if(_22>0&&_60._constructor=="SpacerItem"){if(_60.colSpan==null){_60.colSpan=2}else{_60.colSpan++}}else{_12.items.addAt({_constructor:"SpacerItem"},_33)}}else{if(_19[_20][_22].colSpan==null){_19[_20][_22].colSpan=2}else{_19[_20][_22].colSpan++}}}}
_57.add(_58)}
if(_22==_17.length-1){_57.add(_15-_17[_22])}else{_57.add(_17[_22+1]-_17[_22])}}
for(var i=0;i<_2.length;i++){delete _2[i].titleWidth}
var _61="";_12.width=0;for(var j=0;j<_57.length;j++){if(j!=_57.length-1){_61+=_57[j];_61+=","}else{_61+="*"}
_12.width+=_57[j]}
for(var j=0;j<_19.length;j++){for(var k=0;k<_19[j].length;k++){var _11=_19[j][k];if(_11._constructor=="ButtomItem"){continue}
if(_11.width==null||_11.width=="*")continue;var _62=_57[k];var _63=_11.colSpan||_11.titleColSpan;if(_63){for(var _64=1;_64<_63;_64++){_62+=_57[j+_64]}
k+=_63}
if(Math.abs(_62-_11.width)<2){_11.width="*"}}}
for(var i=0;i<_12.items.length;i++){var _11=_12.items[i];if(_11._constructor=="TextAreaItem"){if(_11.rowSpan>1&&_11.rowSpan!=_19.length){_11.height="*"}
if((_11.colSpan||1)!=_19[0].length){_11.width="*"}}}
_12.colWidths=_61;_12.numCols=_57.length;_12.height=_16;var _65=[];for(var i=0;i<_2.length;i++){var _11=_2[i];var _66=_11.title||_11.defaultValue||_11._constructor;_65.add(_66)}
for(var i=0;i<_2.length;i++){var _11=_2[i];if(_11._constructor=="SpacerItem")continue;var _66=_11.title||_11.defaultValue||_11._constructor;var _67=isc.MockDataSource.convertTitleToName(_66,this.fieldNamingConvention,_65);var _68=_67;var _69=0;do{var _70=false;for(var j=0;j<_9.length;j++){if(_9[j].name==_68){_69++;_68=_67+_69;_70=true;break}}}while(_70);_11.name=_68}
return _12});isc.evalBoundary;isc.B.push(isc.A.removeExtraContainers=function isc_MockupImporter_removeExtraContainers(_1,_2){var _3;do{_3=false;for(var i=0;i<_2.length;i++){var _5=_2[i];if(_5.contained.length==1&&(this.$87q.contains(_5._constructor)||"Canvas"==_5._constructor&&_5.contained[0]._constructor=="DynamicForm")&&!(_5.overflow&&_5.contained[0]._constructor!="ListGrid"))
{var _6=_5.contained[0];if((_5.width-_6.width)>(this.stackContainerFillInset*2)||(_5.height-_6.height)>(this.stackContainerFillInset*2))
{continue}
for(var j=0;j<_2.length;j++){var _8=_2[j].contained.indexOf(_5);if(_8>=0){var _9=_2[j].contained[_8];var _10=_6.left;var _11=_6.top;var _12=_5.height-_11-_6.height;var _13=_5.width-_10-_6.width;if(!_6.specialProperties)_6.specialProperties={};var _14=_6.specialProperties;_14.lm=(_14.lm||0)+_10;_14.tm=(_14.tm||0)+_11;_14.bm=(_14.bm||0)+_12;_14.rm=(_14.rm||0)+_13;var _15=_6._constructor=="HStack"||_6._constructor=="HLayout";var _16=_9._constructor=="HStack"||_9._constructor=="HLayout";var _17=_5._constructor=="HStack"||_5._constructor=="HLayout";if(_15&&_16&&!_17||(!_15&&!_16))
{_6.extraSpace=(_6.extraSpace||0)+(_2[j].contained[_8].extraSpace||0)}else{_6.extraSpace=_2[j].contained[_8].extraSpace||0}
if(_6.extraSpace==0){delete _6.extraSpace}
var _18=["border","width","height","top","left","isGroup","groupTitle","markupContained"];var _19=["measuredW","measuredH","overrideWidth","top","left"];for(var _20=0;_20<_18.length;_20++){if(_5[_18[_20]]){_6[_18[_20]]=_5[_18[_20]]}}
if(_5.specialProperties&&_5.contained[0].specialProperties){if((_5.specialProperties.controlName=="com.balsamiq.mockups::Canvas"||_5.specialProperties.controlName=="com.balsamiq.mockups::FieldSet")&&_6._constructor=="DynamicForm")
{_19.add("controlName")}
for(var _20=0;_20<_19.length;_20++){_6.specialProperties[_19[_20]]=_5.specialProperties[_19[_20]]}}
if(_5.showResizeBar){_5.contained[0].showResizeBar=_5.showResizeBar}
_2[j].contained[_8]=_5.contained[0];_1.remove(_5);if(_6.markupContained&&_5.contained[0].markupContained.length>0){_6.contained=[];_2.set(i,_5.contained[0])}else{_2.removeAt(i);i--}
_3=true
break}}
var _21=_5.specialProperties,_22=_21&&_21.controlName;if(!_3&&_22!="com.balsamiq.mockups::BrowserWindow"){if(_5.top)_6.top=(_6.top||0)+_5.top;if(_5.left)_6.left=(_6.left||0)+_5.left;if(_5.width)_6.width=_5.width;if(_5.height)_6.height=_5.height;if(_5.border)_6.border=_5.border;if(_5.zIndex)_6.zIndex=_5.zIndex;if(_5.isGroup)_6.isGroup=_5.isGroup;if(_5.groupTitle)_6.groupTitle=_5.groupTitle;if(_5.markupContained){_6.markupContained=_5.markupContained}
if(_21){if(!_6.specialProperties)_6.specialProperties={};_6.specialProperties.fullHeight=_21.fullHeight;_6.specialProperties.fullWidth=_21.fullWidth}
delete _6.extraSpace;delete _6.autoDraw;_1.remove(_5);if(_6.markupContained&&_6.markupContained.length>0){_6.contained=[];_2.set(i,_6)}else{_2.removeAt(i);i--}
_3=true}}}}while(_3);return _1},isc.A.processValuesManagers=function isc_MockupImporter_processValuesManagers(_1,_2){for(var i=0;i<_2.length;i++){if(_2[i].specialProperties!=null&&_2[i].specialProperties.controlName!=null&&_2[i].specialProperties.controlName.startsWith("com.balsamiq.mockups::")&&_2[i]._constructor!="DynamicForm")
{var _4=this.findDynamicFormsRecursively(_2[i]);if(_4.length>1){var _5={_constructor:"ValuesManager",ID:"ValuesManager"+i};this.globalIDs.push(_5.ID);for(var j=0;j<_4.length;j++){_4[j].valuesManager=_5.ID;if(_4[j].specialProperties.additionalElements==null){_4[j].specialProperties.additionalElements=[]}
_4[j].specialProperties.additionalElements.add(_5)}
_1.addAt(_5,0)}
var _7=[];for(var j=0;j<_4.length;j++){_7.addList(_4[j].items)}
var _8=[];for(var j=0;j<_7.length;j++){var _9=_7[j];var _10=_9.title||_9.defaultValue||_9._constructor;_8.add(_10)}
for(var j=0;j<_7.length;j++){var _9=_7[j];if(_9._constructor=="SpacerItem")continue;var _10=_9.title||_9.defaultValue||_9._constructor;var _11=isc.MockDataSource.convertTitleToName(_10,this.fieldNamingConvention,_8);var _12=_11;var _13=0;do{var _14=false;for(var k=0;k<_7.length;k++){if(_7[k].name==_12){_13++;_12=_11+_13;_14=true;break}}}while(_14);_9.name=_12;if(_9._constructor=="CheckboxItem"&&_9.showTitle==false&&_9.colSpan==2)
{delete _9.showTitle;delete _9.colSpan}}}}
return _1},isc.A.findDynamicFormsRecursively=function isc_MockupImporter_findDynamicFormsRecursively(_1){if(!_1||!_1.contained)return[];var _2=[];for(var i=0;i<_1.contained.length;i++){var _4=_1.contained[i];if(_4._constructor=="DynamicForm"&&(_4.items!=null||_4.fields!=null)){_2.add(_4)}
if(this.$87q.contains(_4._constructor)||(_4._constructor=="DynamicForm"&&_4.items==null&&_4.fields==null))
{_2.addAll(this.findDynamicFormsRecursively(_4))}}
return _2},isc.A.processAddingToContainersHeuristic=function isc_MockupImporter_processAddingToContainersHeuristic(_1,_2){var _3=this.$98p;this.cleanZIndexParam(_1,_2);for(var i=0;i<_2.length;i++){this.processRemoveWidths(_1,_2,_2[i]);var _5=_3.widgetPropertyTranslations[_2[i].specialProperties.controlName];var _6=null;if(_2[i].markupContained!=null&&_2[i].markupContained.length>0){_6={_constructor:"VStack",ID:"VStack"+i,position:"absolute",top:0,autoDraw:false,width:"100%",height:"100%",zIndex:_2[i].zIndex,members:[]};var _7={_constructor:"Canvas",height:"100%",width:"100%",autoDraw:false,children:[this.$88p(_6)]}
for(var j=0;j<_2[i].markupContained.length;j++){_2[i].markupContained[j].position="absolute";_7.children.add(this.$88p(_2[i].markupContained[j]))}
_5.addChild(_2[i],_7,_1);_1.addAt(_6,_1.indexOf(_2[i]))}
var _9=_2[i];this.processLayoutMargin(_1,_2,_9,_6);if(_9.contained.length==1&&(_9._constructor=="TabSet"||_9._constructor=="SectionStack")&&_9.verticalScrollBar!=null&&_9.contained[0]._constructor=="VStack")
{_9.contained[0]._constructor="VLayout";_9.contained[0].overflow="auto";delete _9.verticalScrollBar}
for(var j=0;j<_9.contained.length;j++){var _10=_9.contained[j];_10.autoDraw="false";if(_6!=null){_6.members.add(this.$88p(_10))}else{_5.addChild(_9,this.$88p(_10),_1)}
if(_10._constructor=="DynamicForm"&&(_10.items!=null||_10.fields!=null)){var _11=_10.items||_10.fields;for(var k=0;k<_11.length;k++){var _13=_11[k];delete _13.left;delete _13.top;if(!this.tallFormItems.contains(_13._constructor)&&!this.tallFormItems.contains(_13.type)&&"RowSpacerItem"!=_13._constructor&&("SelectItem"!=_13._constructor||_13.multipleAppearance!="grid"))
{delete _13.height}else if(_13._constructor=="ButtonItem"){if(Math.abs(_13.height-this.defaultButtonSize)<=this.buttonMinimumChangeSize){delete _13.height}}}}}
if(_9.headerContained!=null){_9.headerContained.sort(function(_18,_19){return _18.control.left-_19.control.left});for(var j=0;j<_9.headerContained.length;j++){if(j>0&&_9.headerContained[j].control.specialProperties.controlName=="com.balsamiq.mockups::VSplitter"||_9.headerContained[j].control.specialProperties.controlName=="com.balsamiq.mockups::VRule")
{_9.headerContained[j-1].control.showResizeBar=true;_9.overflow="auto";_1.remove(_9.headerContained[j].control);_9.headerContained.removeAt(j);j--;continue}
delete _9.headerContained[j].control.height;delete _9.headerContained[j].control.zIndex;delete _9.headerContained[j].control.top;delete _9.headerContained[j].control.left;_9.headerContained[j].control.autoDraw="false";if(_5.addControl){_5.addControl(_9,{controlAreaName:_9.headerContained[j].controlAreaName,control:this.$88p(_9.headerContained[j].control)})}else{isc.logWarn("no add control method for "+_2[i].specialProperties.controlName+" unable to add "+isc.echoAll(_9.headerContained[j].control))}}}
if(_9._constructor!="DynamicForm"&&_9._constructor!="Canvas"&&(_9.markupContained==null||_9.markupContained.length==0))
{for(var j=0;j<_9.contained.length;j++){var _10=_9.contained[j];if(_10._constructor=="Label"){var _14=_9._constructor=="HStack"||_9._constructor=="HLayout";if(_10.specialProperties.align&&_10.specialProperties.align=="center"){_10.align=_10.specialProperties.align}
if(!_14&&_10.left>this.stackContainerFillInset){_10.width+=_10.left;if(!_10.align)_10.align="right"}
if(_14&&_10.top>this.stackContainerFillInset){_10.height+=_10.top;_10.valign="bottom"}}
delete _10.left;delete _10.top}}
if(_9.fake){if(_9.layoutLeftMargin==null){_9.layoutLeftMargin=0}
if(_9.layoutTopMargin==null){_9.layoutTopMargin=0}
if(_9.contained.length==1&&_9.markupContained==0){_9.contained[0].left=_9.left+_9.layoutLeftMargin;_9.contained[0].top=_9.top+_9.layoutTopMargin;if(_9.contained[0].specialProperties){delete _9.contained[0].specialProperties.fullWidth;delete _9.contained[0].specialProperties.fullHeight}
delete _9.contained[0].autoDraw;_1.remove(_9)}else{_9.left=_9.left+_9.layoutLeftMargin;_9.top=_9.top+_9.layoutTopMargin;delete _9.layoutLeftMargin;delete _9.layoutTopMargin;delete _9.fake}}}
if(this.fillSpace){var _15=null;for(var i=0;i<_2.length;i++){var _16=true;for(var j=0;j<_2.length;j++){if(_2[j].contained.contains(_2[i])){_16=false;break}}
if(_16){for(var j=0;j<_1.length;j++){if(_2.contains(_1[j]))continue;var _17=_1[j].specialProperties;if(_17){if(_17.refs==null||_17.refs.length==0){_16=false}}}}
if(_16){if(_15!=null){_15=null;break}else{_15=_2[i]}}}
if(_15!=null&&((this.$87q.contains(_15._constructor)||"SectionStack"==_15._constructor||((_15._constructor=="Window"||_15._constructor=="Canvas")&&_15.contained.length==1&&this.$87q.contains(_15.contained[0]._constructor)&&((_15.contained[0].width==null||_15.contained[0].width=="100%")&&(_15.contained[0].height==null||_15.contained[0].height=="100%"))))||(_15._constructor=="TabSet")))
{_15.width="100%";_15.height="100%";delete _15.left;delete _15.top}}
for(var i=0;i<_2.length;i++){_2[i].specialProperties.innerItems=[];_2[i].specialProperties.innerItems.addList(_2[i].contained);_2[i].specialProperties.innerItems.addList(_2[i].headerContained);_2[i].specialProperties.innerItems.addList(_2[i].markupContained);delete _2[i].contained;delete _2[i].headerContained;delete _2[i].markupContained}
return _1},isc.A.$88p=function isc_MockupImporter__getRefCanvas(_1){var _2={_constructor:"Canvas",ref:_1.ID};if(_1.specialProperties==null){_1.specialProperties={}}
if(_1.specialProperties.refs==null){_1.specialProperties.refs=[]}
_1.specialProperties.refs.add(_2);return _2},isc.A.cleanZIndexParam=function isc_MockupImporter_cleanZIndexParam(_1,_2){var _3=this;var _4=function(_10,_9){var _11=_3.getAllChildItems(_10);for(var j=0;j<_11.length;j++){var _12=_11[j];var _13=_12.width;if(_13==null&&_12.specialProperties!=null){_13=_12.specialProperties.measuredWidth}
var _14=_12.height;if(_14==null&&_12.specialProperties!=null){_14=_12.specialProperties.measuredHeight}
if(_14!=null&&_13!=null&&_12.absX!=null&&_12.absY!=null&&_9.absX<(_12.absX+_13)&&(_9.absX+_9.width)>_12.absX&&_9.absY<(_12.absY+_14)&&(_9.absY+_9.height)>_12.absY)
{_9.doNotRemoveIndex=true}}
if(_9.doNotRemoveIndex){delete _9.doNotRemoveIndex}else{delete _9.zIndex}}
for(var i=0;i<_2.length;i++){var _6=true;for(var j=0;j<_2.length;j++){if(_2[j].contained!=null&&_2[j].contained.contains(_2[i]))
{_6=false;break}}
if(_6)delete _2[i].zIndex;if(_2[i].markupContained!=null){for(var k=0;k<_2[i].markupContained.length;k++){var _9=_2[i].markupContained[k];_4(_2[i],_9)}}
for(var j=0;j<_2[i].contained.length;j++){if(_2[i].children==null){delete _2[i].contained[j].zIndex}else{_4(_2[i],_2[i].contained[j])}}}},isc.A.processLayoutMargin=function isc_MockupImporter_processLayoutMargin(_1,_2,_3,_4){var _5=40;var _6=_5+1;var _7=_5+1;var _8=_5+1;var _9=_5+1;var _10=_3._constructor=="HStack"||_3._constructor=="HLayout";var _11=this.getControlHeightUsingItsParents(_2,_3);var _12=this.getControlWidthUsingItsParents(_2,_3);var _13=this.getParent(_1,_3);for(var j=0;j<_3.contained.length;j++){var c=_3.contained[j];if(_10){if(j==0&&c.left)_6=Math.min(_6,c.left);if(c.top!=null){_7=Math.min(_7,c.top);if(c.height&&_11){_9=Math.min(_9,_11-c.top-c.height-1)}}
if(j==(_3.contained.length-1)&&c.left&&_12&&c.width){_8=Math.min(_8,(_12-c.left-c.width-1))}}else{if(j==0&&c.top)_7=Math.min(_7,c.top);if(c.left!=null){_6=Math.min(_6,c.left);if(_12&&c.width){_8=Math.min(_8,(_12-c.left-c.width-1))}}
if(j==(_3.contained.length-1)&&c.top&&_11&&c.height){_9=Math.min(_9,(_11-c.top-c.height-1))}}}
for(var j=0;j<_3.contained.length;j++){var c=_3.contained[j];if(this.$87q.contains(c._constructor)||"DynamicForm"==c._constructor)
{var _16=0;var _17=0;var _18=0;if(_10){if(j==0&&c.left!=null){_16=c.left-_6}else if(j!=0&&_3.contained[j-1].showResizeBar&&_3.contained[j-1].extraSpace){_16=_3.contained[j-1].extraSpace-12;delete _3.contained[j-1].extraSpace}
if(c.top!=null){_17=c.top-_7}
if(j==(_3.contained.length-1)&&c.left!=null&&_12!=null&&c.width!=null){_18=_12-c.left-c.width-_8}}else{if(c.left!=null){_16=c.left-_6}
if(j==0&&c.top!=null){_17=c.top-_7}else if(j!=0&&_3.contained[j-1].showResizeBar&&_3.contained[j-1].extraSpace){_17=_3.contained[j-1].extraSpace-12;delete _3.contained[j-1].extraSpace}
if(c.left!=null&&_12!=null&&c.width!=null){_18=_12-c.left-c.width-_8}}
_16+=c.specialProperties.lm||0;_18+=c.specialProperties.rm||0;_17+=c.specialProperties.tm||0;if("DynamicForm"==c._constructor){var _19=Math.min(_16,Math.min(_18,_17));if(_19>0){c.padding=_19;_16-=_19;_17-=_19;_18-=_19}
var _20=_3._constructor=="HStack"||_3._constructor=="HLayout";if(!_20&&j>0&&_17>0){_3.contained[j-1].extraSpace=(_3.contained[j-1].extraSpace||0)+_17}else{var _21=isc.ListGrid.getInstanceProperty("cellPadding");_17-=_21;if(c.items&&_17>3){c.items.addAt({type:"SpacerItem",height:_17,colSpan:"*"},0)}}}else{if(_16>0&&c.layoutLeftMargin==null)c.layoutLeftMargin=_16;if(_17>0&&c.layoutTopMargin==null)c.layoutTopMargin=_17;if(_18>0&&c.layoutRightMargin==null)c.layoutRightMargin=_18}}}
if(_3._constructor=="SectionStack"&&((_6>0&&_6<=_5)||(_7>0&&_7<=_5)||(_8>0&&_8<=_5)||(_3.membersMargin!=null)))
{var c={ID:_3.ID+"$1587",_constructor:"VStack",autoDraw:false,contained:_3.contained,specialProperties:{controlName:"Stack"}};_2.addAt(c,_2.indexOf(_3)+1);_1.addAt(c,_4?_1.indexOf(_4):_1.indexOf(_3));if(_3.membersMargin){c.membersMargin=_3.membersMargin;delete _3.membersMargin}
_3.contained=[c]}
if(_13&&_13._constructor=="SectionStack")
{_8=0;_9=0;delete _3.layoutRightMargin;delete _3.layoutBottomMargin}
if((_6>0&&_6<=_5)||(_7>0&&_7<=_5)||(_8>0&&_8<=_5)||(_9>0&&_9<=_5))
{var c=null;if(_4!=null){c=_4}else if(_3._constructor=="Window"){c={};_3.bodyDefaults=c}else if(_3._constructor=="SectionStack"){c=_3.contained[0]}else{c=_3}
if(c!=null){if(_3.specialProperties==null){_3.specialProperties={}}
_3.specialProperties.layoutContainer=c;if(c._constructor=="DynamicForm"){var _22=Math.round((_6+_7)/2);var _23=10;if(Math.abs(_7-_22)<_23&&Math.abs(_6-_22)<_23&&(_22-_8)<_23)
{c.padding=_22}}else if(!c.specialProperties||c.specialProperties.controlName!="com.balsamiq.mockups::BrowserWindow")
{if(_6>0&&_6<=_5){c.layoutLeftMargin=_6}
if(_7>0&&_7<=_5){c.layoutTopMargin=_7}
if(_8>0&&_8<=_5){c.layoutRightMargin=_8}
if(_9>0&&_9<=_5){c.layoutBottomMargin=_9}}}}});isc.evalBoundary;isc.B.push(isc.A.processRemoveWidths=function isc_MockupImporter_processRemoveWidths(_1,_2,_3){var _4=this.$98p;var _5=_4.widgetPropertyTranslations[_3.specialProperties.controlName];for(var j=0;j<_3.contained.length;j++){var _7=_3.contained[j];var _8=null;var _9=null;var _10=this.getParent(_1,_3);var _11=_7.specialProperties;var _12=this.getControlWidthUsingItsParents(_1,_3);var _13=0;var _14=0;var _15=0;var _16=0;if(_11&&_11.controlName){var _17=_4.widgetPropertyTranslations[_7.specialProperties.controlName];if(_17){var _13=_17.getLeftMargin?_17.getLeftMargin(_7):0;var _14=_17.getRightMargin?_17.getRightMargin(_7):0;var _15=_17.getTopMargin?_17.getTopMargin(_7):0;var _16=_17.getLeftMargin?_17.getLeftMargin(_7):0}}
var _18=_11&&_11.left||_7.left;var _19=_11&&_11.top||_7.top;if(_18<=(this.stackContainerFillInset+_13)&&(_7.left+_7.width)>=(_12-(this.stackContainerFillInset+_14))||((_3._constructor=="VStack"||_3._constructor=="VLayout")&&(_7._constructor=="HStack"||_7._constructor=="HLayout")))
{if(!_7.specialProperties)_7.specialProperties={};_7.specialProperties.fullWidth=true;_7.specialProperties.containerName=_3._constructor;_8=true}
var _20=this.getControlHeightUsingItsParents(_1,_3);if((_19<=(this.stackContainerFillInset+_15)&&((_7.top+_7.height)>=(_20-(this.stackContainerFillInset+_16))))||((_3._constructor=="HStack"||_3._constructor=="HLayout")&&(_7._constructor=="VStack"||_7._constructor=="VLayout")))
{if(!_7.specialProperties)_7.specialProperties={};_7.specialProperties.fullHeight=true;_7.specialProperties.containerName=_3._constructor;_9=true}
if((_3._constructor=="TabSet"||_3._constructor=="Window"||_3._constructor=="SectionStack"||_3._constructor=="VStack"||_3._constructor=="VLayout")&&_7.width!=null&&(_7.specialProperties==null||_7.specialProperties.overrideWidth==null))
{if(_7.left<=this.stackContainerFillInset){_7.layoutAlign="left"}else if(_7.left+_7.width>=(_3.width-this.stackContainerFillInset-_5.getLeftMargin(_3)
-_5.getRightMargin(_3)))
{_7.layoutAlign="right"}else if(Math.abs(_7.left+_7.width/2-
(_3.width-_5.getLeftMargin(_3)
-_5.getRightMargin(_3))/2)<=this.stackContainerFillInset)
{_7.layoutAlign="center"}else if(_7._constructor=="Label"){var _21=_7.left-_3.left+_5.getLeftMargin(_3);if(_21>this.stackContainerFillInset/2){_7.align="right"}}
if(!_7.layoutAlign&&_7.width>10){var _22=true;for(var i=0;i<_3.contained.length;i++){var c=_3.contained[i];if(c!=_7&&_7.width>(c.width*0.85)){_22=false;break}}
if(_22){var _25=(_3.width-_5.getLeftMargin(_3)-_5.getRightMargin(_3));var _26=_25-(_7.left+_7.width);if(_7.left>_26)_7.layoutAlign="right"}}}else if((_3._constructor=="HStack"||_3._constructor=="HLayout")&&_7.height!=null)
{if(_7.top<=this.stackContainerFillInset){_7.layoutAlign="top"}else if(_7.top+_7.height>=(_3.height-this.stackContainerFillInset-_5.getTopMargin(_3)
-_5.getBottomMargin(_3)))
{_7.layoutAlign="bottom"}else if(Math.abs(_7.top+_7.height/2-
(_3.height-_5.getTopMargin(_3)
-_5.getBottomMargin(_3))/2)<this.stackContainerFillInset)
{_7.layoutAlign="center"}
if(_7._constructor=="Label"&&_7.layoutAlign&&_7.layoutAlign!="center")
{}}
if(_8&&_9&&_3.contained.length>1){this.processSnapToHeuristic(_1,_3,_7);break}}},isc.A.processSnapToHeuristic=function isc_MockupImporter_processSnapToHeuristic(_1,_2,_3){var _4=5;for(var i=0;i<_2.contained.length;i++){var _6=_2.contained[i];if(_6!=_3){if(_6.width!=null){var _7=this.getControlWidthUsingItsParents(_1,_2);if(Math.abs(_7-_6.width)<=_4*2){}else if(Math.abs(_7-(_6.left+_6.width))<=_4){_6.snapToHor="R";delete _6.left}else if(Math.abs(_7/2-(_6.left+_6.width/2))<=_4){_6.snapToHor="C";delete _6.left}else if(_6.left<=_4){_6.snapToHor="L";delete _6.left}}
if(_6.height!=null){var _8=this.getControlHeightUsingItsParents(_1,_2);if(Math.abs(_8-_6.height)<=_4*2){}else if(Math.abs(_8-(_6.top+_6.height))<=_4){_6.snapToVer="B";delete _6.top}else if(Math.abs(_8/2-(_6.top+_6.height/2))<=_4){_6.snapToVer="C";delete _6.top}else if(_6.top<=_4){_6.snapToVer="T";delete _6.top}}
var _9="";if(_6.snapToVer!=null){_9+=_6.snapToVer;delete _6.snapToVer;delete _6.layoutTopMargin}
if(_6.snapToHor!=null){if(_6.snapToVer=="C"){_9=_6.snapToHor}else{_9+=_6.snapToHor}
delete _6.snapToHor;delete _6.layoutLeftMargin}
if(_2.markupContained==null){_2.markupContained=[]}
if(_9!=null&&_9!=""){_6.snapTo=_9;_2.markupContained.add(_6);_2.contained.removeAt(i);i--}else{_2.markupContained.add(_6);_2.contained.removeAt(i);i--}}}
return _1},isc.A.getControlHeightUsingItsParents=function isc_MockupImporter_getControlHeightUsingItsParents(_1,_2){var _3=_2.height,_4=this.$98p;if(_3==null){var _5=this.getParent(_1,_2);while(_5!=null&&_5.height==null){_5=this.getParent(_1,_5)}
if(_5!=null){var _6=_4.widgetPropertyTranslations[_5.specialProperties.controlName];_3=_5.height-_6.getTopMargin(_5)-_6.getBottomMargin(_5)}}else{var _6=_4.widgetPropertyTranslations[_2.specialProperties.controlName];if(_6.getTopMargin!=null&&_6.getBottomMargin!=null){_3=_2.height-_6.getTopMargin(_2)-_6.getBottomMargin(_2)}}
return _3},isc.A.getControlWidthUsingItsParents=function isc_MockupImporter_getControlWidthUsingItsParents(_1,_2){var _3=_2.width,_4=this.$98p;if(_3==null){var _5=this.getParent(_1,_2);while(_5!=null&&_5.width==null){_5=this.getParent(_1,_5)}
if(_5!=null){var _6=_4.widgetPropertyTranslations[_5.specialProperties.controlName];_3=_5.width-_6.getLeftMargin(_5)-_6.getRightMargin(_5)}}else{var _6=_4.widgetPropertyTranslations[_2.specialProperties.controlName];if(_6.getLeftMargin!=null&&_6.getRightMargin!=null){_3=_2.width-_6.getLeftMargin(_2)-_6.getRightMargin(_2)}}
return _3},isc.A.getParent=function isc_MockupImporter_getParent(_1,_2){for(var i=0;i<_1.length;i++){if(_1[i].contained!=null&&_1[i].contained.contains(_2)){return _1[i]}
if(_1[i].children!=null&&_1[i].children.contains(_2)){return _1[i]}}
return null},isc.A.processFluidLayoutHeuristic=function isc_MockupImporter_processFluidLayoutHeuristic(_1,_2){for(var i=0;i<_2.length;i++){var _4=_2[i];var _5=_4.specialProperties;if(_4._constructor=="TabSet"){var _6=_4.tabs&&_4.tabs[_4.selectedTab]?_4.tabs[_4.selectedTab].pane:null;if(_6&&_6.VStack){_4=_6.VStack;_4._constructor="VStack"}}
if((_5&&(_5.fullWidth||_5.fullHeight))||_4.height==null||_4.height=="100%"||_4.width==null||_4.width=="100%")
{var _7=(_4._constructor=="HStack"||_4._constructor=="HLayout"?"height":"width"),_8=(_4._constructor=="HStack"||_4._constructor=="HLayout"?"width":"height");if(_4._constructor=="HStack"||_4._constructor=="HLayout"||_4._constructor=="VStack"){for(var j=0;j<_5.innerItems.length;j++){var _10=_5.innerItems[j],_11=_10[_7],_12=_4[_7];if(_11>(_12-this.stackContainerFillInset)){this.removeWidgetSizeProperty(_10,(_7=="width"))}}}
if(_4._constructor=="HStack"||_4._constructor=="HLayout"||_4._constructor=="VStack"){var _13=[];var _14=0;for(var j=0;j<_5.innerItems.length;j++){var _10=_5.innerItems[j];if(_13.isEmpty()&&((_10._constructor=="HLayout"&&_4._constructor=="HStack")||(_10._constructor=="VLayout"&&_4._constructor=="VStack")))
{if(_14!=1){_13.clear();_14=1}
_13.add(_10)}
if(_10._constructor=="ListGrid"&&(_13.isEmpty()||_14>=2))
{if(_14!=2){_13.clear();_14=2}
_13.add(_10)}
if(_10._constructor=="DynamicForm"&&_4._constructor=="VStack"&&(_13.isEmpty()||_14>=3))
{if(_10.items!=null||_10.fields!=null){var _15=_10.items||_10.fields;for(var k=0;k<_15.length;k++){var _17=_15[k];if(_17._constructor=="TextAreaItem"){if(_14!=3){_13.clear();_14=3}
_13.add(_10);break}}}}
if(_10._constructor=="TabSet"&&(_13.isEmpty()||_14>=4))
{var _18=_10.specialProperties&&_10.specialProperties.innerItems,_6=_18&&_18[0];if(_6&&_6._constructor!="HStack"&&_6._constructor!="VStack"&&_6.specialProperties&&_6.specialProperties.fullHeight&&_6.specialProperties.fullWidth)
{if(_14!=4){_13.clear();_14=4}
_13.add(_10)}}
if(_10.specialProperties&&_10.specialProperties.innerItems&&(_13.isEmpty()||_14>=5))
{var _18=_10.specialProperties.innerItems,_19=(_18.length==1&&_18[0]),_20=(_19&&_19.specialProperties!=null&&_19.specialProperties.controlName),_21=(_20=="com.balsamiq.mockups::TagCloud");if(!_21){if(_14!=5){_13.clear();_14=5}
_13.add(_10)}}}
if(!_13.isEmpty()){if(_13.length>1){var _22=(_4._constructor=="HStack"||_4._constructor=="HLayout")?"width":"height";var _23=_13[0][_22];var _24=_13[0][_22];var _25=_13[0];for(var _26=1;_26<_13.length;_26++){var _27=_13[_26];var _28=_27[_22];if(_28<_23){_23=_28}else if(_28>_24){_24=_28;_25=_27}}
if(_24-_23<this.stackFlexMaxSizeMatch){for(var _26=0;_26<_13.length;_26++){this.removeWidgetSizeProperty(_13[_26],(_22=="width"))}}else{this.removeWidgetSizeProperty(_25,(_22=="width"))}}else{this.removeWidgetSizeProperty(_13[0],(_4._constructor=="HStack"||_4._constructor=="HLayout"))}
if(_4._constructor=="HStack"){_4._constructor="HLayout"}else if(_4._constructor=="VStack"){_4._constructor="VLayout"}}}}}
return _1},isc.A.removeWidgetSizeProperty=function isc_MockupImporter_removeWidgetSizeProperty(_1,_2){if(_2){delete _1.width;if(_1._constructor=="DynamicForm"){_1.width="*";var _3=_1.items||_1.fields;if(_3){for(var i=0;i<_3.length;i++){if(_3[i]._constructor=="TextAreaItem"){_3[i].width="*"}}}}}else{delete _1.height;if(_1._constructor=="DynamicForm"){var _3=_1.items||_1.fields,_5=false;if(_3){for(var i=0;i<_3.length;i++){if(_3[i]._constructor=="TextAreaItem"){_3[i].height="*";_5=true}}
if(_5)_1.height="*"}}}},isc.A.processTabVStackHeuristic=function isc_MockupImporter_processTabVStackHeuristic(_1,_2){for(var i=0;i<_2.length;i++){var _4=_2[i];if(_4._constructor=="TabSet"){var _5=_4.tabs;for(var j=0;j<_5.length;j++){var _7=_5[j];if(_7.pane&&_7.pane.VStack){var _8=_7.pane.VStack,_9=_4.specialProperties.innerItems;_8.ID=_4.ID+"$175b"+j;if(!_8._constructor)_8._constructor="VStack";if(!_8.specialProperties)_8.specialProperties={};if(!_8.specialProperties.innerItems)_8.specialProperties.innerItems=[];for(var k=0;k<_8.members.length;k++){var _11=_9.find("ID",_8.members[k]);if(_11){_9.remove(_11);_8.specialProperties.innerItems.add(_11)}
_8.members[k]={ref:_8.members[k]}}
_7.pane=_8.ID;_1.addAt(_8,_1.indexOf(_4));_9.add(_8)}}}}
return _1},isc.A.logWarn=function isc_MockupImporter_logWarn(_1,_2){this.Super("logWarn",arguments);this.warnings+="\n"+_1});isc.B._maxIndex=isc.C+81;isc.ClassFactory.defineClass("BMMLImportDialog",isc.Dialog);isc.A=isc.BMMLImportDialog.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.showFileNameField=true;isc.A.showAssetsNameField=true;isc.A.showOutputField=true;isc.A.outputFieldTitle="Output File Name";isc.A.showSkinSelector=true;isc.A.showImportForm=true;isc.A.autoSize=true;isc.A.autoCenter=true;isc.A.showMinimize=false;isc.A.title="Import Balsamiq File";isc.A.showToolbar=false;isc.A.skin="Tahoe";isc.A.importFormDefaults={_constructor:"FilePickerForm",autoDraw:false,showPickButton:false,showPasteForm:false,isGroup:true,groupTitle:"Mockup File Location",uploadFormProperties:{initWidget:function(){this.Super("initWidget",arguments);var _1=this.getField("file");_1.accept=".bmml,.bmpr";if(!this.creator.showAssetsNameField)return;var _2=this;this.addField({name:"assetsName",title:"Upload assets",editorType:isc.TLinkItem||isc.LinkItem,target:"javascript",defaultValue:"upload an asset file",width:"*",colSpan:"*",startRow:true,canEdit:false,click:function(_7,_8){var _3=isc.TWindow||isc.Dialog;var _4=_3.create({title:"Load asset",height:140,width:400,showToolbar:false,autoCenter:true});var _5=_7;var _6=isc.DynamicForm.create({dataSource:_7.dataSource,numCols:3,cellPadding:5,colWidths:"140, 180, *",autoDraw:false,fields:[{name:"file",editorType:isc.TFileItem||isc.FileItem,title:"Asset file",colSpan:3,endRow:true},{type:"SpacerItem"},{name:"submitButton",title:"Load",editorType:isc.TButtonItem||isc.ButtonItem,endRow:false,startRow:false,align:"right",click:function(_9,_8){if(_9.getValues().file!=null){_9.getValues().file_dir="[VBWORKSPACE]/assets";_4.hide();_9.saveData(_2.getID()+".uploadAssetCallback(dsResponse, data)")}else{isc.warn("Select asset to upload")}}},{name:"cancelButton",title:"Cancel",align:"right",editorType:isc.TButtonItem||isc.ButtonItem,startRow:false,click:function(_7,_8){_4.hide()}}]});_4.addItem(_6);_4.show()}})},uploadAssetCallback:function(_1,_2,_3){var _4=this;var _5=_2.fileName;if(_4.assetFiles==null){_4.assetFiles=[]}
if(!_4.assetFiles.contains(_5))
{_4.assetFiles.add(_5)}
if(_4.assetFiles.length==1){_4.setValue("assetsName",_4.assetFiles[0]+" (click to upload more)")}else{_4.setValue("assetsName",_4.assetFiles.length+" assets (click to upload more)")}
if(_3){_4.getField("file").clearValue()}}},selectFormProperties:{selectFileDialogProperties:{actionStripControls:["spacer:10","pathLabel","previousFolderButton","spacer:10","upOneLevelButton","spacer:10","refreshButton","spacer:2"],title:"Import Balsamiq File",initialDir:"[VBWORKSPACE]",rootDir:"/",webrootOnly:false,fileFilters:[{filterName:"BMPR/BMML Files",filterExpressions:[new RegExp("\\.bmpr$"),new RegExp("\\.bmml$")]}],checkFile:function(_1){if(_1.match(/\.(bmpr)$/i)==null&&_1.match(/\.(bmml)$/i)==null){isc.say("Only BMPR and BMML files may be imported (must end with .bmpr or .bmml)");return false}else{return true}}},initWidget:function(){this.Super("initWidget",arguments);this.getField("fileName").setPrompt("Click to select the BMPR or BMML file you want to import.")}},uploadCallback:function(_1,_2){var _3=_2.path;var _4=_2.id;var _5=_2.fileName;var v=this.valuesToSend;this.creator.submit(_3,_4,v.outputFileName,_2.file,v.skin,v.dropMarkup,v.trimSpace,v.fillSpace,v.fieldNamingConvention,false,true)}};isc.A.formsDefaults={titleWidth:140,cellPadding:6,width:"100%"};isc.B.push(isc.A.initWidget=function isc_BMMLImportDialog_initWidget(){this.Super("initWidget",arguments);this.vm=isc.ValuesManager.create();this.vm.setValues({uploadFromURL:this.uploadFromURL,outputFileName:this.outputFileName,skin:this.skin,dropMarkup:this.dropMarkup,trimSpace:this.trimSpace,fillSpace:this.fillSpace,fieldNamingConvention:this.fieldNamingConvention});if(this.$98b!=null&&!this.$98b){this.vm.getValues().fileName=this.fileName}
var _1=this.showFileNameField;var _2=isc.DataSource.get("SCUploadSaveFile");var _3=this;_2.performCustomOperation("checkUploadFeature",null,function(_4,_5){if(_4.status==isc.RPCResponse.STATUS_SUCCESS){_3.importForm=_3.createAutoChild("importForm",{visibility:_3.showImportForm?"inherit":"hidden",showSelectForm:_3.showFileNameField,showAssetsNameField:_3.showAssetsNameField,showUploadForm:true,valuesManager:_3.vm,formsProperties:_3.formsDefaults})}else{_3.importForm=_3.createAutoChild("importForm",{visibility:_3.showImportForm?"inherit":"hidden",showSelectForm:_3.showFileNameField,showAssetsNameField:false,showUploadForm:false,valuesManager:_3.vm,formsProperties:_3.formsDefaults})}
_3.importForm.setDataSource(_2);_3.addItem(_3.importForm);_3.addItem(_3.$98c());_3.addItem(_3.$204j());_3.addItem(_3.$98d());_3.addItem(_3.$98e());_3.addItem(_3.$204k());_3.importForm.delayCall("focus",[])},{willHandleError:true})},isc.A.submit=function isc_BMMLImportDialog_submit(_1,_2,_3,_4,_5,_6,_7,_8,_9,_10){},isc.A.$98e=function isc_BMMLImportDialog__createActionsForm(){var _1=this;var _2=[{name:"fieldNamingConvention",editorType:isc.TSelectItem||isc.SelectItem,width:175,title:"Field Naming Convention",defaultValue:"camelCaps",startRow:false,endRow:true,valueMap:{camelCaps:"camelCaps",underscores:"Underscores",underscoresAllCaps:"Underscores All Caps",underscoresKeepCase:"Underscores Keep Case"},hoverWidth:200,titleHoverHTML:function(_4,_5){return"Naming convention used when translating grid column labels and input field labels to DataSource field identifiers.  This does not affect the appearance or behavior of the imported mockup, just the identifiers used when connecting your imported mockup to real data.<P>Choose a naming convention that is similar to how your Java code or database columns are named - hover options in the drop-down list for details.<P>If unsure, keep the default of \"camelCaps\"."},itemHoverHTML:function(_4,_5){var _3=_4.getValue();if(_3=="camelCaps"){return"For example, \"First Name\" becomes \"firstName\".  Best setting for binding to Java Beans (including Hibernate and JPA) and databases where columns names have no underscores, for example, \"FIRSTNAME\"."}else if(_3=="underscores"){return"For example, \"First Name\" becomes \"first_name\".  Best setting for databases that have underscores in column names, for example, \"FIRST_NAME\"."}else if(_3=="underscoresAllCaps"){return"For example, \"First Name\" becomes \"FIRST_NAME\".  Alternative to \"Underscores\" for developers who prefer field identifiers to be all caps."}else if(_3=="underscoresKeepCase"){return"For example, \"First Name\" becomes \"First_Name\".  Alternative to \"Underscores\" for developers who prefer field identifiers to be mixed case."}}}];if(this.showOutputField){_2.add({name:"outputFileName",title:this.outputFieldTitle,type:isc.TTextItem||isc.TextItem,width:450,hoverWidth:200,hint:"Optional",itemHoverHTML:function(){return"Writes the source code of the imported screen to the specified path.  If the specified path is relative (does not start with a slash), it is assumed to be relative to webroot/tools.  If the file name ends in 'js' the output is JavaScript, otherwise it's XML."},titleHoverHTML:function(){return this.itemHoverHTML()}})}
return isc.DynamicForm.create(isc.addProperties({autoDraw:false,autoFocus:true,saveOnEnter:true,wrapItemTitles:false,width:"100%",useAllDataSourceFields:false,valuesManager:this.vm,fields:_2,isGroup:true,showGroupLabel:false,groupBorderCSS:"1px solid transparent"},this.formsDefaults,this.formsProperties))},isc.A.$204k=function isc_BMMLImportDialog__createButtonBar(){var _1=this;var _2=isc.Button.create({title:_1.showImportForm?"Import":"Update",width:100,layoutAlign:"right",click:function(_17,_18){var _3=isc.addProperties(_1.vm.getValues());if(_1.importForm.uploadForm){_3=isc.addProperties(_3,_1.importForm.uploadForm.getValues())}
var _4=_3.fileURL;if(_3.fileName=='select file'&&_3.file==null&&_4==null&&!(_1.$98b&&_1.fileName!=null)&&_1.showImportForm)
{isc.warn("Select a file to process.")}else{if(_3.file!=null){_3.file_dir="[READ_ONLY]";if(_1.showAssetsNameField&&(_3.file=="symbols.bmml"||_3.file.endsWith("\symbols.bmml")))
{isc.ask("The file 'symbols.bmml' looks like an asset file. Do you want to convert it or add to assets?",function(_19){},{buttons:[isc.Button.create({title:"Convert",click:function(){this.topElement.hide();if(_1.importForm.creator)_1.importForm.creator.hide();_3.file_dir="[READ_ONLY]";_1.importForm.valuesToSend=isc.clone(_3);_1.importForm.saveData(_1.importForm.getID()+".uploadCallback(dsResponse, data)")}}),isc.Button.create({title:"Add to assets",click:function(){this.topElement.hide();_3.file_dir="[VBWORKSPACE]/assets";_1.importForm.valuesToSend=isc.clone(_3);_1.importForm.saveData(_1.importForm.getID()+".uploadAssetCallback(dsResponse, data, true)")}})]})}else{if(_1.importForm.creator)_1.importForm.creator.hide();_3.file_dir=(_3.file.endsWith(".bmpr")?"[BMPR]":"[READ_ONLY]");_1.importForm.valuesToSend=isc.clone(_3);if(_3.file_dir&&_1.importForm.uploadForm){_1.importForm.uploadForm.setValue("file_dir",_3.file_dir)}
_1.importForm.saveData(_1.importForm.getID()+".uploadCallback(dsResponse, data)")}}else{if(_4!=null){if(!_4.startsWith("http")){_4="http://"+_4}
var _5=new RegExp("^http(?:s)?://([^/:]+)(?::[0-9]+)?(/.*)?$"),_6=_4.match(_5),_7=(_6!=null&&_6[1]!=null?_6[1].toString():""),_8=_7=="mybalsamiq.com"||_7.endsWith(".mybalsamiq.com");if(_8){var _9=(_6!=null&&_6[2]!=null?_6[2].toString():""),_10=_4.length-_9.length;if(_9!=""&&_9!="/"&&!_4.endsWith(".bmml")){_4+=".bmml"}
var j=-1;while((j=_9.indexOf("/edit/",j+1))!=-1){var k=j+_10;_4=_4.substring(0,k)+_4.substring(k+5);_10=_10-5}}}
var _13=_4!=null,_14=_1.$98b,_15=_14&&_3.fileName=="select file"&&!_3.fileURL&&_1.fileName;if(!_1.showImportForm)_13=true;else _15=_15||_4||_3.fileName;if(_1.importForm.creator)_1.importForm.creator.hide();_1.submit(_15,_3.outputFileName,null,_3.skin,_3.dropMarkup,_3.trimSpace,_3.fillSpace,_3.fieldNamingConvention,_13,_14)}}}});var _16=isc.HLayout.create({autoDraw:false,height:10,width:"100%",layoutTopMargin:5,members:[isc.LayoutSpacer.create(),_2]});return _16},isc.A.$204j=function isc_BMMLImportDialog__createSettingsHeaderForm(){var _1=[];_1.addList([{name:"header",type:"header",defaultValue:"Advanced Settings",width:"*",align:"center"}]);return isc.DynamicForm.create(isc.addProperties({autoDraw:false,numCols:1,width:"100%",wrapItemTitles:false,fields:_1,isGroup:true,showGroupLabel:false,groupBorderCSS:"1px solid transparent"},this.formsDefaults,this.formsProperties))},isc.A.$98d=function isc_BMMLImportDialog__createFlagsForm(){var _1=[];_1.addList([{name:"dropMarkup",title:"Drop Markup",titleAlign:"left",editorType:isc.TCheckboxItem||isc.CheckboxItem,labelAsTitle:true,defaultValue:true,hoverWidth:200,width:"*",startRow:true,itemHoverHTML:function(){return"If enabled, markup elements such as sticky notes and strikethroughs are dropped during import."},titleHoverHTML:function(){return this.itemHoverHTML()}},{name:"trimSpace",title:"Trim Space",editorType:isc.TCheckboxItem||isc.CheckboxItem,labelAsTitle:true,defaultValue:true,hoverWidth:200,width:"*",itemHoverHTML:function(){return"If enabled, and there is empty space to the left/top of the mockup, the mockup is moved to 0,0 instead.  In combination with dropMarkup, this also means that a mockup with only markup elements to the left/top of it will be moved to 0,0 as part of importing."},titleHoverHTML:function(){return this.itemHoverHTML()}},{name:"fillSpace",title:"Fill Space",editorType:isc.TCheckboxItem||isc.CheckboxItem,labelAsTitle:true,defaultValue:true,hoverWidth:200,width:"*",itemHoverHTML:function(){return"If enabled and a mockup-import results in a single layout or single top-level container with a single layout within it, the top-level widget will be set to 100% width and height so that it fills available space."},titleHoverHTML:function(){return this.itemHoverHTML()}}]);return isc.DynamicForm.create(isc.addProperties({autoDraw:false,saveOnEnter:true,numCols:6,width:"100%",wrapItemTitles:false,useAllDataSourceFields:false,valuesManager:this.vm,fields:_1,isGroup:true,showGroupLabel:false,groupBorderCSS:"1px solid transparent"}))},isc.A.$98c=function isc_BMMLImportDialog__createHeadForm(){var _1=[];if(this.showSkinSelector){_1.add({name:"skin",editorType:isc.TSelectItem||isc.SelectItem,width:175,title:"Skin",defaultValue:this.skin,endRow:false,valueMap:{Enterprise:"Enterprise",EnterpriseBlue:"Enterprise Blue",Graphite:"Graphite",Tahoe:"Tahoe",Simplicity:"Simplicity",TreeFrog:"TreeFrog",BlackOps:"Black Ops",standard:"Basic"},changed:function(_3,_4,_5){var _2=isc.URIBuilder.create(window.location.href);_2.setQueryParam("skin",_5);window.location.replace(_2.uri)}})}
return isc.DynamicForm.create(isc.addProperties({autoDraw:false,saveOnEnter:true,wrapItemTitles:false,width:"100%",useAllDataSourceFields:false,valuesManager:this.vm,fields:_1,isGroup:true,showGroupLabel:false,groupBorderCSS:"1px solid transparent"},this.formsDefaults,this.formsProperties))});isc.B._maxIndex=isc.C+7;isc.BMMLImportDialog.changeDefaults("bodyDefaults",{width:"100%"});isc.defineClass("FieldMapper","HStack");isc.A=isc.FieldMapper.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width=772;isc.A.height=380;isc.A.membersMargin=10;isc.A.layoutTopMargin=10;isc.A.description='The "Component Fields" list below shows how your existing fields will be connected to new DataSource fields.  Drag fields from the new DataSource to the Component Fields grid to create a mapping or add new field. Field names and titles can also be edited by Double-clicking on a row.';isc.B.push(isc.A.initWidget=function isc_FieldMapper_initWidget(){this.Super("initWidget",arguments);var _1=this;var _2=this.mockDataSource;if(isc.isA.DataSource(_2)){this.mockDataSourceFields=_2.getFields()}
var _3=this.mockFields;if(_3&&_3.length>0){var _4={};for(var i=0;i<_3.length;i++){_4[_3[i].name]=_3[i]}
this.mockDataSource={fields:_4,getFields:function(){return this.fields}}};this.targetDataSourceList=isc.ListGrid.create({width:(this.width-20)/2,height:"100%",alternateRecordStyles:true,fields:[{name:"name",title:"Name"},{name:"title",title:"Title"},{name:"type",title:"Type"},{name:"inUse",title:"Used?",type:"boolean",showValueIconOnly:true,valueIcons:{"true":"[SKINIMG]actions/approve.png","false":"[SKINIMG]blank.gif"}}],canDragRecordsOut:true,dragDataAction:"copy",autoDraw:false,selectionUpdated:function(_7,_13){_1.$171z.setDisabled(_13.length==0)},updateInUseFields:function(_19,_20){if(_20){this.setValue(_20,false)}
this.setValue(_19,true);var _4=_1.targetDataSource.getFields();var _6=[];for(var i=0;i<this.data.length;i++){if(!this.data[i].inUse){_6.add(this.data[i].name)}}
_1.$87z.getField("mappedTo").valueMap=_6},setValue:function(_19,_20){for(var i=0;i<this.data.length;i++){if(this.data[i].name==_19){this.data[i].inUse=_20;this.redraw();return}}}});this.$87z=isc.ListGrid.create({width:(this.width-20)/2,height:"100%",alternateRecordStyles:true,fields:[{name:"name",title:"Name"},{name:"title",title:"Title"},{name:"mappedTo",title:"Mapped To",type:"SelectItem",change:function(_19,_20,_21,_22){_1.targetDataSourceList.updateInUseFields(_21,_22)}}],canReorderRecords:true,canAcceptDroppedRecords:true,canRemoveRecords:true,selectionUpdated:function(_7,_13){_1.$1710.setDisabled(_13.length==0);_1.$1711.setDisabled(_13.length==0)},getCellCSSText:function(_7,_19,_20){return(_7.origName&&_7.origName!=_7.name&&_20==this.getFieldNum("name")?this.editPendingCSSText:"")},removeRecordClick:function(_19){var _7=this.getRecord(_19),_8=_7&&_7.mappedTo;this.Super("removeRecordClick",arguments);_1.targetDataSourceList.updateInUseFields(null,_8)},$1712:function(_19,_11){for(var i=0;i<this.data.length;i++){if(this.data[i].mappedTo==_19.name){delete this.data[i].mappedTo;break}};if(_11==null){_11=this.data.find("name",_19.name)}
var _9=_1.targetDataSourceList;if(_11==null){var _10=isc.clone(_19);_10.mappedTo=_10.name;this.data.add(_10);_9.updateInUseFields(_10.name);return}
_9.updateInUseFields(_19.name,_11.mappedTo);_11.mappedTo=_19.name},transferRecords:function(_19,_11,_20,_16){if(this==_16){this.Super("transferRecords",arguments);return}
if(_20==null)_20=this.getRecordIndex(_11);for(var i=0;i<_19.length;i++){this.$1712(_19[i],_20<0?null:this.getRecord(_20+i))}
this.redraw()},recordDrop:function(_19,_11,_20,_16){if(this==_16){this.Super("recordDrop",arguments);return}
var _11=this.getRecord(this.hilitedRecord);return this.transferRecords(_19,_11,null,_16)},dropMove:function(){this.hilitedRecord=this.getEventRecordNum();if(this.hilitedRecord==-2){delete this.hilitedRecord;this.clearLastHilite()}else{this.$88(this.hilitedRecord)}},canEdit:true,modalEditing:true,autoDraw:false});this.$1713=isc.DynamicForm.create({items:[{name:"keepUnmapped",_constructor:"CheckboxItem",title:"Keep unmapped fields",width:"100%",height:1}]});var _12=function(_19,_20){var _13=_19.getSelectedRecords(),_14=_19.getRecordIndex(_13[0]);if(_14>=0){if(!_20){var _15=_19.getTotalRows();for(var i=_14;i<_15;i++){if(!_19.isSelected(_19.getRecord(i))){_14=i;break}}}
return _19.recordDrop(_13,null,_14+(_20?-1:1),_19)}};this.$1710=isc.ImgButton.create({size:16,showDown:false,disabled:true,src:"[SKINIMG]TransferIcons/up.png",click:function(){return _12(_1.$87z,true)}});this.$171z=isc.ImgButton.create({size:16,showDown:false,disabled:true,src:"[SKINIMG]TransferIcons/left.png",click:function(){var _16=_1.targetDataSourceList,_17=_1.$87z,_13=_16.getSelectedRecords(),_11=_17.getSelectedRecord();var _18=_17.getRecord(_17.getEditRow());if(_18==_11)_11=null;_17.transferRecords(_13,_11,null,_16)}});this.$1711=isc.ImgButton.create({size:16,showDown:false,disabled:true,src:"[SKINIMG]TransferIcons/down.png",click:function(){return _12(_1.$87z)}});this.setMembers([isc.VStack.create({members:[{_constructor:"Label",contents:"Component Fields",height:1,width:this.$87z.width,baseStyle:"headerItem"},this.$87z,this.$1713]}),this.$1714=isc.VStack.create({width:1,height:75,layoutAlign:"center",members:[this.$1710,this.$171z,this.$1711]}),isc.VStack.create({members:[{_constructor:"Label",contents:"New DataSource Fields",height:1,width:this.targetDataSourceList.width,baseStyle:"headerItem"},this.targetDataSourceList]})]);if(this.mockDataSource==null){isc.logWarn("MockDataSource should be set")}else if(this.targetDataSource==null){isc.logWarn("TargetDataSource should be set")}else{this.setDefaultData()}},isc.A.getMockFieldDefaults=function isc_FieldMapper_getMockFieldDefaults(_1){var _2=this.mockDataSource.getFields(),_3=_2[_1],_4=_3.editNode;if(_4)return _4.defaults;var _5=this.mockDataSourceFields;if(_5){var _6=_5[_1];if(_6)return _6}
return _3},isc.A.getChanges=function isc_FieldMapper_getChanges(){var _1=this.$1713.getValue("keepUnmapped"),_2=this.getMappedFields(_1,false);if(_2==null)return null;var _3={};for(var i=0;i<_2.length;i++){var _5=_2[i],_6=_5.mappedTo;if(_5.type){_3[_5.name]=null}else if((_6&&_6!=_5.name)||(!_6&&_5.name!=_5.origName)){_3[_5.mappedTo||_5.name]=_5.origName}}
return _3},isc.A.getDeletes=function isc_FieldMapper_getDeletes(){var _1=this.$1713.getValue("keepUnmapped"),_2=this.getMappedFields(_1,false);if(_2==null)return null;var _3=isc.getKeys(this.mockDataSource.getFields()),_4=[];for(var i=0;i<_3.length;i++){if(!_2.find("origName",_3[i])){_4[_4.length]=_3[i]}}
return _4},isc.A.applyMap=function isc_FieldMapper_applyMap(_1,_2,_3,_4){var _5=this;var _6=this.$1713.getValue("keepUnmapped"),_7=this.getMappedFields(_6,!_4,function(_24){if(_24)_5.applyMap(_1,_2,_3,true)});if(_7==null)return false;var _8=this.mockDataSource.getFields();this.callback();var _9=isc.DS.get(_1.getClassName()),_10=isc.isA.DynamicForm(_1),_11=_9.getField("fields").type;var _12=_1.editContext;for(var i=_2.children.length-1;i>=0;i--){if((_10&&_2.children[i].type!="DataSource")||_2.children[i].type==_11){_12.removeNode(_2.children[i],true)}}
var _14=this.targetDataSourceList.getData();var _15=this.targetDataSource;for(var i=0;i<_7.length;i++){var _16=_7[i],_17=_16.mappedTo,_18=_1.editProxy;isc.FieldMapper.$102q(_17||_16.inUse==null,"Target fields copied to the mockup fields list cannot to be unmapped");var _19=_16.inUse==null&&_8[_16.name],_20=_19&&_19.editNode;if(!_17&&_20){_16=_19}else{var _21=_20&&_20.defaults?isc.EditProxy.filterLiveObjectBySchema(_11,_20.defaults):{};var _22=(_17?isc.addProperties({},_16,{name:_17}):_16);if(!_10)delete _22.type;delete _22.inUse;delete _22.mappedTo;delete _22.origName;var _23=_18.makeFieldPaletteNode(_12,_22,_15,_21),_20=_12.makeEditNode(_23);_16=isc.addProperties({},_23.defaults,{editNode:_20})}
_7[i]=_16}
_1.setFields(_7);_12.dontShowFieldMapper=true;for(var i=0;i<_7.length;i++){var _20=_7[i].editNode;_12.addNode(_20,_2)}
delete _12.dontShowFieldMapper;_3.destroy()},isc.A.setDefaultData=function isc_FieldMapper_setDefaultData(_1){var _2=this.mockDataSource,_3=this.$87z;var _4=[],_5=_2.getFields();for(var _6 in _5){_4.add(isc.addProperties({origName:_6},_5[_6]))};this.$870(_4);_3.setData(_4);var _7={};for(var i=0;i<_4.length;i++){if(_4[i].mappedTo)_7[_4[i].mappedTo]=_4[i].name}
var _9=this.targetDataSource,_10=this.targetDataSourceList;var _11=[];_4=[];_5=_9.getFields();for(var _6 in _5){if(_5[_6].hidden)continue;_4.add(isc.addProperties({inUse:_7[_6]!=null},_5[_6]));if(_7[_6]==null){_11.add(_6)}};_10.setData(_4);_3.getField("mappedTo").valueMap=_11;if(_1){_3.setData([]);_3.transferRecords(_4,null,null,_9)}},isc.A.startEditingMapping=function isc_FieldMapper_startEditingMapping(){var _1=this.$87z,_2=_1.data.findIndex("mappedTo",null);_1.startEditing(Math.max(_2,0),_1.getFieldNum("mappedTo"))},isc.A.$870=function isc_FieldMapper__automaticDefaultMapping(_1){var _2=[];var _3=isc.shallowClone(this.targetDataSource);_3.autoDeriveTitles=true;var _4=_3.getFields();for(var _5 in _4){_2.add({name:_5,splittedTitle:_4[_5].title.toLowerCase().split(" ")})};for(var i=0;i<_1.length;i++){if(_1[i].title==null){continue}
var _7=_1[i].title.toLowerCase().split(" ");var _8=null;var _9=0;for(var j=0;j<_2.length;j++){if(_2[j].occupied)continue;var _11=0;var _12=_2[j].splittedTitle;for(var _13=0;_13<_12.length;_13++){for(var _14=0;_14<_7.length;_14++){if(_7[_14]==_12[_13]){_11++}}}
if(_11>_9){_9=_11;_8=_2[j]}};if(_8){_8.occupied=true;_1[i].mappedTo=_8.name}}},isc.A.$1715=function isc_FieldMapper__getMappedToNames(){var _1=this.$87z.getData(),_2={};for(var i=0;i<_1.length;i++){var _4=_1[i].mappedTo;if(_4!=null)_2[_4]=_1[i]}
return _2},isc.A.getMappedFields=function isc_FieldMapper_getMappedFields(_1,_2,_3){var _4=this.$87z.getData(),_5=this.$1715();var _6=[],_7=[];for(var i=0;i<_4.length;i++){var _9=_4[i],_10=_9.title,_11=_9.mappedTo;if(!_11){if(!_1||_5[_9.name]){_7.add("'"+_10+"'");continue}}
_6.add(_9)};if(_2&&_7.length>0){isc.confirm("The following field definitions will be discarded: "+_7.join(", "),_3);return null}
return _6});isc.B._maxIndex=isc.C+10;isc._nonDebugModules=(isc._nonDebugModules!=null?isc._nonDebugModules:[]);isc._nonDebugModules.push('VisualBuilder');isc.checkForDebugAndNonDebugModules();isc._moduleEnd=isc._VisualBuilder_end=(isc.timestamp?isc.timestamp():new Date().getTime());if(isc.Log&&isc.Log.logIsInfoEnabled('loadTime'))isc.Log.logInfo('VisualBuilder module init time: '+(isc._moduleEnd-isc._moduleStart)+'ms','loadTime');delete isc.definingFramework;if(isc.Page)isc.Page.handleEvent(null,"moduleLoaded",{moduleName:'VisualBuilder',loadTime:(isc._moduleEnd-isc._moduleStart)});}else{if(window.isc&&isc.Log&&isc.Log.logWarn)isc.Log.logWarn("Duplicate load of module 'VisualBuilder'.");}
